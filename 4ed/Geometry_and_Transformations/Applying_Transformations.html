
<!doctype html>
<html lang="en">
<head>

<!-- all praise to https://realfavicongenerator.net -->
<link rel="icon" href="/favicon.ico?v=2" /> <!-- force refresh -->
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="/fonts.css">
  <link rel="stylesheet" href="../pbrstyle.css">
  <link rel="stylesheet" href="/fontawesome-free-5.15.3-web/css/all.css">

<script async src="https://cse.google.com/cse.js?cx=22a43cef261a245ea"></script>  <script src="/react.min.js"></script>
  <script src="/react-dom.min.js"></script>
  <script src="/jeri.min.js"></script>
  <link rel="preload" href="/exr.worker.js" as="script" crossorigin="anonymous">
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="/bootstrap.min.css">

  <title>Applying Transformations</title>
</head>
        
<body>

<nav class="fixed-top-lg-navbar navbar navbar-expand bg-light navbar-light">
  <ul class="nav navbar-nav">
    <a class="navbar-brand" href="../contents.html"><img src="../pbr.jpg" width=25 height=25></a>
    <li class="nav-item"><a class="nav-link" href="../Geometry_and_Transformations.html">Geometry and Transformations</a></li>
    <span class="navbar-text">/</span>
    <li class="nav-item"><a class="nav-link" href="#">Applying Transformations</a></li>
    <span class="navbar-text">&nbsp;&nbsp;</span>
    <li class="nav-item"><a class="nav-link" href="../Geometry_and_Transformations/Transformations.html">(Previous: Transformations)</a></li>
  </ul>

  <ul class="nav navbar-nav ml-auto d-none d-md-block">
        <li class="nav-item"><div class="gcse-search"></div></li>
    </ul>
  <ul class="nav navbar-nav d-block d-md-none">
        <li class="nav-item"><div class="gcse-search"></div></li>
    </ul>
</nav>

<div class="maincontainer">
<div class="container-fluid">

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#"><i class="fas fa-link "></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="sec:applying-transforms"></span><h2>3.10 Applying Transformations</h2><p>



</p>
<p> We can now define routines that perform the appropriate matrix multiplications
to transform points and vectors.  We will overload the function application
operator to describe these transformations; this lets us write code
like:

</p>
<p></p>
<div class="fragmentcode">    Point3f p = ...;
    Transform T = ...;
    Point3f pNew = T(p);</div><p>


</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#Points"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="Points"></span><h3>3.10.1  Points</h3><p>

 


</p>
<p> The point transformation routine takes a point <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.432ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3199.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis x comma y comma z right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="962" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="1407" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1897" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="2342" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2810" y="0"></use>
</g>
</svg> and implicitly
represents it as the homogeneous column vector <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.821ex" height="3.009ex" style="vertical-align: -0.838ex;" viewBox="0 -934.9 3798 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket x y z Baseline 1 right-bracket Superscript upper T Baseline period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D447" d="M704 666c0 -3 -1 -13 -2 -17l-27 -174c-2 -15 -4 -23 -15 -23c-9 0 -12 7 -12 13c0 3 2 15 3 19c4 26 8 65 8 80c0 78 -45 82 -146 82c-21 0 -54 0 -63 -2c-12 -3 -16 -9 -23 -37l-133 -531c-4 -15 -4 -21 -4 -21c0 -16 8 -19 37 -22c26 -2 39 -2 64 -2c26 0 34 0 34 -11 c0 -20 -12 -20 -22 -20c-28 0 -58 2 -87 2l-83 1l-85 -1c-27 0 -55 -2 -82 -2c-6 0 -17 0 -17 12c0 19 6 19 42 19c107 0 110 11 119 48l134 534c1 3 4 15 4 21c0 8 0 12 -28 12h-39c-148 0 -174 -18 -228 -173c-6 -16 -7 -21 -17 -21c-7 0 -12 5 -12 11c0 0 5 16 6 18 l60 176c7 19 8 20 32 20h555c17 0 27 0 27 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="1017" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="1674" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="2308" y="0"></use>
<g transform="translate(2809,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D447" x="393" y="513"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="3519" y="0"></use>
</g>
</svg>  It
then transforms the point by premultiplying this vector with the
transformation matrix.  Finally, it divides by <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.664ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 716.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">w</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D464" d="M691 372c0 -48 -32 -182 -66 -260c-26 -60 -70 -123 -145 -123c-30 0 -99 6 -125 70c-40 -70 -87 -70 -104 -70c-75 0 -142 35 -142 126c0 38 12 84 56 202c7 17 18 45 18 70c0 32 -16 33 -25 33c-35 0 -74 -31 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c49 0 82 -37 82 -82c0 -20 -6 -34 -17 -64c-47 -123 -52 -162 -52 -194c0 -17 0 -91 80 -91c39 0 69 31 92 84c-1 5 -1 7 -1 18c0 18 2 36 9 66c7 26 54 217 57 224c7 20 25 28 37 28c15 0 29 -9 29 -27c0 -6 -10 -43 -15 -65l-42 -168 c-4 -14 -11 -45 -11 -73c0 -57 27 -87 74 -87c49 0 84 35 110 88c26 51 55 149 55 183c0 48 -25 74 -36 85c-9 8 -15 14 -15 27c0 22 25 48 50 48c17 0 44 -15 44 -70Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D464" x="0" y="0"></use>
</g>
</svg> to convert back to a
nonhomogeneous point representation.  For efficiency, this method skips
the division by the homogeneous weight, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.664ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 716.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">w</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D464" d="M691 372c0 -48 -32 -182 -66 -260c-26 -60 -70 -123 -145 -123c-30 0 -99 6 -125 70c-40 -70 -87 -70 -104 -70c-75 0 -142 35 -142 126c0 38 12 84 56 202c7 17 18 45 18 70c0 32 -16 33 -25 33c-35 0 -74 -31 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c49 0 82 -37 82 -82c0 -20 -6 -34 -17 -64c-47 -123 -52 -162 -52 -194c0 -17 0 -91 80 -91c39 0 69 31 92 84c-1 5 -1 7 -1 18c0 18 2 36 9 66c7 26 54 217 57 224c7 20 25 28 37 28c15 0 29 -9 29 -27c0 -6 -10 -43 -15 -65l-42 -168 c-4 -14 -11 -45 -11 -73c0 -57 27 -87 74 -87c49 0 84 35 110 88c26 51 55 149 55 183c0 48 -25 74 -36 85c-9 8 -15 14 -15 27c0 22 25 48 50 48c17 0 44 -15 44 -70Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D464" x="0" y="0"></use>
</g>
</svg>, when <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.925ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2551.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">w equals 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D464" d="M691 372c0 -48 -32 -182 -66 -260c-26 -60 -70 -123 -145 -123c-30 0 -99 6 -125 70c-40 -70 -87 -70 -104 -70c-75 0 -142 35 -142 126c0 38 12 84 56 202c7 17 18 45 18 70c0 32 -16 33 -25 33c-35 0 -74 -31 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c49 0 82 -37 82 -82c0 -20 -6 -34 -17 -64c-47 -123 -52 -162 -52 -194c0 -17 0 -91 80 -91c39 0 69 31 92 84c-1 5 -1 7 -1 18c0 18 2 36 9 66c7 26 54 217 57 224c7 20 25 28 37 28c15 0 29 -9 29 -27c0 -6 -10 -43 -15 -65l-42 -168 c-4 -14 -11 -45 -11 -73c0 -57 27 -87 74 -87c49 0 84 35 110 88c26 51 55 149 55 183c0 48 -25 74 -36 85c-9 8 -15 14 -15 27c0 22 25 48 50 48c17 0 44 -15 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D464" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="994" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="2050" y="0"></use>
</g>
</svg>, which is common for
most of the transformations that will be used in <tt>pbrt</tt>&mdash;only the
projective transformations defined in Chapter&nbsp;<a href="../Cameras_and_Film.html#chap:camera">5</a> will
require this division.

</p>
<p></p>
<span class="anchor" id="fragment-TransformInlineMethods-0"></span><div class="fragmentname">&lt;&lt;Transform Inline Methods&gt;&gt;=&nbsp;<a href="#fragment-TransformInlineMethods-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">template &lt;typename T&gt;
Point3&lt;T&gt; <span class="anchor" id="Transform::operator"></span><a href="../Geometry_and_Transformations/Transformations.html#Transform" class="code">Transform</a>::operator()(Point3&lt;T&gt; p) const {
    T xp = <a href="../Geometry_and_Transformations/Transformations.html#Transform::m" class="code">m</a>[0][0] * p.x + <a href="../Geometry_and_Transformations/Transformations.html#Transform::m" class="code">m</a>[0][1] * p.y + <a href="../Geometry_and_Transformations/Transformations.html#Transform::m" class="code">m</a>[0][2] * p.z + <a href="../Geometry_and_Transformations/Transformations.html#Transform::m" class="code">m</a>[0][3];
    T yp = <a href="../Geometry_and_Transformations/Transformations.html#Transform::m" class="code">m</a>[1][0] * p.x + <a href="../Geometry_and_Transformations/Transformations.html#Transform::m" class="code">m</a>[1][1] * p.y + <a href="../Geometry_and_Transformations/Transformations.html#Transform::m" class="code">m</a>[1][2] * p.z + <a href="../Geometry_and_Transformations/Transformations.html#Transform::m" class="code">m</a>[1][3];
    T zp = <a href="../Geometry_and_Transformations/Transformations.html#Transform::m" class="code">m</a>[2][0] * p.x + <a href="../Geometry_and_Transformations/Transformations.html#Transform::m" class="code">m</a>[2][1] * p.y + <a href="../Geometry_and_Transformations/Transformations.html#Transform::m" class="code">m</a>[2][2] * p.z + <a href="../Geometry_and_Transformations/Transformations.html#Transform::m" class="code">m</a>[2][3];
    T wp = <a href="../Geometry_and_Transformations/Transformations.html#Transform::m" class="code">m</a>[3][0] * p.x + <a href="../Geometry_and_Transformations/Transformations.html#Transform::m" class="code">m</a>[3][1] * p.y + <a href="../Geometry_and_Transformations/Transformations.html#Transform::m" class="code">m</a>[3][2] * p.z + <a href="../Geometry_and_Transformations/Transformations.html#Transform::m" class="code">m</a>[3][3];
    if (wp == 1)
        return Point3&lt;T&gt;(xp, yp, zp);
    else
        return Point3&lt;T&gt;(xp, yp, zp) / wp;
}</div><p>


</p>
<p>The <a href="../Geometry_and_Transformations/Transformations.html#Transform"><tt>Transform</tt></a> class also provides a corresponding
<tt>ApplyInverse()</tt> method for each type it transforms.  The one
for <tt>Point3</tt> applies its inverse transformation to the given point.
Calling this method is more succinct and generally more efficient than
calling <a href="../Geometry_and_Transformations/Transformations.html#Transform::Inverse"><tt>Transform::Inverse()</tt></a> and then calling its <tt>operator()</tt>.

</p>
<p></p>
<span class="anchor" id="fragment-TransformPublicMethods-7"></span><div class="fragmentname">&lt;&lt;Transform Public Methods&gt;&gt;+=&nbsp;<a href="Transformations.html#fragment-TransformPublicMethods-6"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-TransformPublicMethods-8"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">template &lt;typename T&gt;
Point3&lt;T&gt; <span class="anchor" id="Transform::ApplyInverse"></span>ApplyInverse(Point3&lt;T&gt; p) const;</div><p>


</p>
<p>All subsequent types that can be transformed also have an
<tt>ApplyInverse()</tt> method, though we will not include them in the book text.

</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#Vectors"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="Vectors"></span><h3>3.10.2  Vectors</h3><p>


</p>
<p> The transformations of vectors can be computed in a similar fashion.
However, the multiplication of the matrix and the column vector is simplified
since the implicit homogeneous <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.664ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 716.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">w</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D464" d="M691 372c0 -48 -32 -182 -66 -260c-26 -60 -70 -123 -145 -123c-30 0 -99 6 -125 70c-40 -70 -87 -70 -104 -70c-75 0 -142 35 -142 126c0 38 12 84 56 202c7 17 18 45 18 70c0 32 -16 33 -25 33c-35 0 -74 -31 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c49 0 82 -37 82 -82c0 -20 -6 -34 -17 -64c-47 -123 -52 -162 -52 -194c0 -17 0 -91 80 -91c39 0 69 31 92 84c-1 5 -1 7 -1 18c0 18 2 36 9 66c7 26 54 217 57 224c7 20 25 28 37 28c15 0 29 -9 29 -27c0 -6 -10 -43 -15 -65l-42 -168 c-4 -14 -11 -45 -11 -73c0 -57 27 -87 74 -87c49 0 84 35 110 88c26 51 55 149 55 183c0 48 -25 74 -36 85c-9 8 -15 14 -15 27c0 22 25 48 50 48c17 0 44 -15 44 -70Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D464" x="0" y="0"></use>
</g>
</svg> coordinate is zero.

</p>
<p>

</p>
<p></p>
<span class="anchor" id="fragment-TransformInlineMethods-1"></span><div class="fragmentname">&lt;&lt;Transform Inline Methods&gt;&gt;+=&nbsp;<a href="#fragment-TransformInlineMethods-0"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-TransformInlineMethods-2"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">template &lt;typename T&gt;
Vector3&lt;T&gt; <a href="../Geometry_and_Transformations/Transformations.html#Transform" class="code">Transform</a>::operator()(Vector3&lt;T&gt; v) const {
    return Vector3&lt;T&gt;(<a href="../Geometry_and_Transformations/Transformations.html#Transform::m" class="code">m</a>[0][0] * v.x + <a href="../Geometry_and_Transformations/Transformations.html#Transform::m" class="code">m</a>[0][1] * v.y + <a href="../Geometry_and_Transformations/Transformations.html#Transform::m" class="code">m</a>[0][2] * v.z,
                      <a href="../Geometry_and_Transformations/Transformations.html#Transform::m" class="code">m</a>[1][0] * v.x + <a href="../Geometry_and_Transformations/Transformations.html#Transform::m" class="code">m</a>[1][1] * v.y + <a href="../Geometry_and_Transformations/Transformations.html#Transform::m" class="code">m</a>[1][2] * v.z,
                      <a href="../Geometry_and_Transformations/Transformations.html#Transform::m" class="code">m</a>[2][0] * v.x + <a href="../Geometry_and_Transformations/Transformations.html#Transform::m" class="code">m</a>[2][1] * v.y + <a href="../Geometry_and_Transformations/Transformations.html#Transform::m" class="code">m</a>[2][2] * v.z);
}</div><p>


</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#Normals"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="sec:normal-transform"></span><span id="Normals"></span><h3>3.10.3  Normals</h3><p>



</p>
<p></p>
<span class="anchor" id="fig:normaltransform"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha03f29.svg" title=""><img src="pha03f29.svg" width=366 height=140 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 3.29: Transforming Surface Normals. <span class="legend"> (a)&nbsp;Original circle, with
the normal at a point indicated by an arrow.
(b)&nbsp;When scaling the circle to be half as tall in the&nbsp;<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.139ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 490.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
</g>
</svg> direction, simply treating the normal as a direction and
scaling it in the same manner gives a normal that is no longer
perpendicular to the surface. (c)&nbsp;A properly transformed normal.</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p> Normals do not transform in the same way that vectors do, as shown in
Figure&nbsp;<a href="#fig:normaltransform">3.29</a>.
Although tangent vectors at a surface transform 
in the straightforward way, normals require special treatment.  Because the
normal vector <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.485ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 639.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold n</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D427" d="M615 0l-126 3l-126 -3v47h69v270c0 76 -21 97 -55 97c-63 0 -149 -49 -149 -158v-209h69v-47l-126 3l-126 -3v47h69v309c0 39 -7 39 -69 39v47l172 8v-108c26 51 79 108 175 108c100 0 154 -39 154 -144v-259h69v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D427" x="0" y="0"></use>
</g>
</svg> and any tangent vector <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.039ex" height="2.009ex" style="vertical-align: -0.338ex;" viewBox="0 -719.6 447.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold t</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42D" d="M382 124c0 -73 -45 -130 -121 -130c-71 0 -158 22 -158 129v274h-82v36c99 3 148 102 149 202h47v-191h146v-47h-146v-276c0 -23 0 -87 58 -87c28 0 60 24 60 92v51h47v-53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42D" x="0" y="0"></use>
</g>
</svg> on the surface are
orthogonal by construction, we know that
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.124ex" height="2.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1006.6 6942.2 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold n dot bold t equals bold n Superscript upper T Baseline bold t equals 0 period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D427" d="M615 0l-126 3l-126 -3v47h69v270c0 76 -21 97 -55 97c-63 0 -149 -49 -149 -158v-209h69v-47l-126 3l-126 -3v47h69v309c0 39 -7 39 -69 39v47l172 8v-108c26 51 79 108 175 108c100 0 154 -39 154 -144v-259h69v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-22C5" d="M192 250c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42D" d="M382 124c0 -73 -45 -130 -121 -130c-71 0 -158 22 -158 129v274h-82v36c99 3 148 102 149 202h47v-191h146v-47h-146v-276c0 -23 0 -87 58 -87c28 0 60 24 60 92v51h47v-53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D447" d="M704 666c0 -3 -1 -13 -2 -17l-27 -174c-2 -15 -4 -23 -15 -23c-9 0 -12 7 -12 13c0 3 2 15 3 19c4 26 8 65 8 80c0 78 -45 82 -146 82c-21 0 -54 0 -63 -2c-12 -3 -16 -9 -23 -37l-133 -531c-4 -15 -4 -21 -4 -21c0 -16 8 -19 37 -22c26 -2 39 -2 64 -2c26 0 34 0 34 -11 c0 -20 -12 -20 -22 -20c-28 0 -58 2 -87 2l-83 1l-85 -1c-27 0 -55 -2 -82 -2c-6 0 -17 0 -17 12c0 19 6 19 42 19c107 0 110 11 119 48l134 534c1 3 4 15 4 21c0 8 0 12 -28 12h-39c-148 0 -174 -18 -228 -173c-6 -16 -7 -21 -17 -21c-7 0 -12 5 -12 11c0 0 5 16 6 18 l60 176c7 19 8 20 32 20h555c17 0 27 0 27 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D427" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-22C5" x="861" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42D" x="1362" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="2087" y="0"></use>
<g transform="translate(3144,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D427" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D447" x="904" y="583"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42D" x="4381" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="5106" y="0"></use>
<g transform="translate(6163,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
</g>
</g>
</svg>
</div>
<p>


</p>
<p>When we transform a point on the surface by some matrix <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.537ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1092.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper M</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D40C" d="M1051 0c-36 3 -130 3 -171 3s-134 0 -170 -3v47h108v592h-1l-279 -615c-4 -9 -12 -24 -32 -24c-11 0 -23 5 -32 25l-272 601h-1v-550c0 -22 1 -23 30 -26c18 -2 35 -3 53 -3h25v-47c-41 3 -93 3 -135 3c-39 0 -96 0 -134 -3v47h25c28 0 30 0 54 3c28 3 29 4 29 26v563 h-108v47h222c22 0 33 0 44 -25l240 -529l240 529c11 25 22 25 44 25h221v-47h-108v-592h108v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="0" y="0"></use>
</g>
</svg>, the new
tangent vector <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.941ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 835.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold t prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42D" d="M382 124c0 -73 -45 -130 -121 -130c-71 0 -158 22 -158 129v274h-82v36c99 3 148 102 149 202h47v-191h146v-47h-146v-276c0 -23 0 -87 58 -87c28 0 60 24 60 92v51h47v-53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="632" y="513"></use>
</g>
</svg> at the transformed point is 
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.577ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1540 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper M bold t</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D40C" d="M1051 0c-36 3 -130 3 -171 3s-134 0 -170 -3v47h108v592h-1l-279 -615c-4 -9 -12 -24 -32 -24c-11 0 -23 5 -32 25l-272 601h-1v-550c0 -22 1 -23 30 -26c18 -2 35 -3 53 -3h25v-47c-41 3 -93 3 -135 3c-39 0 -96 0 -134 -3v47h25c28 0 30 0 54 3c28 3 29 4 29 26v563 h-108v47h222c22 0 33 0 44 -25l240 -529l240 529c11 25 22 25 44 25h221v-47h-108v-592h108v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42D" d="M382 124c0 -73 -45 -130 -121 -130c-71 0 -158 22 -158 129v274h-82v36c99 3 148 102 149 202h47v-191h146v-47h-146v-276c0 -23 0 -87 58 -87c28 0 60 24 60 92v51h47v-53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42D" x="1092" y="0"></use>
</g>
</svg>.  The transformed normal <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.387ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 1027.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold n prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D427" d="M615 0l-126 3l-126 -3v47h69v270c0 76 -21 97 -55 97c-63 0 -149 -49 -149 -158v-209h69v-47l-126 3l-126 -3v47h69v309c0 39 -7 39 -69 39v47l172 8v-108c26 51 79 108 175 108c100 0 154 -39 154 -144v-259h69v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D427" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="904" y="513"></use>
</g>
</svg> should be equal to
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.971ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1279 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper S bold n</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D412" d="M574 203c0 -101 -62 -214 -227 -214c-41 0 -134 6 -200 55l-46 -46c-8 -7 -10 -9 -19 -9c-18 0 -18 9 -18 28v182c0 23 0 29 24 29c22 0 22 -5 23 -23c8 -149 160 -169 236 -169c104 0 130 69 130 117c0 46 -25 72 -40 87c-22 21 -39 24 -127 43c-109 24 -143 31 -192 80 c-21 22 -54 68 -54 133c0 105 72 201 224 201c48 0 113 -9 171 -55l45 44c11 10 12 11 20 11c18 0 18 -9 18 -28v-183c0 -23 0 -28 -24 -28c-21 0 -21 2 -25 26c-23 136 -124 170 -204 170c-100 0 -128 -62 -128 -105c0 -61 56 -95 96 -104l145 -31 c91 -19 172 -100 172 -211Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D427" d="M615 0l-126 3l-126 -3v47h69v270c0 76 -21 97 -55 97c-63 0 -149 -49 -149 -158v-209h69v-47l-126 3l-126 -3v47h69v309c0 39 -7 39 -69 39v47l172 8v-108c26 51 79 108 175 108c100 0 154 -39 154 -144v-259h69v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D412" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D427" x="639" y="0"></use>
</g>
</svg> for some 4<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.808ex" height="1.509ex" style="vertical-align: 0.019ex; margin-bottom: -0.19ex;" viewBox="0 -576.1 778.5 649.8" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">times</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-D7" d="M624 15c-7 -8 -20 -8 -28 0l-207 207l-207 -207c-8 -8 -21 -8 -28 0c-8 7 -8 20 0 28l207 207l-207 207c-8 8 -8 21 0 28c7 8 20 8 28 0l207 -207l207 207c8 8 21 8 28 0c8 -7 8 -20 0 -28l-207 -207l207 -207c8 -8 8 -21 0 -28Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-D7" x="0" y="0"></use>
</g>
</svg>4 matrix <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.485ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 639.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper S</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D412" d="M574 203c0 -101 -62 -214 -227 -214c-41 0 -134 6 -200 55l-46 -46c-8 -7 -10 -9 -19 -9c-18 0 -18 9 -18 28v182c0 23 0 29 24 29c22 0 22 -5 23 -23c8 -149 160 -169 236 -169c104 0 130 69 130 117c0 46 -25 72 -40 87c-22 21 -39 24 -127 43c-109 24 -143 31 -192 80 c-21 22 -54 68 -54 133c0 105 72 201 224 201c48 0 113 -9 171 -55l45 44c11 10 12 11 20 11c18 0 18 -9 18 -28v-183c0 -23 0 -28 -24 -28c-21 0 -21 2 -25 26c-23 136 -124 170 -204 170c-100 0 -128 -62 -128 -105c0 -61 56 -95 96 -104l145 -31 c91 -19 172 -100 172 -211Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D412" x="0" y="0"></use>
</g>
</svg>.  To maintain the
orthogonality requirement, we must have
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.794ex" height="10.843ex" style="vertical-align: -4.838ex;" viewBox="0 -2585.3 7230.9 4668.3" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">StartLayout 1st Row 1st Column 0 2nd Column equals left-parenthesis bold n prime right-parenthesis Superscript upper T Baseline bold t Superscript prime Baseline 2nd Row 1st Column Blank 2nd Column equals left-parenthesis bold upper S bold n right-parenthesis Superscript upper T Baseline bold upper M bold t 3rd Row 1st Column Blank 2nd Column equals left-parenthesis bold n right-parenthesis Superscript upper T Baseline bold upper S Superscript upper T Baseline bold upper M bold t period EndLayout</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D427" d="M615 0l-126 3l-126 -3v47h69v270c0 76 -21 97 -55 97c-63 0 -149 -49 -149 -158v-209h69v-47l-126 3l-126 -3v47h69v309c0 39 -7 39 -69 39v47l172 8v-108c26 51 79 108 175 108c100 0 154 -39 154 -144v-259h69v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D447" d="M704 666c0 -3 -1 -13 -2 -17l-27 -174c-2 -15 -4 -23 -15 -23c-9 0 -12 7 -12 13c0 3 2 15 3 19c4 26 8 65 8 80c0 78 -45 82 -146 82c-21 0 -54 0 -63 -2c-12 -3 -16 -9 -23 -37l-133 -531c-4 -15 -4 -21 -4 -21c0 -16 8 -19 37 -22c26 -2 39 -2 64 -2c26 0 34 0 34 -11 c0 -20 -12 -20 -22 -20c-28 0 -58 2 -87 2l-83 1l-85 -1c-27 0 -55 -2 -82 -2c-6 0 -17 0 -17 12c0 19 6 19 42 19c107 0 110 11 119 48l134 534c1 3 4 15 4 21c0 8 0 12 -28 12h-39c-148 0 -174 -18 -228 -173c-6 -16 -7 -21 -17 -21c-7 0 -12 5 -12 11c0 0 5 16 6 18 l60 176c7 19 8 20 32 20h555c17 0 27 0 27 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42D" d="M382 124c0 -73 -45 -130 -121 -130c-71 0 -158 22 -158 129v274h-82v36c99 3 148 102 149 202h47v-191h146v-47h-146v-276c0 -23 0 -87 58 -87c28 0 60 24 60 92v51h47v-53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D412" d="M574 203c0 -101 -62 -214 -227 -214c-41 0 -134 6 -200 55l-46 -46c-8 -7 -10 -9 -19 -9c-18 0 -18 9 -18 28v182c0 23 0 29 24 29c22 0 22 -5 23 -23c8 -149 160 -169 236 -169c104 0 130 69 130 117c0 46 -25 72 -40 87c-22 21 -39 24 -127 43c-109 24 -143 31 -192 80 c-21 22 -54 68 -54 133c0 105 72 201 224 201c48 0 113 -9 171 -55l45 44c11 10 12 11 20 11c18 0 18 -9 18 -28v-183c0 -23 0 -28 -24 -28c-21 0 -21 2 -25 26c-23 136 -124 170 -204 170c-100 0 -128 -62 -128 -105c0 -61 56 -95 96 -104l145 -31 c91 -19 172 -100 172 -211Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D40C" d="M1051 0c-36 3 -130 3 -171 3s-134 0 -170 -3v47h108v592h-1l-279 -615c-4 -9 -12 -24 -32 -24c-11 0 -23 5 -32 25l-272 601h-1v-550c0 -22 1 -23 30 -26c18 -2 35 -3 53 -3h25v-47c-41 3 -93 3 -135 3c-39 0 -96 0 -134 -3v47h25c28 0 30 0 54 3c28 3 29 4 29 26v563 h-108v47h222c22 0 33 0 44 -25l240 -529l240 529c11 25 22 25 44 25h221v-47h-108v-592h108v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="1575"></use>
</g>
<g transform="translate(767,0)">
<g transform="translate(0,1575)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1056" y="0"></use>
<g transform="translate(1445,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D427" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="904" y="583"></use>
</g>
<g transform="translate(2473,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D447" x="550" y="583"></use>
</g>
<g transform="translate(3461,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="632" y="583"></use>
</g>
</g>
<g transform="translate(0,-66)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1056" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D412" x="1445" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D427" x="2085" y="0"></use>
<g transform="translate(2724,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D447" x="550" y="583"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="3712" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42D" x="4804" y="0"></use>
</g>
<g transform="translate(0,-1720)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1056" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D427" x="1445" y="0"></use>
<g transform="translate(2085,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D447" x="550" y="583"></use>
</g>
<g transform="translate(3072,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D412" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D447" x="904" y="601"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="4310" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42D" x="5403" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="5850" y="0"></use>
</g>
</g>
</g>
</g>
</svg>
</div>
<p>

This condition holds if <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.524ex" height="2.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1006.6 4100.7 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper S Superscript upper T Baseline bold upper M equals bold upper I</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D412" d="M574 203c0 -101 -62 -214 -227 -214c-41 0 -134 6 -200 55l-46 -46c-8 -7 -10 -9 -19 -9c-18 0 -18 9 -18 28v182c0 23 0 29 24 29c22 0 22 -5 23 -23c8 -149 160 -169 236 -169c104 0 130 69 130 117c0 46 -25 72 -40 87c-22 21 -39 24 -127 43c-109 24 -143 31 -192 80 c-21 22 -54 68 -54 133c0 105 72 201 224 201c48 0 113 -9 171 -55l45 44c11 10 12 11 20 11c18 0 18 -9 18 -28v-183c0 -23 0 -28 -24 -28c-21 0 -21 2 -25 26c-23 136 -124 170 -204 170c-100 0 -128 -62 -128 -105c0 -61 56 -95 96 -104l145 -31 c91 -19 172 -100 172 -211Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D447" d="M704 666c0 -3 -1 -13 -2 -17l-27 -174c-2 -15 -4 -23 -15 -23c-9 0 -12 7 -12 13c0 3 2 15 3 19c4 26 8 65 8 80c0 78 -45 82 -146 82c-21 0 -54 0 -63 -2c-12 -3 -16 -9 -23 -37l-133 -531c-4 -15 -4 -21 -4 -21c0 -16 8 -19 37 -22c26 -2 39 -2 64 -2c26 0 34 0 34 -11 c0 -20 -12 -20 -22 -20c-28 0 -58 2 -87 2l-83 1l-85 -1c-27 0 -55 -2 -82 -2c-6 0 -17 0 -17 12c0 19 6 19 42 19c107 0 110 11 119 48l134 534c1 3 4 15 4 21c0 8 0 12 -28 12h-39c-148 0 -174 -18 -228 -173c-6 -16 -7 -21 -17 -21c-7 0 -12 5 -12 11c0 0 5 16 6 18 l60 176c7 19 8 20 32 20h555c17 0 27 0 27 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D40C" d="M1051 0c-36 3 -130 3 -171 3s-134 0 -170 -3v47h108v592h-1l-279 -615c-4 -9 -12 -24 -32 -24c-11 0 -23 5 -32 25l-272 601h-1v-550c0 -22 1 -23 30 -26c18 -2 35 -3 53 -3h25v-47c-41 3 -93 3 -135 3c-39 0 -96 0 -134 -3v47h25c28 0 30 0 54 3c28 3 29 4 29 26v563 h-108v47h222c22 0 33 0 44 -25l240 -529l240 529c11 25 22 25 44 25h221v-47h-108v-592h108v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D408" d="M403 0c-41 3 -139 3 -185 3s-144 0 -185 -3v47h114v592h-114v47c41 -3 139 -3 185 -3s144 0 185 3v-47h-114v-592h114v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D412" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D447" x="904" y="601"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="1237" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="2607" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D408" x="3664" y="0"></use>
</g>
</svg>, the
identity matrix.  Therefore, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.843ex" height="2.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1006.6 4668.6 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper S Superscript upper T Baseline equals bold upper M Superscript negative 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D412" d="M574 203c0 -101 -62 -214 -227 -214c-41 0 -134 6 -200 55l-46 -46c-8 -7 -10 -9 -19 -9c-18 0 -18 9 -18 28v182c0 23 0 29 24 29c22 0 22 -5 23 -23c8 -149 160 -169 236 -169c104 0 130 69 130 117c0 46 -25 72 -40 87c-22 21 -39 24 -127 43c-109 24 -143 31 -192 80 c-21 22 -54 68 -54 133c0 105 72 201 224 201c48 0 113 -9 171 -55l45 44c11 10 12 11 20 11c18 0 18 -9 18 -28v-183c0 -23 0 -28 -24 -28c-21 0 -21 2 -25 26c-23 136 -124 170 -204 170c-100 0 -128 -62 -128 -105c0 -61 56 -95 96 -104l145 -31 c91 -19 172 -100 172 -211Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D447" d="M704 666c0 -3 -1 -13 -2 -17l-27 -174c-2 -15 -4 -23 -15 -23c-9 0 -12 7 -12 13c0 3 2 15 3 19c4 26 8 65 8 80c0 78 -45 82 -146 82c-21 0 -54 0 -63 -2c-12 -3 -16 -9 -23 -37l-133 -531c-4 -15 -4 -21 -4 -21c0 -16 8 -19 37 -22c26 -2 39 -2 64 -2c26 0 34 0 34 -11 c0 -20 -12 -20 -22 -20c-28 0 -58 2 -87 2l-83 1l-85 -1c-27 0 -55 -2 -82 -2c-6 0 -17 0 -17 12c0 19 6 19 42 19c107 0 110 11 119 48l134 534c1 3 4 15 4 21c0 8 0 12 -28 12h-39c-148 0 -174 -18 -228 -173c-6 -16 -7 -21 -17 -21c-7 0 -12 5 -12 11c0 0 5 16 6 18 l60 176c7 19 8 20 32 20h555c17 0 27 0 27 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D40C" d="M1051 0c-36 3 -130 3 -171 3s-134 0 -170 -3v47h108v592h-1l-279 -615c-4 -9 -12 -24 -32 -24c-11 0 -23 5 -32 25l-272 601h-1v-550c0 -22 1 -23 30 -26c18 -2 35 -3 53 -3h25v-47c-41 3 -93 3 -135 3c-39 0 -96 0 -134 -3v47h25c28 0 30 0 54 3c28 3 29 4 29 26v563 h-108v47h222c22 0 33 0 44 -25l240 -529l240 529c11 25 22 25 44 25h221v-47h-108v-592h108v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D412" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D447" x="904" y="601"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1515" y="0"></use>
<g transform="translate(2571,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="0" y="0"></use>
<g transform="translate(1092,413)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2212" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="778" y="0"></use>
</g>
</g>
</g>
</svg>, and
so
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.912ex" height="3.176ex" style="vertical-align: -0.838ex;" viewBox="0 -1006.6 5559.4 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper S equals left-parenthesis bold upper M Superscript negative 1 Baseline right-parenthesis Superscript upper T Baseline comma</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D412" d="M574 203c0 -101 -62 -214 -227 -214c-41 0 -134 6 -200 55l-46 -46c-8 -7 -10 -9 -19 -9c-18 0 -18 9 -18 28v182c0 23 0 29 24 29c22 0 22 -5 23 -23c8 -149 160 -169 236 -169c104 0 130 69 130 117c0 46 -25 72 -40 87c-22 21 -39 24 -127 43c-109 24 -143 31 -192 80 c-21 22 -54 68 -54 133c0 105 72 201 224 201c48 0 113 -9 171 -55l45 44c11 10 12 11 20 11c18 0 18 -9 18 -28v-183c0 -23 0 -28 -24 -28c-21 0 -21 2 -25 26c-23 136 -124 170 -204 170c-100 0 -128 -62 -128 -105c0 -61 56 -95 96 -104l145 -31 c91 -19 172 -100 172 -211Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D40C" d="M1051 0c-36 3 -130 3 -171 3s-134 0 -170 -3v47h108v592h-1l-279 -615c-4 -9 -12 -24 -32 -24c-11 0 -23 5 -32 25l-272 601h-1v-550c0 -22 1 -23 30 -26c18 -2 35 -3 53 -3h25v-47c-41 3 -93 3 -135 3c-39 0 -96 0 -134 -3v47h25c28 0 30 0 54 3c28 3 29 4 29 26v563 h-108v47h222c22 0 33 0 44 -25l240 -529l240 529c11 25 22 25 44 25h221v-47h-108v-592h108v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D447" d="M704 666c0 -3 -1 -13 -2 -17l-27 -174c-2 -15 -4 -23 -15 -23c-9 0 -12 7 -12 13c0 3 2 15 3 19c4 26 8 65 8 80c0 78 -45 82 -146 82c-21 0 -54 0 -63 -2c-12 -3 -16 -9 -23 -37l-133 -531c-4 -15 -4 -21 -4 -21c0 -16 8 -19 37 -22c26 -2 39 -2 64 -2c26 0 34 0 34 -11 c0 -20 -12 -20 -22 -20c-28 0 -58 2 -87 2l-83 1l-85 -1c-27 0 -55 -2 -82 -2c-6 0 -17 0 -17 12c0 19 6 19 42 19c107 0 110 11 119 48l134 534c1 3 4 15 4 21c0 8 0 12 -28 12h-39c-148 0 -174 -18 -228 -173c-6 -16 -7 -21 -17 -21c-7 0 -12 5 -12 11c0 0 5 16 6 18 l60 176c7 19 8 20 32 20h555c17 0 27 0 27 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D412" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="917" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1973" y="0"></use>
<g transform="translate(2363,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="0" y="0"></use>
<g transform="translate(1092,413)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2212" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="778" y="0"></use>
</g>
</g>
<g transform="translate(4459,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D447" x="550" y="513"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="5280" y="0"></use>
</g>
</svg> and we see that normals must be
transformed by the inverse transpose of the transformation matrix.  This
detail is
one of the reasons why <a href="../Geometry_and_Transformations/Transformations.html#Transform"><tt>Transform</tt></a>s maintain their inverses.

</p>
<p>Note that this method does not explicitly compute the transpose of the
inverse when transforming normals. It just indexes into the inverse matrix
in a different order (compare to the code for transforming <a href="../Geometry_and_Transformations/Vectors.html#Vector3f"><tt>Vector3f</tt></a>s).

</p>
<p>

</p>
<p></p>
<span class="anchor" id="fragment-TransformInlineMethods-2"></span><div class="fragmentname">&lt;&lt;Transform Inline Methods&gt;&gt;+=&nbsp;<a href="#fragment-TransformInlineMethods-1"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-TransformInlineMethods-3"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">template &lt;typename T&gt;
Normal3&lt;T&gt; <a href="../Geometry_and_Transformations/Transformations.html#Transform" class="code">Transform</a>::operator()(Normal3&lt;T&gt; n) const {
    T x = n.x, y = n.y, z = n.z;
    return Normal3&lt;T&gt;(<a href="../Geometry_and_Transformations/Transformations.html#Transform::mInv" class="code">mInv</a>[0][0] * x + <a href="../Geometry_and_Transformations/Transformations.html#Transform::mInv" class="code">mInv</a>[1][0] * y + <a href="../Geometry_and_Transformations/Transformations.html#Transform::mInv" class="code">mInv</a>[2][0] * z,
                      <a href="../Geometry_and_Transformations/Transformations.html#Transform::mInv" class="code">mInv</a>[0][1] * x + <a href="../Geometry_and_Transformations/Transformations.html#Transform::mInv" class="code">mInv</a>[1][1] * y + <a href="../Geometry_and_Transformations/Transformations.html#Transform::mInv" class="code">mInv</a>[2][1] * z,
                      <a href="../Geometry_and_Transformations/Transformations.html#Transform::mInv" class="code">mInv</a>[0][2] * x + <a href="../Geometry_and_Transformations/Transformations.html#Transform::mInv" class="code">mInv</a>[1][2] * y + <a href="../Geometry_and_Transformations/Transformations.html#Transform::mInv" class="code">mInv</a>[2][2] * z);
}</div><p>


</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#Rays"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="sec:transform-rays"></span><span id="Rays"></span><h3>3.10.4  Rays</h3><p>



</p>
<p> Transforming rays is conceptually straightforward: it is a matter
of transforming the constituent origin and direction and copying the other
data members.  (<tt>pbrt</tt> also provides a similar method for transforming
<a href="../Geometry_and_Transformations/Rays.html#RayDifferential"><tt>RayDifferential</tt></a>s.)

</p>
<p>

</p>
<p>The approach used in <tt>pbrt</tt> to manage floating-point round-off error
introduces some subtleties that require a small adjustment to the
transformed ray origin. The &lt;&lt;<span class="fragmentname"><a href="../Shapes/Managing_Rounding_Error.html#fragment-OffsetrayorigintoedgeoferrorboundsandcomputemonotMax-0">Offset ray origin to edge of error
bounds and compute <tt>tMax</tt></a></span>&gt;&gt; fragment handles these details; it is defined in
Section&nbsp;<a href="../Shapes/Managing_Rounding_Error.html#sec:generating-rays">6.8.6</a>, where round-off error and <tt>pbrt</tt>&rsquo;s
mechanisms for dealing with it are discussed.

</p>
<p></p>
<span class="anchor" id="fragment-TransformInlineMethods-3"></span><div class="fragmentname">&lt;&lt;Transform Inline Methods&gt;&gt;+=&nbsp;<a href="#fragment-TransformInlineMethods-2"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Rays.html#Ray" class="code">Ray</a> <a href="../Geometry_and_Transformations/Transformations.html#Transform" class="code">Transform</a>::operator()(const <a href="../Geometry_and_Transformations/Rays.html#Ray" class="code">Ray</a> &amp;r, Float *tMax) const {
    <a href="../Utilities/Mathematical_Infrastructure.html#Point3fi" class="code">Point3fi</a> o = (*this)(<a href="../Utilities/Mathematical_Infrastructure.html#Point3fi" class="code">Point3fi</a>(r.o));
    <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> d = (*this)(r.d);
    &lt;&lt;<span class="fragmentname"><a href="../Shapes/Managing_Rounding_Error.html#fragment-OffsetrayorigintoedgeoferrorboundsandcomputemonotMax-0">Offset ray origin to edge of error bounds and compute <tt>tMax</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-125" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-125"><i></i></a><div id="fragbit-125" class="collapse show"><div class="fragmentcode">       if (Float lengthSquared = <a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(d); lengthSquared &gt; 0) {
           Float dt = <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(<a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Abs" class="code">Abs</a>(d), o.<a href="../Utilities/Mathematical_Infrastructure.html#Point3fi::Error" class="code">Error</a>()) / lengthSquared;
           o += d * dt;
           if (tMax)
               *tMax -= dt;
       }</div></div>
    return <a href="../Geometry_and_Transformations/Rays.html#Ray" class="code">Ray</a>(<a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a>(o), d, r.time, r.medium);
}</div><p>


</p>
<p>

</p>
<p>


</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#BoundingBoxes"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="BoundingBoxes"></span><h3>3.10.5  Bounding Boxes</h3><p>


</p>
<p> The easiest way to transform an axis-aligned bounding box is to transform
all eight of its corner vertices and then compute a new bounding box that
encompasses those points.  The implementation of this approach is shown below; one
of the exercises for this chapter is to implement a technique to do this
computation more
efficiently.

</p>
<p>

</p>
<p></p>
<span class="anchor" id="fragment-TransformMethodDefinitions-0"></span><div class="fragmentname">&lt;&lt;Transform Method Definitions&gt;&gt;=&nbsp;<a href="#fragment-TransformMethodDefinitions-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Bounding_Boxes.html#Bounds3f" class="code">Bounds3f</a> <a href="../Geometry_and_Transformations/Transformations.html#Transform" class="code">Transform</a>::operator()(const <a href="../Geometry_and_Transformations/Bounding_Boxes.html#Bounds3f" class="code">Bounds3f</a> &amp;b) const {
    <a href="../Geometry_and_Transformations/Bounding_Boxes.html#Bounds3f" class="code">Bounds3f</a> bt;
    for (int i = 0; i &lt; 8; ++i)
        bt = <a href="../Geometry_and_Transformations/Bounding_Boxes.html#Bounds3::Union" class="code">Union</a>(bt, (*this)(b.<a href="../Geometry_and_Transformations/Bounding_Boxes.html#Bounds3::Corner" class="code">Corner</a>(i)));
    return bt;
}</div><p>


</p>
<p>

</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#CompositionofTransformations"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="CompositionofTransformations"></span><h3>3.10.6  Composition of Transformations</h3><p>


</p>
<p> Having defined how the matrices representing individual types of
transformations are constructed, we can now consider an aggregate
transformation resulting from a series of individual transformations.  
We will finally see the real value of representing transformations with matrices.

</p>
<p>Consider a series of transformations <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.852ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2519.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper A bold upper B bold upper C</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D400" d="M827 0c-35 3 -123 3 -163 3c-43 0 -138 0 -176 -3v47h95l-60 146h-268l-50 -121l-4 -12c0 -13 89 -13 89 -13v-47c-37 3 -93 3 -132 3l-117 -3v47h21c76 0 79 8 85 23l248 602c7 18 11 26 39 26c17 0 29 0 40 -26l256 -625h97v-47zM503 240l-114 278l-114 -278h228Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D401" d="M753 186c0 -98 -84 -186 -250 -186h-464v47h108v592h-108v47h434c161 0 248 -80 248 -172c0 -77 -65 -137 -173 -156c119 -9 205 -76 205 -172zM579 514c0 46 -18 125 -119 125h-182v-264h156c97 0 145 62 145 139zM606 187c0 11 0 67 -33 109c-34 43 -81 43 -101 43 h-194v-292h184c144 0 144 128 144 140Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D402" d="M766 227c0 -115 -113 -238 -300 -238c-249 0 -402 149 -402 354s153 354 402 354c68 0 135 -18 197 -68l66 59c8 7 10 9 19 9c18 0 18 -9 18 -28v-215c0 -26 -1 -28 -27 -28c-23 0 -24 2 -27 21c-22 127 -117 203 -225 203c-52 0 -139 -11 -204 -77 c-63 -66 -66 -174 -66 -230c0 -90 12 -165 59 -222c52 -61 136 -85 214 -85c101 0 222 61 229 195c1 17 10 17 23 17c17 0 24 -1 24 -21Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D400" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D401" x="869" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D402" x="1688" y="0"></use>
</g>
</svg>.  We would
like to compute a new transformation <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.859ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 800.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper T</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D413" d="M757 434h-47c-10 114 -20 194 -163 194h-76v-581h153v-47c-54 3 -165 3 -224 3s-170 0 -224 -3v47h153v581h-77c-144 0 -154 -81 -163 -194h-47l21 241h673Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D413" x="0" y="0"></use>
</g>
</svg> such that applying <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.859ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 800.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper T</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D413" d="M757 434h-47c-10 114 -20 194 -163 194h-76v-581h153v-47c-54 3 -165 3 -224 3s-170 0 -224 -3v47h153v581h-77c-144 0 -154 -81 -163 -194h-47l21 241h673Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D413" x="0" y="0"></use>
</g>
</svg> gives
the same result as applying each of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.019ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 869.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper A</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D400" d="M827 0c-35 3 -123 3 -163 3c-43 0 -138 0 -176 -3v47h95l-60 146h-268l-50 -121l-4 -12c0 -13 89 -13 89 -13v-47c-37 3 -93 3 -132 3l-117 -3v47h21c76 0 79 8 85 23l248 602c7 18 11 26 39 26c17 0 29 0 40 -26l256 -625h97v-47zM503 240l-114 278l-114 -278h228Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D400" x="0" y="0"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.901ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 818.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper B</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D401" d="M753 186c0 -98 -84 -186 -250 -186h-464v47h108v592h-108v47h434c161 0 248 -80 248 -172c0 -77 -65 -137 -173 -156c119 -9 205 -76 205 -172zM579 514c0 46 -18 125 -119 125h-182v-264h156c97 0 145 62 145 139zM606 187c0 11 0 67 -33 109c-34 43 -81 43 -101 43 h-194v-292h184c144 0 144 128 144 140Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D401" x="0" y="0"></use>
</g>
</svg>, and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.931ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 831.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper C</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D402" d="M766 227c0 -115 -113 -238 -300 -238c-249 0 -402 149 -402 354s153 354 402 354c68 0 135 -18 197 -68l66 59c8 7 10 9 19 9c18 0 18 -9 18 -28v-215c0 -26 -1 -28 -27 -28c-23 0 -24 2 -27 21c-22 127 -117 203 -225 203c-52 0 -139 -11 -204 -77 c-63 -66 -66 -174 -66 -230c0 -90 12 -165 59 -222c52 -61 136 -85 214 -85c101 0 222 61 229 195c1 17 10 17 23 17c17 0 24 -1 24 -21Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D402" x="0" y="0"></use>
</g>
</svg> in
reverse order; that is,  <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.632ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 8883.1 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper A left-parenthesis bold upper B left-parenthesis bold upper C left-parenthesis normal p right-parenthesis right-parenthesis right-parenthesis equals bold upper T left-parenthesis normal p right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D400" d="M827 0c-35 3 -123 3 -163 3c-43 0 -138 0 -176 -3v47h95l-60 146h-268l-50 -121l-4 -12c0 -13 89 -13 89 -13v-47c-37 3 -93 3 -132 3l-117 -3v47h21c76 0 79 8 85 23l248 602c7 18 11 26 39 26c17 0 29 0 40 -26l256 -625h97v-47zM503 240l-114 278l-114 -278h228Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D401" d="M753 186c0 -98 -84 -186 -250 -186h-464v47h108v592h-108v47h434c161 0 248 -80 248 -172c0 -77 -65 -137 -173 -156c119 -9 205 -76 205 -172zM579 514c0 46 -18 125 -119 125h-182v-264h156c97 0 145 62 145 139zM606 187c0 11 0 67 -33 109c-34 43 -81 43 -101 43 h-194v-292h184c144 0 144 128 144 140Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D402" d="M766 227c0 -115 -113 -238 -300 -238c-249 0 -402 149 -402 354s153 354 402 354c68 0 135 -18 197 -68l66 59c8 7 10 9 19 9c18 0 18 -9 18 -28v-215c0 -26 -1 -28 -27 -28c-23 0 -24 2 -27 21c-22 127 -117 203 -225 203c-52 0 -139 -11 -204 -77 c-63 -66 -66 -174 -66 -230c0 -90 12 -165 59 -222c52 -61 136 -85 214 -85c101 0 222 61 229 195c1 17 10 17 23 17c17 0 24 -1 24 -21Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D413" d="M757 434h-47c-10 114 -20 194 -163 194h-76v-581h153v-47c-54 3 -165 3 -224 3s-170 0 -224 -3v47h153v581h-77c-144 0 -154 -81 -163 -194h-47l21 241h673Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D400" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="869" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D401" x="1259" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="2077" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D402" x="2467" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="3298" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="3688" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4244" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4634" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="5023" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="5690" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D413" x="6747" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="7547" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="7937" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="8493" y="0"></use>
</g>
</svg>.  Such a transformation <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.859ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 800.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper T</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D413" d="M757 434h-47c-10 114 -20 194 -163 194h-76v-581h153v-47c-54 3 -165 3 -224 3s-170 0 -224 -3v47h153v581h-77c-144 0 -154 -81 -163 -194h-47l21 241h673Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D413" x="0" y="0"></use>
</g>
</svg> can be computed by
multiplying the matrices of the transformations <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.019ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 869.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper A</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D400" d="M827 0c-35 3 -123 3 -163 3c-43 0 -138 0 -176 -3v47h95l-60 146h-268l-50 -121l-4 -12c0 -13 89 -13 89 -13v-47c-37 3 -93 3 -132 3l-117 -3v47h21c76 0 79 8 85 23l248 602c7 18 11 26 39 26c17 0 29 0 40 -26l256 -625h97v-47zM503 240l-114 278l-114 -278h228Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D400" x="0" y="0"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.901ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 818.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper B</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D401" d="M753 186c0 -98 -84 -186 -250 -186h-464v47h108v592h-108v47h434c161 0 248 -80 248 -172c0 -77 -65 -137 -173 -156c119 -9 205 -76 205 -172zM579 514c0 46 -18 125 -119 125h-182v-264h156c97 0 145 62 145 139zM606 187c0 11 0 67 -33 109c-34 43 -81 43 -101 43 h-194v-292h184c144 0 144 128 144 140Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D401" x="0" y="0"></use>
</g>
</svg>, and
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.931ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 831.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper C</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D402" d="M766 227c0 -115 -113 -238 -300 -238c-249 0 -402 149 -402 354s153 354 402 354c68 0 135 -18 197 -68l66 59c8 7 10 9 19 9c18 0 18 -9 18 -28v-215c0 -26 -1 -28 -27 -28c-23 0 -24 2 -27 21c-22 127 -117 203 -225 203c-52 0 -139 -11 -204 -77 c-63 -66 -66 -174 -66 -230c0 -90 12 -165 59 -222c52 -61 136 -85 214 -85c101 0 222 61 229 195c1 17 10 17 23 17c17 0 24 -1 24 -21Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D402" x="0" y="0"></use>
</g>
</svg> together.  In <tt>pbrt</tt>, we can write:

</p>
<p></p>
<div class="fragmentcode">Transform T = A * B * C;</div><p>


</p>
<p> Then we can apply <tt>T</tt> to <a href="../Geometry_and_Transformations/Points.html#Point3f"><tt>Point3f</tt></a>s <tt>p</tt> as
usual, <tt>Point3f pp = T(p)</tt>,
instead of applying each transformation in turn: <tt>Point3f pp = A(B(C(p)))</tt>.

</p>
<p>We overload the C++ <tt>*</tt> operator in the <a href="../Geometry_and_Transformations/Transformations.html#Transform"><tt>Transform</tt></a> class to
compute the new transformation that results
from postmultiplying a transformation with another transformation
<tt>t2</tt>.  In matrix multiplication, the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.604ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 1982.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis i comma j right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D457" d="M397 625c0 -27 -27 -53 -54 -53c-23 0 -37 16 -37 36c0 30 30 53 53 53c24 0 38 -17 38 -36zM360 350c0 -3 0 -17 -5 -37l-92 -366c-25 -99 -118 -152 -188 -152c-48 0 -88 22 -88 62c0 36 29 57 54 57c27 0 38 -19 38 -35c0 -20 -15 -46 -45 -53c18 -9 33 -9 39 -9 c56 0 104 57 123 133l94 373c4 17 7 28 7 51c0 42 -18 46 -32 46c-55 0 -101 -61 -126 -122c-8 -19 -9 -20 -18 -20c0 0 -12 0 -12 10c0 9 57 154 159 154c50 0 92 -35 92 -92Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D456" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="735" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D457" x="1180" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1592" y="0"></use>
</g>
</svg>th element of
the resulting matrix is the inner product of the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 345.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D456" x="0" y="0"></use>
</g>
</svg>th row of the first
matrix with the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.987ex" height="2.509ex" style="vertical-align: -0.671ex; margin-left: -0.029ex;" viewBox="-12.5 -791.3 425 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">j</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D457" d="M397 625c0 -27 -27 -53 -54 -53c-23 0 -37 16 -37 36c0 30 30 53 53 53c24 0 38 -17 38 -36zM360 350c0 -3 0 -17 -5 -37l-92 -366c-25 -99 -118 -152 -188 -152c-48 0 -88 22 -88 62c0 36 29 57 54 57c27 0 38 -19 38 -35c0 -20 -15 -46 -45 -53c18 -9 33 -9 39 -9 c56 0 104 57 123 133l94 373c4 17 7 28 7 51c0 42 -18 46 -32 46c-55 0 -101 -61 -126 -122c-8 -19 -9 -20 -18 -20c0 0 -12 0 -12 10c0 9 57 154 159 154c50 0 92 -35 92 -92Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D457" x="0" y="0"></use>
</g>
</svg>th column of the second.

</p>
<p>The inverse of the resulting transformation is equal to the product of
<tt>t2.mInv * mInv</tt>. This is a result of the matrix
identity
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.394ex" height="3.176ex" style="vertical-align: -0.838ex;" viewBox="0 -1006.6 8780.7 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis bold upper A bold upper B right-parenthesis Superscript negative 1 Baseline equals bold upper B Superscript negative 1 Baseline bold upper A Superscript negative 1 Baseline period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D400" d="M827 0c-35 3 -123 3 -163 3c-43 0 -138 0 -176 -3v47h95l-60 146h-268l-50 -121l-4 -12c0 -13 89 -13 89 -13v-47c-37 3 -93 3 -132 3l-117 -3v47h21c76 0 79 8 85 23l248 602c7 18 11 26 39 26c17 0 29 0 40 -26l256 -625h97v-47zM503 240l-114 278l-114 -278h228Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D401" d="M753 186c0 -98 -84 -186 -250 -186h-464v47h108v592h-108v47h434c161 0 248 -80 248 -172c0 -77 -65 -137 -173 -156c119 -9 205 -76 205 -172zM579 514c0 46 -18 125 -119 125h-182v-264h156c97 0 145 62 145 139zM606 187c0 11 0 67 -33 109c-34 43 -81 43 -101 43 h-194v-292h184c144 0 144 128 144 140Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D400" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D401" x="1259" y="0"></use>
<g transform="translate(2077,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="0" y="0"></use>
<g transform="translate(389,412)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2212" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="778" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="3749" y="0"></use>
<g transform="translate(4805,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D401" x="0" y="0"></use>
<g transform="translate(818,413)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2212" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="778" y="0"></use>
</g>
</g>
<g transform="translate(6628,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D400" x="0" y="0"></use>
<g transform="translate(869,425)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2212" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="778" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="8502" y="0"></use>
</g>
</svg>
</div>
<p>


</p>
<p>

</p>
<p></p>
<span class="anchor" id="fragment-TransformMethodDefinitions-1"></span><div class="fragmentname">&lt;&lt;Transform Method Definitions&gt;&gt;+=&nbsp;<a href="#fragment-TransformMethodDefinitions-0"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-TransformMethodDefinitions-2"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Transformations.html#Transform" class="code">Transform</a> <span class="anchor" id="Transform::operator"></span><a href="../Geometry_and_Transformations/Transformations.html#Transform" class="code">Transform</a>::operator*(const <a href="../Geometry_and_Transformations/Transformations.html#Transform" class="code">Transform</a> &amp;t2) const {
    return <a href="../Geometry_and_Transformations/Transformations.html#Transform" class="code">Transform</a>(m * t2.m, t2.mInv * mInv);
}</div><p>


</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#TransformationsandCoordinateSystemHandedness"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="TransformationsandCoordinateSystemHandedness"></span><h3>3.10.7  Transformations and Coordinate System Handedness</h3><p>


</p>
<p>

</p>
<p> Certain types of transformations change a left-handed coordinate system into a
right-handed one, or vice versa.  Some routines will need to know if the
handedness of the source coordinate system is different from that of the
destination.  In particular, routines that want to ensure that a surface normal
always points &ldquo;outside&rdquo; of a surface might need to flip the normal&rsquo;s
direction after
transformation if the handedness changes.  

</p>
<p>Fortunately, it is easy to tell if handedness is changed by a
transformation: it happens only when the determinant of the
transformation&rsquo;s upper-left 3<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.808ex" height="1.509ex" style="vertical-align: 0.019ex; margin-bottom: -0.19ex;" viewBox="0 -576.1 778.5 649.8" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">times</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-D7" d="M624 15c-7 -8 -20 -8 -28 0l-207 207l-207 -207c-8 -8 -21 -8 -28 0c-8 7 -8 20 0 28l207 207l-207 207c-8 8 -8 21 0 28c7 8 20 8 28 0l207 -207l207 207c8 8 21 8 28 0c8 -7 8 -20 0 -28l-207 -207l207 -207c8 -8 8 -21 0 -28Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-D7" x="0" y="0"></use>
</g>
</svg>3 submatrix is negative.

</p>
<p></p>
<span class="anchor" id="fragment-TransformMethodDefinitions-2"></span><div class="fragmentname">&lt;&lt;Transform Method Definitions&gt;&gt;+=&nbsp;<a href="#fragment-TransformMethodDefinitions-1"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">bool <span class="anchor" id="Transform::SwapsHandedness"></span><a href="../Geometry_and_Transformations/Transformations.html#Transform" class="code">Transform</a>::SwapsHandedness() const {
    <a href="../Utilities/Mathematical_Infrastructure.html#SquareMatrix" class="code">SquareMatrix</a>&lt;3&gt; s(m[0][0], m[0][1], m[0][2],
                      m[1][0], m[1][1], m[1][2],
                      m[2][0], m[2][1], m[2][2]);
    return <a href="../Utilities/Mathematical_Infrastructure.html#SquareMatrix::Determinant" class="code">Determinant</a>(s) &lt; 0;
}</div><p>


</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#VectorFrames"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="VectorFrames"></span><h3>3.10.8  Vector Frames</h3><p>


</p>
<p>It is sometimes useful to define a rotation that aligns three
orthonormal vectors in a coordinate system with the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.139ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 490.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
</g>
</svg>, and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.086ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 467.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
</g>
</svg>
axes.  Applying such a transformation to direction vectors in that coordinate
system can simplify subsequent computations.  For example, in <tt>pbrt</tt>, BSDF
evaluation is performed in a coordinate system where the surface normal is
aligned with the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.086ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 467.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
</g>
</svg> axis.  Among other things, this makes it possible 
to efficiently evaluate trigonometric functions using functions like the <a href="../Geometry_and_Transformations/Spherical_Geometry.html#CosTheta"><tt>CosTheta()</tt></a>
function that was introduced in Section&nbsp;<a href="../Geometry_and_Transformations/Spherical_Geometry.html#sec:spherical-parameterizations">3.8.3</a>.

</p>
<p>The <tt>Frame</tt> class efficiently represents and performs such
transformations, avoiding the full generality (and hence, complexity) of
the <tt>Transform</tt> class.  It only needs to store a <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.165ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2223.9 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">3 times 3</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-33" d="M457 171c0 -102 -91 -193 -213 -193c-109 0 -202 66 -202 157c0 44 32 58 56 58c29 0 56 -20 56 -56c0 -38 -31 -60 -66 -55c35 -59 110 -76 153 -76c44 0 113 29 113 165c0 98 -37 166 -119 166h-44c-17 0 -24 0 -24 11c0 10 7 11 15 12c7 0 31 2 39 3c25 1 59 4 89 52 c26 44 28 102 28 114c0 90 -55 112 -96 112c-36 0 -102 -13 -133 -62c15 0 62 0 62 -50c0 -29 -20 -51 -51 -51c-29 0 -51 19 -51 52c0 76 76 136 177 136c96 0 184 -56 184 -138c0 -79 -58 -149 -140 -176c104 -21 167 -99 167 -181Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-D7" d="M624 15c-7 -8 -20 -8 -28 0l-207 207l-207 -207c-8 -8 -21 -8 -28 0c-8 7 -8 20 0 28l207 207l-207 207c-8 8 -8 21 0 28c7 8 20 8 28 0l207 -207l207 207c8 8 21 8 28 0c8 -7 8 -20 0 -28l-207 -207l207 -207c8 -8 8 -21 0 -28Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-33" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-D7" x="722" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-33" x="1723" y="0"></use>
</g>
</svg> matrix,
and storing the inverse is unnecessary since it is just the matrix&rsquo;s
transpose, given orthonormal basis vectors.

</p>
<p></p>
<span class="anchor" id="fragment-FrameDefinition-0"></span><div class="fragmentname">&lt;&lt;Frame Definition&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">class <span class="anchor" id="Frame"></span>Frame {
  public:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-FramePublicMethods-0">Frame Public Methods</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-126" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-126"><i></i></a><div id="fragbit-126" class="collapse show"><div class="fragmentcode">       <a href="#Frame" class="code">Frame</a>() : <a href="#Frame::x" class="code">x</a>(1, 0, 0), <a href="#Frame::y" class="code">y</a>(0, 1, 0), <a href="#Frame::z" class="code">z</a>(0, 0, 1) {}
       <a href="#Frame" class="code">Frame</a>(<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> <a href="#Frame::x" class="code">x</a>, <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> <a href="#Frame::y" class="code">y</a>, <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> <a href="#Frame::z" class="code">z</a>);
       static <a href="#Frame" class="code">Frame</a> FromXZ(<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> <a href="#Frame::x" class="code">x</a>, <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> <a href="#Frame::z" class="code">z</a>) {
           return <a href="#Frame" class="code">Frame</a>(<a href="#Frame::x" class="code">x</a>, <a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(<a href="#Frame::z" class="code">z</a>, <a href="#Frame::x" class="code">x</a>), <a href="#Frame::z" class="code">z</a>);
       }
       static <a href="#Frame" class="code">Frame</a> FromXY(<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> <a href="#Frame::x" class="code">x</a>, <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> <a href="#Frame::y" class="code">y</a>) {
           return <a href="#Frame" class="code">Frame</a>(<a href="#Frame::x" class="code">x</a>, <a href="#Frame::y" class="code">y</a>, <a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(<a href="#Frame::x" class="code">x</a>, <a href="#Frame::y" class="code">y</a>));
       }
       static <a href="#Frame" class="code">Frame</a> FromZ(<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> <a href="#Frame::z" class="code">z</a>) {
           <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> <a href="#Frame::x" class="code">x</a>, <a href="#Frame::y" class="code">y</a>;
           <a href="../Geometry_and_Transformations/Vectors.html#CoordinateSystem" class="code">CoordinateSystem</a>(<a href="#Frame::z" class="code">z</a>, &amp;<a href="#Frame::x" class="code">x</a>, &amp;<a href="#Frame::y" class="code">y</a>);
           return <a href="#Frame" class="code">Frame</a>(<a href="#Frame::x" class="code">x</a>, <a href="#Frame::y" class="code">y</a>, <a href="#Frame::z" class="code">z</a>);
       }
       static <a href="#Frame" class="code">Frame</a> FromX(<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> <a href="#Frame::x" class="code">x</a>) {
           <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> <a href="#Frame::y" class="code">y</a>, <a href="#Frame::z" class="code">z</a>;
           <a href="../Geometry_and_Transformations/Vectors.html#CoordinateSystem" class="code">CoordinateSystem</a>(<a href="#Frame::x" class="code">x</a>, &amp;<a href="#Frame::y" class="code">y</a>, &amp;<a href="#Frame::z" class="code">z</a>);
           return <a href="#Frame" class="code">Frame</a>(<a href="#Frame::x" class="code">x</a>, <a href="#Frame::y" class="code">y</a>, <a href="#Frame::z" class="code">z</a>);
       }
       static <a href="#Frame" class="code">Frame</a> FromY(<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> <a href="#Frame::y" class="code">y</a>) {
           <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> <a href="#Frame::x" class="code">x</a>, <a href="#Frame::z" class="code">z</a>;
           <a href="../Geometry_and_Transformations/Vectors.html#CoordinateSystem" class="code">CoordinateSystem</a>(<a href="#Frame::y" class="code">y</a>, &amp;<a href="#Frame::z" class="code">z</a>, &amp;<a href="#Frame::x" class="code">x</a>);
           return <a href="#Frame" class="code">Frame</a>(<a href="#Frame::x" class="code">x</a>, <a href="#Frame::y" class="code">y</a>, <a href="#Frame::z" class="code">z</a>);
       }
       static <a href="#Frame" class="code">Frame</a> FromX(<a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> <a href="#Frame::x" class="code">x</a>) {
           <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> <a href="#Frame::y" class="code">y</a>, <a href="#Frame::z" class="code">z</a>;
           <a href="../Geometry_and_Transformations/Vectors.html#CoordinateSystem" class="code">CoordinateSystem</a>(<a href="#Frame::x" class="code">x</a>, &amp;<a href="#Frame::y" class="code">y</a>, &amp;<a href="#Frame::z" class="code">z</a>);
           return <a href="#Frame" class="code">Frame</a>(<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(<a href="#Frame::x" class="code">x</a>), <a href="#Frame::y" class="code">y</a>, <a href="#Frame::z" class="code">z</a>);
       }
       static <a href="#Frame" class="code">Frame</a> FromY(<a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> <a href="#Frame::y" class="code">y</a>) {
           <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> <a href="#Frame::x" class="code">x</a>, <a href="#Frame::z" class="code">z</a>;
           <a href="../Geometry_and_Transformations/Vectors.html#CoordinateSystem" class="code">CoordinateSystem</a>(<a href="#Frame::y" class="code">y</a>, &amp;<a href="#Frame::z" class="code">z</a>, &amp;<a href="#Frame::x" class="code">x</a>);
           return <a href="#Frame" class="code">Frame</a>(<a href="#Frame::x" class="code">x</a>, <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(<a href="#Frame::y" class="code">y</a>), <a href="#Frame::z" class="code">z</a>);
       }
       PBRT_CPU_GPU
       static <a href="#Frame" class="code">Frame</a> FromZ(<a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> <a href="#Frame::z" class="code">z</a>) { return FromZ(<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(<a href="#Frame::z" class="code">z</a>)); }
       <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> ToLocal(<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> v) const {
           return <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(<a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(v, <a href="#Frame::x" class="code">x</a>), <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(v, <a href="#Frame::y" class="code">y</a>), <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(v, <a href="#Frame::z" class="code">z</a>));
       }
       <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> ToLocal(<a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> n) const {
           return <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(<a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(n, <a href="#Frame::x" class="code">x</a>), <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(n, <a href="#Frame::y" class="code">y</a>), <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(n, <a href="#Frame::z" class="code">z</a>));
       }
       <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> FromLocal(<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> v) const {
           return v.<a href="#Frame::x" class="code">x</a> * <a href="#Frame::x" class="code">x</a> + v.<a href="#Frame::y" class="code">y</a> * <a href="#Frame::y" class="code">y</a> + v.<a href="#Frame::z" class="code">z</a> * <a href="#Frame::z" class="code">z</a>;
       }
       <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> FromLocal(<a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> n) const {
           return <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(n.<a href="#Frame::x" class="code">x</a> * <a href="#Frame::x" class="code">x</a> + n.<a href="#Frame::y" class="code">y</a> * <a href="#Frame::y" class="code">y</a> + n.<a href="#Frame::z" class="code">z</a> * <a href="#Frame::z" class="code">z</a>);
       }
       std::string ToString() const {
           return StringPrintf("[ <a href="#Frame" class="code">Frame</a> <a href="#Frame::x" class="code">x</a>: %s <a href="#Frame::y" class="code">y</a>: %s <a href="#Frame::z" class="code">z</a>: %s ]", <a href="#Frame::x" class="code">x</a>, <a href="#Frame::y" class="code">y</a>, <a href="#Frame::z" class="code">z</a>);
       }</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-FramePublicMembers-0">Frame Public Members</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-127" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-127"><i></i></a><div id="fragbit-127" class="collapse show"><div class="fragmentcode">       <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> x, y, z;</div></div>
};</div><p>


</p>
<p>Given three orthonormal vectors <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold x</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D431" d="M585 0l-110 3l-120 -3v47h39l-110 130l-97 -109c-7 -8 -7 -10 -7 -10c0 -6 19 -11 37 -11v-47l-103 3l-92 -3v47c48 0 84 0 101 19l131 147l-156 184h-71v47l110 -3l121 3v-47h-40l98 -115l84 94c4 4 4 6 8 12c-12 7 -24 9 -38 9v47l103 -3l92 3v-47 c-83 0 -89 -7 -102 -21l-117 -130l168 -199h71v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D431" x="0" y="0"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 607.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D432" d="M580 397c-64 0 -67 -7 -74 -21l-215 -457c-27 -57 -85 -119 -162 -119c-60 0 -107 41 -107 92c0 39 29 58 57 58c34 0 58 -24 58 -57c0 -35 -23 -49 -32 -53c8 -3 10 -4 24 -4c71 0 103 68 125 116l23 48l-187 397h-64v47l114 -3l124 3v-47h-54l127 -270l115 246l5 12 c0 12 -47 12 -47 12v47l91 -3c25 0 55 1 79 3v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D432" x="0" y="0"></use>
</g>
</svg>, and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.188ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 511.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D433" d="M462 202l-18 -202h-380c-19 0 -32 0 -32 22c0 9 0 11 9 22l279 364h-85c-103 0 -134 -36 -140 -139h-47l12 175h367c18 0 32 0 32 -21c0 -9 -2 -11 -10 -22l-277 -361h86c132 0 148 61 157 162h47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D433" x="0" y="0"></use>
</g>
</svg>, the
matrix <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.683ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 724.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper F</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D405" d="M675 439h-47c-15 117 -38 194 -199 194h-140v-269h50c97 0 105 43 105 117h47v-281h-47c0 74 -9 117 -105 117h-50v-270h135v-47c-44 3 -153 3 -202 3c-44 0 -145 0 -183 -3v47h108v586h-108v47h605Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D405" x="0" y="0"></use>
</g>
</svg> that transforms vectors into their space is
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="31.663ex" height="10.176ex" style="vertical-align: -4.266ex; margin-bottom: -0.239ex;" viewBox="0 -2441.8 13632.4 4381.3" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper F equals Start 3 By 3 Matrix 1st Row 1st Column bold x Subscript x Baseline 2nd Column bold x Subscript y Baseline 3rd Column bold x Subscript z Baseline 2nd Row 1st Column bold y Subscript x Baseline 2nd Column bold y Subscript y Baseline 3rd Column bold y Subscript z Baseline 3rd Row 1st Column bold z Subscript x Baseline 2nd Column bold z Subscript y Baseline 3rd Column bold z Subscript z Baseline EndMatrix equals Start 3 By 1 Matrix 1st Row  bold x 2nd Row  bold y 3rd Row  bold z EndMatrix period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D405" d="M675 439h-47c-15 117 -38 194 -199 194h-140v-269h50c97 0 105 43 105 117h47v-281h-47c0 74 -9 117 -105 117h-50v-270h135v-47c-44 3 -153 3 -202 3c-44 0 -145 0 -183 -3v47h108v586h-108v47h605Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D431" d="M585 0l-110 3l-120 -3v47h39l-110 130l-97 -109c-7 -8 -7 -10 -7 -10c0 -6 19 -11 37 -11v-47l-103 3l-92 -3v47c48 0 84 0 101 19l131 147l-156 184h-71v47l110 -3l121 3v-47h-40l98 -115l84 94c4 4 4 6 8 12c-12 7 -24 9 -38 9v47l103 -3l92 3v-47 c-83 0 -89 -7 -102 -21l-117 -130l168 -199h71v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D432" d="M580 397c-64 0 -67 -7 -74 -21l-215 -457c-27 -57 -85 -119 -162 -119c-60 0 -107 41 -107 92c0 39 29 58 57 58c34 0 58 -24 58 -57c0 -35 -23 -49 -32 -53c8 -3 10 -4 24 -4c71 0 103 68 125 116l23 48l-187 397h-64v47l114 -3l124 3v-47h-54l127 -270l115 246l5 12 c0 12 -47 12 -47 12v47l91 -3c25 0 55 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D433" d="M462 202l-18 -202h-380c-19 0 -32 0 -32 22c0 9 0 11 9 22l279 364h-85c-103 0 -134 -36 -140 -139h-47l12 175h367c18 0 32 0 32 -21c0 -9 -2 -11 -10 -22l-277 -361h86c132 0 148 61 157 162h47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239B" d="M823 1474c0 -7 -3 -13 -9 -17c-255 -192 -435 -739 -435 -1207v-250h-102v250c0 490 245 1039 513 1241c3 2 7 4 12 4c11 0 21 -10 21 -21Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239D" d="M823 21c0 -12 -10 -21 -21 -21c-5 0 -9 2 -12 4c-268 201 -513 751 -513 1241v250h102v-250c0 -469 180 -1015 435 -1208c6 -3 9 -9 9 -16Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239C" d="M379 0h-102v498h102v-498Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239E" d="M598 0h-102v250c0 468 -180 1015 -435 1207c-6 4 -9 10 -9 17c0 11 10 21 21 21c5 0 9 -2 12 -4c268 -202 513 -751 513 -1241v-250Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A0" d="M598 1245c0 -490 -245 -1040 -513 -1241c-3 -2 -7 -4 -12 -4c-11 0 -21 9 -21 21c0 7 3 13 9 16c255 193 435 739 435 1208v250h102v-250Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239F" d="M598 498v-498h-102v498h102Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D405" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1002" y="0"></use>
<g transform="translate(2058,0)">
<g transform="translate(0,2336)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239B" x="0" y="-1496"></use>
<g transform="translate(0,-2723.7886351729485) scale(1,2.558694659665227)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239C"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239D" x="0" y="-4173"></use>
</g>
<g transform="translate(1042,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,1536)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D431" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="859" y="-213"></use>
</g>
<g transform="translate(0,41)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D432" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="859" y="-335"></use>
</g>
<g transform="translate(48,-1542)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D433" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="723" y="-213"></use>
</g>
</g>
<g transform="translate(2101,0)">
<g transform="translate(0,1536)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D431" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="859" y="-213"></use>
</g>
<g transform="translate(0,41)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D432" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="859" y="-335"></use>
</g>
<g transform="translate(47,-1542)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D433" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="723" y="-213"></use>
</g>
</g>
<g transform="translate(4156,0)">
<g transform="translate(0,1536)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D431" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="859" y="-213"></use>
</g>
<g transform="translate(0,41)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D432" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="859" y="-335"></use>
</g>
<g transform="translate(47,-1542)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D433" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="723" y="-213"></use>
</g>
</g>
</g>
<g transform="translate(6403,2336)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239E" x="0" y="-1496"></use>
<g transform="translate(0,-2723.7886351729485) scale(1,2.558694659665227)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239F"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A0" x="0" y="-4173"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="9615" y="0"></use>
<g transform="translate(10671,0)">
<g transform="translate(0,2150)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239B" x="0" y="-1496"></use>
<g transform="translate(0,-2352.186) scale(1,1.814)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239C"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239D" x="0" y="-3800"></use>
</g>
<g transform="translate(1042,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D431" x="0" y="1350"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D432" x="0" y="-50"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D433" x="48" y="-1451"></use>
</g>
</g>
<g transform="translate(1806,2150)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239E" x="0" y="-1496"></use>
<g transform="translate(0,-2352.186) scale(1,1.814)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239F"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A0" x="0" y="-3800"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="13353" y="0"></use>
</g>
</svg>
</div>
<p>


</p>
<p>The <tt>Frame</tt> stores this matrix using three <a href="../Geometry_and_Transformations/Vectors.html#Vector3f"><tt>Vector3f</tt></a>s.

</p>
<p></p>
<span class="anchor" id="fragment-FramePublicMembers-0"></span><div class="fragmentname">&lt;&lt;Frame Public Members&gt;&gt;=&nbsp;</div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> <span class="anchor" id="Frame::x"></span>x, <span class="anchor" id="Frame::y"></span>y, <span class="anchor" id="Frame::z"></span>z;</div><p>


</p>
<p>The three basis vectors can be specified explicitly; in debug builds,
<a href="../Utilities/User_Interaction.html#DCHECK"><tt>DCHECK()</tt></a>s in the constructor ensure that the provided vectors
are orthonormal.

</p>
<p></p>
<span class="anchor" id="fragment-FramePublicMethods-0"></span><div class="fragmentname">&lt;&lt;Frame Public Methods&gt;&gt;=&nbsp;<a href="#fragment-FramePublicMethods-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode"><a href="#Frame" class="code">Frame</a>() : x(1, 0, 0), y(0, 1, 0), z(0, 0, 1) {}
<a href="#Frame" class="code">Frame</a>(<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> x, <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> y, <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> z);</div><p>


</p>
<p>

</p>
<p><tt>Frame</tt> also provides convenience methods that construct a frame from
just two of the basis vectors, using the cross product to compute the
third.

</p>
<p></p>
<span class="anchor" id="fragment-FramePublicMethods-1"></span><div class="fragmentname">&lt;&lt;Frame Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-FramePublicMethods-0"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-FramePublicMethods-2"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">static <a href="#Frame" class="code">Frame</a> <span class="anchor" id="Frame::FromXZ"></span>FromXZ(<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> x, <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> z) {
    return <a href="#Frame" class="code">Frame</a>(x, <a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(z, x), z);
}
static <a href="#Frame" class="code">Frame</a> <span class="anchor" id="Frame::FromXY"></span>FromXY(<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> x, <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> y) {
    return <a href="#Frame" class="code">Frame</a>(x, y, <a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(x, y));
}</div><p>


</p>
<p>Only the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.086ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 467.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
</g>
</svg> axis vector can be provided as well, in which case the others
are set arbitrarily.

</p>
<p></p>
<span class="anchor" id="fragment-FramePublicMethods-2"></span><div class="fragmentname">&lt;&lt;Frame Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-FramePublicMethods-1"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-FramePublicMethods-3"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">static <a href="#Frame" class="code">Frame</a> <span class="anchor" id="Frame::FromZ"></span>FromZ(<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> z) {
    <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> x, y;
    <a href="../Geometry_and_Transformations/Vectors.html#CoordinateSystem" class="code">CoordinateSystem</a>(z, &amp;x, &amp;y);
    return <a href="#Frame" class="code">Frame</a>(x, y, z);
}</div><p>


</p>
<p>

</p>
<p>A variety of other functions, not included here, allow specifying a frame
using a normal vector and specifying it via just the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
</g>
</svg> or <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.139ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 490.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
</g>
</svg> basis
vector.

</p>
<p>

</p>
<p>

</p>
<p>Transforming a vector into the frame&rsquo;s coordinate space is done using the
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.683ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 724.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper F</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D405" d="M675 439h-47c-15 117 -38 194 -199 194h-140v-269h50c97 0 105 43 105 117h47v-281h-47c0 74 -9 117 -105 117h-50v-270h135v-47c-44 3 -153 3 -202 3c-44 0 -145 0 -183 -3v47h108v586h-108v47h605Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D405" x="0" y="0"></use>
</g>
</svg> matrix.  Because <a href="../Geometry_and_Transformations/Vectors.html#Vector3f"><tt>Vector3f</tt></a>s were used to store its rows, the
matrix-vector product can be expressed as three dot products.
  
</p>
<span class="anchor" id="fragment-FramePublicMethods-3"></span><div class="fragmentname">&lt;&lt;Frame Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-FramePublicMethods-2"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-FramePublicMethods-4"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> <span class="anchor" id="Frame::ToLocal"></span>ToLocal(<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> v) const {
    return <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(<a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(v, <a href="#Frame::x" class="code">x</a>), <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(v, <a href="#Frame::y" class="code">y</a>), <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(v, <a href="#Frame::z" class="code">z</a>));
}</div><p>


</p>
<p>A <tt>ToLocal()</tt> method is also provided for normal vectors.
In this case, we do not need to compute the inverse transpose of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.683ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 724.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper F</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D405" d="M675 439h-47c-15 117 -38 194 -199 194h-140v-269h50c97 0 105 43 105 117h47v-281h-47c0 74 -9 117 -105 117h-50v-270h135v-47c-44 3 -153 3 -202 3c-44 0 -145 0 -183 -3v47h108v586h-108v47h605Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D405" x="0" y="0"></use>
</g>
</svg>
for the transformation normals (recall the discussion of transforming normals in
Section&nbsp;<a href="#sec:normal-transform">3.10.3</a>).  Because <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.683ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 724.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper F</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D405" d="M675 439h-47c-15 117 -38 194 -199 194h-140v-269h50c97 0 105 43 105 117h47v-281h-47c0 74 -9 117 -105 117h-50v-270h135v-47c-44 3 -153 3 -202 3c-44 0 -145 0 -183 -3v47h108v586h-108v47h605Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D405" x="0" y="0"></use>
</g>
</svg> is an orthonormal
matrix (its rows and columns are mutually orthogonal and unit length),
its inverse is equal to its transpose, so it is its own inverse transpose
already.

</p>
<p></p>
<span class="anchor" id="fragment-FramePublicMethods-4"></span><div class="fragmentname">&lt;&lt;Frame Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-FramePublicMethods-3"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-FramePublicMethods-5"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> ToLocal(<a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> n) const {
    return <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(<a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(n, <a href="#Frame::x" class="code">x</a>), <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(n, <a href="#Frame::y" class="code">y</a>), <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(n, <a href="#Frame::z" class="code">z</a>));
}</div><p>


</p>
<p>The method that transforms vectors out of the frame&rsquo;s local space
transposes <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.683ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 724.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper F</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D405" d="M675 439h-47c-15 117 -38 194 -199 194h-140v-269h50c97 0 105 43 105 117h47v-281h-47c0 74 -9 117 -105 117h-50v-270h135v-47c-44 3 -153 3 -202 3c-44 0 -145 0 -183 -3v47h108v586h-108v47h605Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D405" x="0" y="0"></use>
</g>
</svg> to find its inverse before multiplying by the
vector.  In this case, the resulting computation can be expressed as the
sum of three scaled versions of the matrix columns.  As before, surface
normals transform as regular vectors.  (That method is not
included here.)

</p>
<p></p>
<span class="anchor" id="fragment-FramePublicMethods-5"></span><div class="fragmentname">&lt;&lt;Frame Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-FramePublicMethods-4"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> <span class="anchor" id="Frame::FromLocal"></span>FromLocal(<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> v) const {
    return v.<a href="#Frame::x" class="code">x</a> * <a href="#Frame::x" class="code">x</a> + v.<a href="#Frame::y" class="code">y</a> * <a href="#Frame::y" class="code">y</a> + v.<a href="#Frame::z" class="code">z</a> * <a href="#Frame::z" class="code">z</a>;
}</div><p>


</p>
<p>

</p>
<p>

</p>
<p>For convenience, there is a <a href="../Geometry_and_Transformations/Transformations.html#Transform"><tt>Transform</tt></a> constructor that takes a
<tt>Frame</tt>.  Its simple implementation is not included here.

</p>
<p></p>
<span class="anchor" id="fragment-TransformPublicMethods-8"></span><div class="fragmentname">&lt;&lt;Transform Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-TransformPublicMethods-7"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="../Shapes/Managing_Rounding_Error.html#fragment-TransformPublicMethods-9"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">explicit <a href="../Geometry_and_Transformations/Transformations.html#Transform" class="code">Transform</a>(const <a href="#Frame" class="code">Frame</a> &amp;frame);</div><p>


</p>
<p>

</p>
<p>

</p>
<p>

</p>
<p>

</p>
<p>

</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

</div>  <!-- container-fluid -->
</div>  <!-- maincontainer -->

<nav class="navbar navbar-expand-md bg-light navbar-light">
<div class="container-fluid">
  <span class="navbar-text"><i>Physically Based Rendering: From Theory To Implementation</i>,<br>
<a href="https://creativecommons.org/licenses/by-nc-nd/4.0/">&copy; 2004-2023</a> Matt Pharr, Wenzel Jakob, and Greg Humphreys.
<a href="https://github.com/mmp/pbr-book-website/"><span class="fab fa-github"></span></a><br>
Purchase a printed copy: <a href="https://www.amazon.com/Physically-Based-Rendering-fourth-Implementation/dp/0262048027?keywords=physically+based+rendering+4th+edition&qid=1671730412&sprefix=physically+based%!C(MISSING)aps%!C(MISSING)145&sr=8-1&linkCode=ll1&tag=pharr-20&linkId=81a816d90f0c7e872617f1f930a51fd6&language=en_US&ref_=as_li_ss_tl"><span class="fab fa-amazon"></span></a>
<a href="https://mitpress.mit.edu/9780262048026/physically-based-rendering/"><img src="/mitpress.png" width=10 height=16></a>
</span>
</div>
  <div class="container">
    <ul class="nav navbar-nav ml-auto">
      <li class="nav-item">Next: <a href="../Geometry_and_Transformations/Interactions.html">Geometry and Transformations / Interactions</a></li>
    </ul>
  </div>

</nav>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script>
  $(function () {
    $('[data-toggle="popover"]').popover()
    $('[data-toggle="tooltip"]').tooltip()
   })
</script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

<script>
// https://stackoverflow.com/a/17535094
// The function actually applying the offset
function offsetAnchor() {
  if (location.hash.length !== 0) {
    window.scrollTo(window.scrollX, window.scrollY - window.innerHeight / 8);
  }
}

// Captures click events of all <a> elements with href starting with #
$(document).on('click', 'a[href^="#"]', function(event) {
  // Click events are captured before hashchanges. Timeout
  // causes offsetAnchor to be called after the page jump.
  window.setTimeout(function() {
    offsetAnchor();
  }, 500);
});

// Set the offset when entering page with hash present in the url
window.setTimeout(offsetAnchor, 1500);
</script>

</body>
</html>
