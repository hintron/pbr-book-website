
<!doctype html>
<html lang="en">
<head>

<!-- all praise to https://realfavicongenerator.net -->
<link rel="icon" href="/favicon.ico?v=2" /> <!-- force refresh -->
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="/fonts.css">
  <link rel="stylesheet" href="../pbrstyle.css">
  <link rel="stylesheet" href="/fontawesome-free-5.15.3-web/css/all.css">

<script async src="https://cse.google.com/cse.js?cx=22a43cef261a245ea"></script>  <script src="/react.min.js"></script>
  <script src="/react-dom.min.js"></script>
  <script src="/jeri.min.js"></script>
  <link rel="preload" href="/exr.worker.js" as="script" crossorigin="anonymous">
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="/bootstrap.min.css">

  <title>Vectors</title>
</head>
        
<body>

<nav class="fixed-top-lg-navbar navbar navbar-expand bg-light navbar-light">
  <ul class="nav navbar-nav">
    <a class="navbar-brand" href="../contents.html"><img src="../pbr.jpg" width=25 height=25></a>
    <li class="nav-item"><a class="nav-link" href="../Geometry_and_Transformations.html">Geometry and Transformations</a></li>
    <span class="navbar-text">/</span>
    <li class="nav-item"><a class="nav-link" href="#">Vectors</a></li>
    <span class="navbar-text">&nbsp;&nbsp;</span>
    <li class="nav-item"><a class="nav-link" href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html">(Previous: n-Tuple Base Classes)</a></li>
  </ul>

  <ul class="nav navbar-nav ml-auto d-none d-md-block">
        <li class="nav-item"><div class="gcse-search"></div></li>
    </ul>
  <ul class="nav navbar-nav d-block d-md-none">
        <li class="nav-item"><div class="gcse-search"></div></li>
    </ul>
</nav>

<div class="maincontainer">
<div class="container-fluid">

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#"><i class="fas fa-link "></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="sec:vectors"></span><h2>3.3 Vectors</h2><p>



</p>
<p><tt>pbrt</tt> provides both 2D and 3D vector classes that are based on the
corresponding two- and three-dimensional tuple classes. Both vector types
are themselves parameterized by the type of the underlying vector element,
thus making it easy to instantiate vectors of both integer and
floating-point types.

</p>
<p></p>
<span class="anchor" id="fragment-Vector2Definition-0"></span><div class="fragmentname">&lt;&lt;Vector2 Definition&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">template &lt;typename T&gt;
class <span class="anchor" id="Vector2"></span>Vector2 : public <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple2" class="code">Tuple2</a>&lt;Vector2, T&gt; {
  public:
    &lt;&lt;<span class="fragmentname">Vector2 Public Methods</span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-77" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-77"><i></i></a><div id="fragbit-77" class="collapse show"><div class="fragmentcode">       using Tuple2&lt;Vector2, T&gt;::x;
       using Tuple2&lt;Vector2, T&gt;::y;
       Vector2() = default;
       Vector2(T x, T y) : Tuple2&lt;pbrt::Vector2, T&gt;(x, y) {}
       template &lt;typename U&gt;
       explicit Vector2(Point2&lt;U&gt; p);
       template &lt;typename U&gt;
       explicit Vector2(Vector2&lt;U&gt; v)
           : Tuple2&lt;pbrt::Vector2, T&gt;(T(v.x), T(v.y)) {}</div></div>
};</div><p>


</p>
<p>

</p>
<p>Two-dimensional vectors of <tt>Float</tt>s and integers are widely used, so
we will define aliases for those two types.

</p>
<p></p>
<span class="anchor" id="fragment-Vector2Definitions-0"></span><div class="fragmentname">&lt;&lt;Vector2* Definitions&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">using <span class="anchor" id="Vector2f"></span>Vector2f = Vector2&lt;Float&gt;;
using <span class="anchor" id="Vector2i"></span>Vector2i = Vector2&lt;int&gt;;</div><p>


</p>
<p>As with <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple2"><tt>Tuple2</tt></a>, we will not include any further details of <a href="#Vector2"><tt>Vector2</tt></a>
since it is very similar to <a href="#Vector3"><tt>Vector3</tt></a>, which we will discuss in more
detail.

</p>
<p>

</p>
<p>A <tt>Vector3</tt>&rsquo;s tuple of component values gives its representation in
terms of the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.139ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 490.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
</g>
</svg>, and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.086ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 467.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
</g>
</svg> (in 3D) axes of the space it is defined in.  The
individual components of a 3D vector <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
</g>
</svg> will be written
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.583ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1112.3 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v Subscript x</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="859" y="-213"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.449ex" height="2.343ex" style="vertical-align: -1.005ex;" viewBox="0 -576.1 1054.3 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v Subscript y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="859" y="-213"></use>
</g>
</svg>, and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.411ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1038.1 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v Subscript z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="859" y="-213"></use>
</g>
</svg>.

</p>
<p></p>
<span class="anchor" id="fragment-Vector3Definition-0"></span><div class="fragmentname">&lt;&lt;Vector3 Definition&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">template &lt;typename T&gt;
class <span class="anchor" id="Vector3"></span>Vector3 : public <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3" class="code">Tuple3</a>&lt;Vector3, T&gt; {
  public:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Vector3PublicMethods-0">Vector3 Public Methods</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-78" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-78"><i></i></a><div id="fragbit-78" class="collapse show"><div class="fragmentcode">       using <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3" class="code">Tuple3</a>&lt;Vector3, T&gt;::x;
       using <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3" class="code">Tuple3</a>&lt;Vector3, T&gt;::y;
       using <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3" class="code">Tuple3</a>&lt;Vector3, T&gt;::z;
       Vector3(T x, T y, T z) : <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3" class="code">Tuple3</a>&lt;pbrt::Vector3, T&gt;(x, y, z) {}
       template &lt;typename U&gt;
       explicit Vector3(Vector3&lt;U&gt; v)
           : <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3" class="code">Tuple3</a>&lt;pbrt::Vector3, T&gt;(T(v.x), T(v.y), T(v.z)) {}
       template &lt;typename U&gt;
       explicit Vector3(Point3&lt;U&gt; p);
       template &lt;typename U&gt;
       explicit Vector3(Normal3&lt;U&gt; n);</div></div>
};</div><p>


</p>
<p>

</p>
<p>

</p>
<p>We also define type aliases for two commonly used three-dimensional vector
types.

</p>
<p></p>
<span class="anchor" id="fragment-Vector3Definitions-0"></span><div class="fragmentname">&lt;&lt;Vector3* Definitions&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">using <span class="anchor" id="Vector3f"></span>Vector3f = Vector3&lt;Float&gt;;
using <span class="anchor" id="Vector3i"></span>Vector3i = Vector3&lt;int&gt;;</div><p>


</p>
<p><tt>Vector3</tt> provides a few constructors, including a default constructor
(not shown here)
and one that allows specifying each component value directly. 

</p>
<p></p>
<span class="anchor" id="fragment-Vector3PublicMethods-0"></span><div class="fragmentname">&lt;&lt;Vector3 Public Methods&gt;&gt;=&nbsp;<a href="#fragment-Vector3PublicMethods-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">Vector3(T x, T y, T z) : Tuple3&lt;pbrt::Vector3, T&gt;(x, y, z) {}</div><p>


</p>
<p>There is also a constructor that takes a <tt>Vector3</tt> with a different
element type.  It is qualified with <tt>explicit</tt> so that it is not
unintentionally used in automatic type conversions; a cast must be used to
signify the intent of the type conversion.

</p>
<p></p>
<span class="anchor" id="fragment-Vector3PublicMethods-1"></span><div class="fragmentname">&lt;&lt;Vector3 Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-Vector3PublicMethods-0"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-Vector3PublicMethods-2"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">template &lt;typename U&gt;
explicit Vector3(Vector3&lt;U&gt; v)
    : <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3" class="code">Tuple3</a>&lt;pbrt::Vector3, T&gt;(T(v.x), T(v.y), T(v.z)) {}</div><p>


</p>
<p>Finally, constructors are provided to convert from the forthcoming
<a href="../Geometry_and_Transformations/Points.html#Point3"><tt>Point3</tt></a> and <a href="../Geometry_and_Transformations/Normals.html#Normal3"><tt>Normal3</tt></a> types.  Their straightforward
implementations are not included here.  These, too, are <tt>explicit</tt> to
help ensure that they are only used in situations where the conversion is
meaningful.

</p>
<p></p>
<span class="anchor" id="fragment-Vector3PublicMethods-2"></span><div class="fragmentname">&lt;&lt;Vector3 Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-Vector3PublicMethods-1"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">template &lt;typename U&gt;
explicit Vector3(Point3&lt;U&gt; p);
template &lt;typename U&gt;
explicit Vector3(Normal3&lt;U&gt; n);</div><p>


</p>
<p>

</p>
<p>Addition and subtraction of vectors is performed component-wise, via methods
from <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3"><tt>Tuple3</tt></a>.  The usual geometric interpretation of vector addition
and subtraction is shown in Figures&nbsp;<a href="#fig:vectoradd">3.3</a>
and&nbsp;<a href="#fig:vectorsubtract">3.4</a>.  A vector&rsquo;s length can be changed via
component-wise multiplication or division by a scalar. These capabilities,
too, are provided by <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3"><tt>Tuple3</tt></a> and so do not require any additional
implementation in the <a href="#Vector3"><tt>Vector3</tt></a> class.

</p>
<p></p>
<span class="anchor" id="fig:vectoradd"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha03f03.svg" title=""><img src="pha03f03.svg" width=330 height=190 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 3.3: <span class="legend"> (a) Vector addition: <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.183ex" height="2.176ex" style="vertical-align: -0.505ex;" viewBox="0 -719.6 2661.9 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v plus bold w</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D430" d="M805 397c-59 0 -63 -8 -68 -21l-144 -353c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-106 259l-106 -259c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-153 374h-59v47l109 -3l123 3v-47h-56l105 -258l79 192c1 3 4 9 4 13c0 0 0 3 -21 53h-59v47c16 -1 58 -3 100 -3l114 3v-47 h-56l114 -280l105 256c1 3 4 9 4 12c0 11 -49 12 -58 12v47l96 -3c24 0 54 1 77 3v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="829" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="1830" y="0"></use>
</g>
</svg>.
(b)  Notice that the sum <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.183ex" height="2.176ex" style="vertical-align: -0.505ex;" viewBox="0 -719.6 2661.9 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v plus bold w</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D430" d="M805 397c-59 0 -63 -8 -68 -21l-144 -353c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-106 259l-106 -259c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-153 374h-59v47l109 -3l123 3v-47h-56l105 -258l79 192c1 3 4 9 4 13c0 0 0 3 -21 53h-59v47c16 -1 58 -3 100 -3l114 3v-47 h-56l114 -280l105 256c1 3 4 9 4 12c0 11 -49 12 -58 12v47l96 -3c24 0 54 1 77 3v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="829" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="1830" y="0"></use>
</g>
</svg> forms the diagonal
of the parallelogram formed by <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.931ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 831.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold w</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D430" d="M805 397c-59 0 -63 -8 -68 -21l-144 -353c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-106 259l-106 -259c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-153 374h-59v47l109 -3l123 3v-47h-56l105 -258l79 192c1 3 4 9 4 13c0 0 0 3 -21 53h-59v47c16 -1 58 -3 100 -3l114 3v-47 h-56l114 -280l105 256c1 3 4 9 4 12c0 11 -49 12 -58 12v47l96 -3c24 0 54 1 77 3v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="0" y="0"></use>
</g>
</svg>,  which
shows the commutativity of vector addition: <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.464ex" height="2.176ex" style="vertical-align: -0.505ex;" viewBox="0 -719.6 6657.9 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v plus bold w equals bold w plus bold v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D430" d="M805 397c-59 0 -63 -8 -68 -21l-144 -353c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-106 259l-106 -259c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-153 374h-59v47l109 -3l123 3v-47h-56l105 -258l79 192c1 3 4 9 4 13c0 0 0 3 -21 53h-59v47c16 -1 58 -3 100 -3l114 3v-47 h-56l114 -280l105 256c1 3 4 9 4 12c0 11 -49 12 -58 12v47l96 -3c24 0 54 1 77 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="829" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="1830" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="2939" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="3996" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="5049" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="6050" y="0"></use>
</g>
</svg>.</span>
</figcaption>
</div></div><p>


</p>
<p></p>
<span class="anchor" id="fig:vectorsubtract"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha03f04.svg" title=""><img src="pha03f04.svg" width=315 height=239 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 3.4: <span class="legend"> (a) Vector subtraction. (b) If we consider the
parallelogram formed by two vectors, the diagonals are given by
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.183ex" height="2.176ex" style="vertical-align: -0.505ex;" viewBox="0 -719.6 2661.9 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold w minus bold v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D430" d="M805 397c-59 0 -63 -8 -68 -21l-144 -353c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-106 259l-106 -259c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-153 374h-59v47l109 -3l123 3v-47h-56l105 -258l79 192c1 3 4 9 4 13c0 0 0 3 -21 53h-59v47c16 -1 58 -3 100 -3l114 3v-47 h-56l114 -280l105 256c1 3 4 9 4 12c0 11 -49 12 -58 12v47l96 -3c24 0 54 1 77 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="1053" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="2054" y="0"></use>
</g>
</svg> (dashed line) and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.991ex" height="2.176ex" style="vertical-align: -0.505ex;" viewBox="0 -719.6 3440.4 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">negative bold v minus bold w</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D430" d="M805 397c-59 0 -63 -8 -68 -21l-144 -353c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-106 259l-106 -259c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-153 374h-59v47l109 -3l123 3v-47h-56l105 -258l79 192c1 3 4 9 4 13c0 0 0 3 -21 53h-59v47c16 -1 58 -3 100 -3l114 3v-47 h-56l114 -280l105 256c1 3 4 9 4 12c0 11 -49 12 -58 12v47l96 -3c24 0 54 1 77 3v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="778" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="1608" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="2608" y="0"></use>
</g>
</svg> (not shown).</span>
</figcaption>
</div></div><p>


</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#NormalizationandVectorLength"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="NormalizationandVectorLength"></span><h3>3.3.1  Normalization and Vector Length</h3><p>


</p>
<p> It is often necessary to <em>normalize</em> a vector&mdash;that is, to
compute a new vector pointing in the same direction but with unit length.
A normalized vector is often called a <em>unit vector</em>.  The notation
used in this book for normalized vectors is that <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.176ex" style="vertical-align: -0.012ex; margin-bottom: -0.326ex;" viewBox="0 -791.3 607.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">ModifyingAbove bold v With caret</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-302" d="M-82 607l-12 -20c-58 25 -115 54 -170 85c-55 -31 -112 -60 -170 -85l-12 20c56 49 117 91 182 127c65 -36 126 -78 182 -127Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-302" x="526" y="-34"></use>
</g>
</svg> is the
normalized version of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
</g>
</svg>.  Before getting to normalization, we will
start with computing vectors&rsquo; lengths.

</p>
<p>The squared length of a vector is given by the sum of the squares of its
component values.

</p>
<p></p>
<span class="anchor" id="fragment-Vector3InlineFunctions-0"></span><div class="fragmentname">&lt;&lt;Vector3 Inline Functions&gt;&gt;=&nbsp;<a href="#fragment-Vector3InlineFunctions-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">template &lt;typename T&gt;
T <span class="anchor" id="LengthSquared"></span>LengthSquared(Vector3&lt;T&gt; v) { return <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(v.x) + <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(v.y) + <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(v.z); }</div><p>


</p>
<p>Moving on to computing the length of a vector leads us to a quandary: what
type should the <tt>Length()</tt> function return?  For example, if the
<a href="#Vector3"><tt>Vector3</tt></a> stores an integer type, that type is probably not an
appropriate return type since the vector&rsquo;s length will not necessarily be
integer-valued.  In that case, <a href="../Introduction/pbrt_System_Overview.html#Float"><tt>Float</tt></a> would be a better choice, though
we should not standardize on <a href="../Introduction/pbrt_System_Overview.html#Float"><tt>Float</tt></a> for everything, because given a
<a href="#Vector3"><tt>Vector3</tt></a> of double-precision values, we should return the length as a
<tt>double</tt> as well.  Continuing our journey through advanced C++, we
turn to a technique known as <em>type traits</em> to solve this dilemma.

</p>
<p>First, we define a general <tt>TupleLength</tt> template class that holds a
type definition, <tt>type</tt>.  The default is set here to be <a href="../Introduction/pbrt_System_Overview.html#Float"><tt>Float</tt></a>.

</p>
<p></p>
<span class="anchor" id="fragment-TupleLengthDefinition-0"></span><div class="fragmentname">&lt;&lt;TupleLength Definition&gt;&gt;=&nbsp;<a href="#fragment-TupleLengthDefinition-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">template &lt;typename T&gt;
struct <span class="anchor" id="TupleLength"></span>TupleLength { using type = Float; };</div><p>


</p>
<p>For <tt>Vector3</tt>s of <tt>double</tt>s, we also provide a template
specialization that defines <tt>double</tt> as the type for length given
<tt>double</tt> for the element type.
 
</p>
<span class="anchor" id="fragment-TupleLengthDefinition-1"></span><div class="fragmentname">&lt;&lt;TupleLength Definition&gt;&gt;+=&nbsp;<a href="#fragment-TupleLengthDefinition-0"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">template &lt;&gt;
struct TupleLength&lt;double&gt; { using type = double; };</div><p>


</p>
<p>

</p>
<p>Now we can implement <tt>Length()</tt>, using <a href="#TupleLength"><tt>TupleLength</tt></a> to determine
which type to return.  Note that the return type cannot be specified before
the function declaration is complete since the type <tt>T</tt> is not known
until the function parameters have been parsed.  Therefore, the function is
declared as <tt>auto</tt> with the return type specified after its parameter
list.
 
</p>
<span class="anchor" id="fragment-Vector3InlineFunctions-1"></span><div class="fragmentname">&lt;&lt;Vector3 Inline Functions&gt;&gt;+=&nbsp;<a href="#fragment-Vector3InlineFunctions-0"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-Vector3InlineFunctions-2"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">template &lt;typename T&gt;
auto <span class="anchor" id="Length"></span>Length(Vector3&lt;T&gt; v) -&gt; typename <a href="#TupleLength" class="code">TupleLength</a>&lt;T&gt;::type {
    using std::sqrt;
    return sqrt(<a href="#LengthSquared" class="code">LengthSquared</a>(v));
}</div><p>


</p>
<p>There is one more C++ subtlety in these few lines of code: the reader may
wonder, why have a <tt>using std::sqrt</tt> declaration in the implementation
of <tt>Length()</tt> and then call <tt>sqrt()</tt>, rather than just calling
<tt>std::sqrt()</tt> directly?  That construction is used because
we would like to be able to use component
types <tt>T</tt> that do not have overloaded versions of <tt>std::sqrt()</tt>
available to them.  For example, we will later make use of <a href="#Vector3"><tt>Vector3</tt></a>s
that store intervals of values for each component using a forthcoming
<a href="../Utilities/Mathematical_Infrastructure.html#Interval"><tt>Interval</tt></a> class.  With the way the code is written here, if
<tt>std::sqrt()</tt> supports the type <tt>T</tt>, the <tt>std</tt> variant of
the function is called.  If not, then so long as we have defined a function
named <tt>sqrt()</tt> that takes our custom type, that version will be used.

</p>
<p>With all of this in hand, the implementation of <tt>Normalize()</tt> is
thankfully now trivial.  The use of <tt>auto</tt> for the return type ensures
that if for example <tt>Normalize()</tt> is called with a vector with integer
components, then the returned vector type has <a href="../Introduction/pbrt_System_Overview.html#Float"><tt>Float</tt></a> components
according to type conversion from the division operator. 

</p>
<p></p>
<span class="anchor" id="fragment-Vector3InlineFunctions-2"></span><div class="fragmentname">&lt;&lt;Vector3 Inline Functions&gt;&gt;+=&nbsp;<a href="#fragment-Vector3InlineFunctions-1"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-Vector3InlineFunctions-3"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">template &lt;typename T&gt;
auto <span class="anchor" id="Normalize"></span>Normalize(Vector3&lt;T&gt; v) { return v / <a href="#Length" class="code">Length</a>(v); }</div><p>


</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#DotandCrossProduct"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="sec:dot-cross-product"></span><span id="DotandCrossProduct"></span><h3>3.3.2  Dot and Cross Product</h3><p>
 


</p>
<p> Two useful operations on vectors are the dot product (also known as
the scalar or inner product) and the cross product.  For two 3D vectors <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
</g>
</svg>
and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.931ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 831.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold w</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D430" d="M805 397c-59 0 -63 -8 -68 -21l-144 -353c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-106 259l-106 -259c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-153 374h-59v47l109 -3l123 3v-47h-56l105 -258l79 192c1 3 4 9 4 13c0 0 0 3 -21 53h-59v47c16 -1 58 -3 100 -3l114 3v-47 h-56l114 -280l105 256c1 3 4 9 4 12c0 11 -49 12 -58 12v47l96 -3c24 0 54 1 77 3v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="0" y="0"></use>
</g>
</svg>, their <em>dot product</em>
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.831ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2940.9 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis bold v dot bold w right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-22C5" d="M192 250c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D430" d="M805 397c-59 0 -63 -8 -68 -21l-144 -353c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-106 259l-106 -259c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-153 374h-59v47l109 -3l123 3v-47h-56l105 -258l79 192c1 3 4 9 4 13c0 0 0 3 -21 53h-59v47c16 -1 58 -3 100 -3l114 3v-47 h-56l114 -280l105 256c1 3 4 9 4 12c0 11 -49 12 -58 12v47l96 -3c24 0 54 1 77 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-22C5" x="1219" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="1719" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2551" y="0"></use>
</g>
</svg> is defined as
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.775ex" height="2.676ex" style="vertical-align: -1.005ex;" viewBox="0 -719.6 9805.8 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v Subscript x Baseline bold w Subscript x Baseline plus bold v Subscript y Baseline bold w Subscript y Baseline plus bold v Subscript z Baseline bold w Subscript z Baseline comma</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D430" d="M805 397c-59 0 -63 -8 -68 -21l-144 -353c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-106 259l-106 -259c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-153 374h-59v47l109 -3l123 3v-47h-56l105 -258l79 192c1 3 4 9 4 13c0 0 0 3 -21 53h-59v47c16 -1 58 -3 100 -3l114 3v-47 h-56l114 -280l105 256c1 3 4 9 4 12c0 11 -49 12 -58 12v47l96 -3c24 0 54 1 77 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="859" y="-213"></use>
<g transform="translate(1112,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="1175" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="2670" y="0"></use>
<g transform="translate(3671,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="859" y="-213"></use>
</g>
<g transform="translate(4725,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="1175" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="6226" y="0"></use>
<g transform="translate(7227,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="859" y="-213"></use>
</g>
<g transform="translate(8265,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="1175" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="9527" y="0"></use>
</g>
</svg>
</div>
<p>

and the implementation follows directly.

</p>
<p></p>
<span class="anchor" id="fragment-Vector3InlineFunctions-3"></span><div class="fragmentname">&lt;&lt;Vector3 Inline Functions&gt;&gt;+=&nbsp;<a href="#fragment-Vector3InlineFunctions-2"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-Vector3InlineFunctions-4"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">template &lt;typename T&gt;
T <span class="anchor" id="Dot"></span><a href="#Dot" class="code">Dot</a>(Vector3&lt;T&gt; v, Vector3&lt;T&gt; w) {
    return v.x * w.x + v.y * w.y + v.z * w.z;
}</div><p>


</p>
<p>A few basic properties directly follow from the definition of the dot
product.  For example, if <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.485ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 639.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold u</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42E" d="M615 0l-177 -6v78c-46 -78 -118 -78 -144 -78c-99 0 -180 22 -180 129v233c0 39 -7 39 -69 39v47l183 8v-341c0 -54 3 -79 80 -79c73 0 124 53 124 135v191c0 39 -7 39 -69 39v47l183 8v-364c0 -39 7 -39 69 -39v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42E" x="0" y="0"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
</g>
</svg>, and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.931ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 831.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold w</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D430" d="M805 397c-59 0 -63 -8 -68 -21l-144 -353c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-106 259l-106 -259c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-153 374h-59v47l109 -3l123 3v-47h-56l105 -258l79 192c1 3 4 9 4 13c0 0 0 3 -21 53h-59v47c16 -1 58 -3 100 -3l114 3v-47 h-56l114 -280l105 256c1 3 4 9 4 12c0 11 -49 12 -58 12v47l96 -3c24 0 54 1 77 3v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="0" y="0"></use>
</g>
</svg> are vectors
and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 469.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">s</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D460" d="M420 356c0 -39 -24 -56 -46 -56s-31 15 -31 29c0 22 20 44 48 45c-15 39 -65 46 -90 46c-88 0 -112 -61 -112 -90c0 -45 40 -52 76 -60c44 -9 73 -14 100 -42c12 -12 31 -37 31 -73c0 -45 -39 -166 -201 -166c-86 0 -143 40 -143 97c0 45 30 66 56 66c21 0 37 -12 37 -35 c0 -28 -25 -58 -63 -53c23 -53 100 -53 114 -53c120 0 143 84 143 110c0 55 -52 66 -104 76c-29 6 -103 21 -103 99c0 44 37 146 169 146c76 0 119 -41 119 -86Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D460" x="0" y="0"></use>
</g>
</svg> is a scalar value, then:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="33.592ex" height="10.176ex" style="vertical-align: -4.505ex;" viewBox="0 -2441.8 14463.3 4381.3" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">StartLayout 1st Row 1st Column left-parenthesis bold u dot bold v right-parenthesis 2nd Column equals left-parenthesis bold v dot bold u right-parenthesis 2nd Row 1st Column left-parenthesis s bold u dot bold v right-parenthesis 2nd Column equals s left-parenthesis bold u dot bold v right-parenthesis 3rd Row 1st Column left-parenthesis bold u dot left-parenthesis bold v plus bold w right-parenthesis right-parenthesis 2nd Column equals left-parenthesis bold u dot bold v right-parenthesis plus left-parenthesis bold u dot bold w right-parenthesis period EndLayout</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42E" d="M615 0l-177 -6v78c-46 -78 -118 -78 -144 -78c-99 0 -180 22 -180 129v233c0 39 -7 39 -69 39v47l183 8v-341c0 -54 3 -79 80 -79c73 0 124 53 124 135v191c0 39 -7 39 -69 39v47l183 8v-364c0 -39 7 -39 69 -39v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-22C5" d="M192 250c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D460" d="M420 356c0 -39 -24 -56 -46 -56s-31 15 -31 29c0 22 20 44 48 45c-15 39 -65 46 -90 46c-88 0 -112 -61 -112 -90c0 -45 40 -52 76 -60c44 -9 73 -14 100 -42c12 -12 31 -37 31 -73c0 -45 -39 -166 -201 -166c-86 0 -143 40 -143 97c0 45 30 66 56 66c21 0 37 -12 37 -35 c0 -28 -25 -58 -63 -53c23 -53 100 -53 114 -53c120 0 143 84 143 110c0 55 -52 66 -104 76c-29 6 -103 21 -103 99c0 44 37 146 169 146c76 0 119 -41 119 -86Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D430" d="M805 397c-59 0 -63 -8 -68 -21l-144 -353c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-106 259l-106 -259c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-153 374h-59v47l109 -3l123 3v-47h-56l105 -258l79 192c1 3 4 9 4 13c0 0 0 3 -21 53h-59v47c16 -1 58 -3 100 -3l114 3v-47 h-56l114 -280l105 256c1 3 4 9 4 12c0 11 -49 12 -58 12v47l96 -3c24 0 54 1 77 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(2833,1523)">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42E" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-22C5" x="1251" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="1751" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2359" y="0"></use>
</g>
<g transform="translate(2363,-26)">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D460" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42E" x="859" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-22C5" x="1720" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="2221" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2828" y="0"></use>
</g>
<g transform="translate(0,-1575)">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42E" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-22C5" x="1251" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1751" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="2141" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="2971" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="3971" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4803" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="5192" y="0"></use>
</g>
</g>
<g transform="translate(5849,0)">
<g transform="translate(0,1523)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1056" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="1445" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-22C5" x="2275" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42E" x="2776" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3415" y="0"></use>
</g>
<g transform="translate(0,-26)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D460" x="1056" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1525" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42E" x="1915" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-22C5" x="2777" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="3277" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3885" y="0"></use>
</g>
<g transform="translate(0,-1575)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1056" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42E" x="1445" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-22C5" x="2307" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="2808" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3415" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="4027" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="5028" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42E" x="5417" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-22C5" x="6279" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="6780" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="7611" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="8001" y="0"></use>
</g>
</g>
</g>
</g>
</svg>
</div>
<p>


</p>
<p>The dot product has a simple relationship to the angle between the two
vectors:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="eq:dot-cos"></span><div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.983ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 9895.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis bold v dot bold w right-parenthesis equals double-vertical-bar bold v double-vertical-bar double-vertical-bar bold w double-vertical-bar cosine theta comma</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E2-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-22C5" d="M192 250c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D430" d="M805 397c-59 0 -63 -8 -68 -21l-144 -353c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-106 259l-106 -259c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-153 374h-59v47l109 -3l123 3v-47h-56l105 -258l79 192c1 3 4 9 4 13c0 0 0 3 -21 53h-59v47c16 -1 58 -3 100 -3l114 3v-47 h-56l114 -280l105 256c1 3 4 9 4 12c0 11 -49 12 -58 12v47l96 -3c24 0 54 1 77 3v-47Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-2016" d="M151 -230c0 -11 -9 -20 -20 -20s-20 9 -20 20v960c0 11 9 20 20 20s20 -9 20 -20v-960zM287 -230c0 -11 -9 -20 -20 -20s-20 9 -20 20v960c0 11 9 20 20 20s20 -9 20 -20v-960Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E2-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E2-LATINMODERNNORMAL-1D42F" x="389" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-22C5" x="1219" y="0"></use>
 <use xlink:href="#E2-LATINMODERNNORMAL-1D430" x="1719" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-29" x="2551" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-3D" x="3218" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2016" x="4275" y="0"></use>
 <use xlink:href="#E2-LATINMODERNNORMAL-1D42F" x="4673" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2016" x="5281" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2016" x="5846" y="0"></use>
 <use xlink:href="#E2-LATINMODERNNORMAL-1D430" x="6244" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2016" x="7076" y="0"></use>
<g transform="translate(7641,0)">
 <use xlink:href="#E2-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
 <use xlink:href="#E2-LATINMODERNNORMAL-1D703" x="9147" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2C" x="9617" y="0"></use>
</g>
</svg>
</div>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">
<div class="eqno">(<a href="#eq:dot-cos">3.1</a>)</div>
</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<p>

where <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">theta</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="0" y="0"></use>
</g>
</svg> is the angle between <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.931ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 831.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold w</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D430" d="M805 397c-59 0 -63 -8 -68 -21l-144 -353c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-106 259l-106 -259c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-153 374h-59v47l109 -3l123 3v-47h-56l105 -258l79 192c1 3 4 9 4 13c0 0 0 3 -21 53h-59v47c16 -1 58 -3 100 -3l114 3v-47 h-56l114 -280l105 256c1 3 4 9 4 12c0 11 -49 12 -58 12v47l96 -3c24 0 54 1 77 3v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="0" y="0"></use>
</g>
</svg>, and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.262ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 1404.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">double-vertical-bar bold v double-vertical-bar</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E2-LATINMODERNMAIN-2016" d="M151 -230c0 -11 -9 -20 -20 -20s-20 9 -20 20v960c0 11 9 20 20 20s20 -9 20 -20v-960zM287 -230c0 -11 -9 -20 -20 -20s-20 9 -20 20v960c0 11 9 20 20 20s20 -9 20 -20v-960Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E2-LATINMODERNMAIN-2016" x="0" y="0"></use>
 <use xlink:href="#E2-LATINMODERNNORMAL-1D42F" x="398" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2016" x="1006" y="0"></use>
</g>
</svg>
denotes the length of the vector <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
</g>
</svg>.  It follows from
this that <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.831ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2940.9 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis bold v dot bold w right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-22C5" d="M192 250c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D430" d="M805 397c-59 0 -63 -8 -68 -21l-144 -353c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-106 259l-106 -259c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-153 374h-59v47l109 -3l123 3v-47h-56l105 -258l79 192c1 3 4 9 4 13c0 0 0 3 -21 53h-59v47c16 -1 58 -3 100 -3l114 3v-47 h-56l114 -280l105 256c1 3 4 9 4 12c0 11 -49 12 -58 12v47l96 -3c24 0 54 1 77 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-22C5" x="1219" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="1719" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2551" y="0"></use>
</g>
</svg> is zero if and only if <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
</g>
</svg> and
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.931ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 831.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold w</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D430" d="M805 397c-59 0 -63 -8 -68 -21l-144 -353c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-106 259l-106 -259c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-153 374h-59v47l109 -3l123 3v-47h-56l105 -258l79 192c1 3 4 9 4 13c0 0 0 3 -21 53h-59v47c16 -1 58 -3 100 -3l114 3v-47 h-56l114 -280l105 256c1 3 4 9 4 12c0 11 -49 12 -58 12v47l96 -3c24 0 54 1 77 3v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="0" y="0"></use>
</g>
</svg> are perpendicular, provided that neither <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
</g>
</svg> nor <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.931ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 831.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold w</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D430" d="M805 397c-59 0 -63 -8 -68 -21l-144 -353c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-106 259l-106 -259c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-153 374h-59v47l109 -3l123 3v-47h-56l105 -258l79 192c1 3 4 9 4 13c0 0 0 3 -21 53h-59v47c16 -1 58 -3 100 -3l114 3v-47 h-56l114 -280l105 256c1 3 4 9 4 12c0 11 -49 12 -58 12v47l96 -3c24 0 54 1 77 3v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="0" y="0"></use>
</g>
</svg> is
<em>degenerate</em>&mdash;equal to <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.365ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3170.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 0 comma 0 comma 0 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="890" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="1335" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1835" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="2280" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2781" y="0"></use>
</g>
</svg>.  A&nbsp;set of two or more
mutually perpendicular vectors is said to be <em>orthogonal</em>.  An orthogonal
set of unit vectors is called <em>orthonormal</em>.

</p>
<p>It follows from Equation&nbsp;(<a href="#eq:dot-cos">3.1</a>) that if <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
</g>
</svg>
and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.931ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 831.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold w</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D430" d="M805 397c-59 0 -63 -8 -68 -21l-144 -353c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-106 259l-106 -259c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-153 374h-59v47l109 -3l123 3v-47h-56l105 -258l79 192c1 3 4 9 4 13c0 0 0 3 -21 53h-59v47c16 -1 58 -3 100 -3l114 3v-47 h-56l114 -280l105 256c1 3 4 9 4 12c0 11 -49 12 -58 12v47l96 -3c24 0 54 1 77 3v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="0" y="0"></use>
</g>
</svg> are unit vectors, their dot product is the cosine of the
angle between them.  As the cosine of the angle between two vectors often
needs to be computed for rendering, we will frequently make use of this
property.

</p>
<p>If we would like to find the angle between two normalized vectors, we could
use the standard library&rsquo;s inverse cosine function, passing it the value of the
dot product between the two vectors.  However, that approach can suffer
from a loss of accuracy when the two vectors are nearly parallel or facing
in nearly opposite directions.  The following reformulation does more of
its computation with values close to the origin where there is more
floating-point precision, giving a more accurate result.

</p>
<p></p>
<span class="anchor" id="fragment-Vector3InlineFunctions-4"></span><div class="fragmentname">&lt;&lt;Vector3 Inline Functions&gt;&gt;+=&nbsp;<a href="#fragment-Vector3InlineFunctions-3"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-Vector3InlineFunctions-5"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">template &lt;typename T&gt;
Float <span class="anchor" id="AngleBetween"></span>AngleBetween(Vector3&lt;T&gt; v1, Vector3&lt;T&gt; v2) {
    if (<a href="#Dot" class="code">Dot</a>(v1, v2) &lt; 0)
        return Pi - 2 * <a href="../Utilities/Mathematical_Infrastructure.html#SafeASin" class="code">SafeASin</a>(<a href="#Length" class="code">Length</a>(v1 + v2) / 2);
    else
        return 2 * <a href="../Utilities/Mathematical_Infrastructure.html#SafeASin" class="code">SafeASin</a>(<a href="#Length" class="code">Length</a>(v2 - v1) / 2);
}</div><p>


</p>
<p>We will frequently need to compute the absolute value of the dot product
as well. The <a href="#AbsDot"><tt>AbsDot()</tt></a> function does this for us so that 
a separate call to <tt>std::abs()</tt> is not necessary in that case.

</p>
<p></p>
<span class="anchor" id="fragment-Vector3InlineFunctions-5"></span><div class="fragmentname">&lt;&lt;Vector3 Inline Functions&gt;&gt;+=&nbsp;<a href="#fragment-Vector3InlineFunctions-4"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-Vector3InlineFunctions-6"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">template &lt;typename T&gt;
T <span class="anchor" id="AbsDot"></span><a href="#AbsDot" class="code">AbsDot</a>(Vector3&lt;T&gt; v1, Vector3&lt;T&gt; v2) { return std::abs(<a href="#Dot" class="code">Dot</a>(v1, v2)); }</div><p>


</p>
<p>

</p>
<p></p>
<span class="anchor" id="fig:gs-orthogonal-projection"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha03f05.svg" title=""><img src="pha03f05.svg" width=323 height=157 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 3.5: <span class="legend"> The orthogonal projection of a vector <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
</g>
</svg> onto a
normalized vector <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.931ex" height="2.176ex" style="vertical-align: -0.012ex; margin-bottom: -0.326ex;" viewBox="0 -791.3 831.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">ModifyingAbove bold w With bold caret</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D430" d="M805 397c-59 0 -63 -8 -68 -21l-144 -353c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-106 259l-106 -259c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-153 374h-59v47l109 -3l123 3v-47h-56l105 -258l79 192c1 3 4 9 4 13c0 0 0 3 -21 53h-59v47c16 -1 58 -3 100 -3l114 3v-47 h-56l114 -280l105 256c1 3 4 9 4 12c0 11 -49 12 -58 12v47l96 -3c24 0 54 1 77 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-302" d="M-82 607l-12 -20c-58 25 -115 54 -170 85c-55 -31 -112 -60 -170 -85l-12 20c56 49 117 91 182 127c65 -36 126 -78 182 -127Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-302" x="638" y="-34"></use>
</g>
</svg> gives a vector <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.465ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1061.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v Subscript normal o</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-6F" x="859" y="-213"></use>
</g>
</svg> that is
parallel to <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.931ex" height="2.176ex" style="vertical-align: -0.012ex; margin-bottom: -0.326ex;" viewBox="0 -791.3 831.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">ModifyingAbove bold w With bold caret</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D430" d="M805 397c-59 0 -63 -8 -68 -21l-144 -353c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-106 259l-106 -259c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-153 374h-59v47l109 -3l123 3v-47h-56l105 -258l79 192c1 3 4 9 4 13c0 0 0 3 -21 53h-59v47c16 -1 58 -3 100 -3l114 3v-47 h-56l114 -280l105 256c1 3 4 9 4 12c0 11 -49 12 -58 12v47l96 -3c24 0 54 1 77 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-302" d="M-82 607l-12 -20c-58 25 -115 54 -170 85c-55 -31 -112 -60 -170 -85l-12 20c56 49 117 91 182 127c65 -36 126 -78 182 -127Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-302" x="638" y="-34"></use>
</g>
</svg>.  The difference vector, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.717ex" height="2.343ex" style="vertical-align: -0.671ex;" viewBox="0 -719.6 2891.9 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v minus bold v Subscript normal o</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="829" y="0"></use>
<g transform="translate(1830,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-6F" x="859" y="-213"></use>
</g>
</g>
</svg>, shown here as a dashed line, is perpendicular to
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.931ex" height="2.176ex" style="vertical-align: -0.012ex; margin-bottom: -0.326ex;" viewBox="0 -791.3 831.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">ModifyingAbove bold w With bold caret</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D430" d="M805 397c-59 0 -63 -8 -68 -21l-144 -353c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-106 259l-106 -259c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-153 374h-59v47l109 -3l123 3v-47h-56l105 -258l79 192c1 3 4 9 4 13c0 0 0 3 -21 53h-59v47c16 -1 58 -3 100 -3l114 3v-47 h-56l114 -280l105 256c1 3 4 9 4 12c0 11 -49 12 -58 12v47l96 -3c24 0 54 1 77 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-302" d="M-82 607l-12 -20c-58 25 -115 54 -170 85c-55 -31 -112 -60 -170 -85l-12 20c56 49 117 91 182 127c65 -36 126 -78 182 -127Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-302" x="638" y="-34"></use>
</g>
</svg>.</span>
</figcaption>
</div></div><p>


</p>
<p>A useful operation on vectors that is based on the dot product is the
<em>Gram&ndash;Schmidt</em> process, which transforms a set of non-orthogonal
vectors that form a basis into orthogonal vectors that span the same basis.
It is based on successive application of the <em>orthogonal
projection</em> of a vector <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
</g>
</svg> onto a normalized vector <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.931ex" height="2.176ex" style="vertical-align: -0.012ex; margin-bottom: -0.326ex;" viewBox="0 -791.3 831.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">ModifyingAbove bold w With bold caret</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D430" d="M805 397c-59 0 -63 -8 -68 -21l-144 -353c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-106 259l-106 -259c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-153 374h-59v47l109 -3l123 3v-47h-56l105 -258l79 192c1 3 4 9 4 13c0 0 0 3 -21 53h-59v47c16 -1 58 -3 100 -3l114 3v-47 h-56l114 -280l105 256c1 3 4 9 4 12c0 11 -49 12 -58 12v47l96 -3c24 0 54 1 77 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-302" d="M-82 607l-12 -20c-58 25 -115 54 -170 85c-55 -31 -112 -60 -170 -85l-12 20c56 49 117 91 182 127c65 -36 126 -78 182 -127Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-302" x="638" y="-34"></use>
</g>
</svg>,
which is given by <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.762ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3772.4 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis bold v dot ModifyingAbove bold w With bold caret right-parenthesis ModifyingAbove bold w With bold caret</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-22C5" d="M192 250c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D430" d="M805 397c-59 0 -63 -8 -68 -21l-144 -353c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-106 259l-106 -259c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-153 374h-59v47l109 -3l123 3v-47h-56l105 -258l79 192c1 3 4 9 4 13c0 0 0 3 -21 53h-59v47c16 -1 58 -3 100 -3l114 3v-47 h-56l114 -280l105 256c1 3 4 9 4 12c0 11 -49 12 -58 12v47l96 -3c24 0 54 1 77 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-302" d="M-82 607l-12 -20c-58 25 -115 54 -170 85c-55 -31 -112 -60 -170 -85l-12 20c56 49 117 91 182 127c65 -36 126 -78 182 -127Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-22C5" x="1219" y="0"></use>
<g transform="translate(1719,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-302" x="638" y="-34"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2551" y="0"></use>
<g transform="translate(2940,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-302" x="638" y="-34"></use>
</g>
</g>
</svg> (see
Figure&nbsp;<a href="#fig:gs-orthogonal-projection">3.5</a>).
The orthogonal projection can be used to compute a new vector
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="eq:gs-orthogonal-projection"></span><div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="19.033ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 8194.9 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v Subscript up-tack Baseline equals bold v minus left-parenthesis bold v dot ModifyingAbove bold w With bold caret right-parenthesis ModifyingAbove bold w With bold caret</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-22A5" d="M722 20c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h293v624c0 11 9 20 20 20s20 -9 20 -20v-624h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-22C5" d="M192 250c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D430" d="M805 397c-59 0 -63 -8 -68 -21l-144 -353c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-106 259l-106 -259c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-153 374h-59v47l109 -3l123 3v-47h-56l105 -258l79 192c1 3 4 9 4 13c0 0 0 3 -21 53h-59v47c16 -1 58 -3 100 -3l114 3v-47 h-56l114 -280l105 256c1 3 4 9 4 12c0 11 -49 12 -58 12v47l96 -3c24 0 54 1 77 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-302" d="M-82 607l-12 -20c-58 25 -115 54 -170 85c-55 -31 -112 -60 -170 -85l-12 20c56 49 117 91 182 127c65 -36 126 -78 182 -127Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-22A5" x="859" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1535" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="2592" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="3421" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="4422" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="4811" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-22C5" x="5641" y="0"></use>
<g transform="translate(6142,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-302" x="638" y="-34"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="6973" y="0"></use>
<g transform="translate(7363,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-302" x="638" y="-34"></use>
</g>
</g>
</svg>
</div>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">
<div class="eqno">(<a href="#eq:gs-orthogonal-projection">3.2</a>)</div>
</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<p>

that is orthogonal to <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.931ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 831.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold w</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D430" d="M805 397c-59 0 -63 -8 -68 -21l-144 -353c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-106 259l-106 -259c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-153 374h-59v47l109 -3l123 3v-47h-56l105 -258l79 192c1 3 4 9 4 13c0 0 0 3 -21 53h-59v47c16 -1 58 -3 100 -3l114 3v-47 h-56l114 -280l105 256c1 3 4 9 4 12c0 11 -49 12 -58 12v47l96 -3c24 0 54 1 77 3v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="0" y="0"></use>
</g>
</svg>.  An advantage of computing <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.922ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1258 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v Subscript up-tack</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-22A5" d="M722 20c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h293v624c0 11 9 20 20 20s20 -9 20 -20v-624h293c11 0 20 -9 20 -20Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-22A5" x="859" y="-213"></use>
</g>
</svg>
in this way is that <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.922ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1258 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v Subscript up-tack</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-22A5" d="M722 20c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h293v624c0 11 9 20 20 20s20 -9 20 -20v-624h293c11 0 20 -9 20 -20Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-22A5" x="859" y="-213"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.931ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 831.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold w</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D430" d="M805 397c-59 0 -63 -8 -68 -21l-144 -353c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-106 259l-106 -259c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-153 374h-59v47l109 -3l123 3v-47h-56l105 -258l79 192c1 3 4 9 4 13c0 0 0 3 -21 53h-59v47c16 -1 58 -3 100 -3l114 3v-47 h-56l114 -280l105 256c1 3 4 9 4 12c0 11 -49 12 -58 12v47l96 -3c24 0 54 1 77 3v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="0" y="0"></use>
</g>
</svg> span the same subspace as
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.931ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 831.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold w</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D430" d="M805 397c-59 0 -63 -8 -68 -21l-144 -353c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-106 259l-106 -259c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-153 374h-59v47l109 -3l123 3v-47h-56l105 -258l79 192c1 3 4 9 4 13c0 0 0 3 -21 53h-59v47c16 -1 58 -3 100 -3l114 3v-47 h-56l114 -280l105 256c1 3 4 9 4 12c0 11 -49 12 -58 12v47l96 -3c24 0 54 1 77 3v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="0" y="0"></use>
</g>
</svg> did.

</p>
<p>The <tt>GramSchmidt()</tt> function implements Equation&nbsp;(<a href="#eq:gs-orthogonal-projection">3.2</a>); it expects
the vector <tt>w</tt> to already be normalized.

</p>
<p></p>
<span class="anchor" id="fragment-Vector3InlineFunctions-6"></span><div class="fragmentname">&lt;&lt;Vector3 Inline Functions&gt;&gt;+=&nbsp;<a href="#fragment-Vector3InlineFunctions-5"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-Vector3InlineFunctions-7"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">template &lt;typename T&gt;
Vector3&lt;T&gt; <span class="anchor" id="GramSchmidt"></span>GramSchmidt(Vector3&lt;T&gt; v, Vector3&lt;T&gt; w) {
    return v - <a href="#Dot" class="code">Dot</a>(v, w) * w;
}</div><p>


</p>
<p>The <em>cross product</em> is another useful operation for 3D vectors.  Given
two vectors in 3D, the cross product <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.15ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 2217.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v times bold w</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-D7" d="M624 15c-7 -8 -20 -8 -28 0l-207 207l-207 -207c-8 -8 -21 -8 -28 0c-8 7 -8 20 0 28l207 207l-207 207c-8 8 -8 21 0 28c7 8 20 8 28 0l207 -207l207 207c8 8 21 8 28 0c8 -7 8 -20 0 -28l-207 -207l207 -207c8 -8 8 -21 0 -28Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D430" d="M805 397c-59 0 -63 -8 -68 -21l-144 -353c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-106 259l-106 -259c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-153 374h-59v47l109 -3l123 3v-47h-56l105 -258l79 192c1 3 4 9 4 13c0 0 0 3 -21 53h-59v47c16 -1 58 -3 100 -3l114 3v-47 h-56l114 -280l105 256c1 3 4 9 4 12c0 11 -49 12 -58 12v47l96 -3c24 0 54 1 77 3v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-D7" x="607" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="1386" y="0"></use>
</g>
</svg> is a vector
that is perpendicular to both of them. 
Given orthogonal vectors <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.931ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 831.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold w</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D430" d="M805 397c-59 0 -63 -8 -68 -21l-144 -353c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-106 259l-106 -259c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-153 374h-59v47l109 -3l123 3v-47h-56l105 -258l79 192c1 3 4 9 4 13c0 0 0 3 -21 53h-59v47c16 -1 58 -3 100 -3l114 3v-47 h-56l114 -280l105 256c1 3 4 9 4 12c0 11 -49 12 -58 12v47l96 -3c24 0 54 1 77 3v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="0" y="0"></use>
</g>
</svg>,
then <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.15ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 2217.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v times bold w</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-D7" d="M624 15c-7 -8 -20 -8 -28 0l-207 207l-207 -207c-8 -8 -21 -8 -28 0c-8 7 -8 20 0 28l207 207l-207 207c-8 8 -8 21 0 28c7 8 20 8 28 0l207 -207l207 207c8 8 21 8 28 0c8 -7 8 -20 0 -28l-207 -207l207 -207c8 -8 8 -21 0 -28Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D430" d="M805 397c-59 0 -63 -8 -68 -21l-144 -353c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-106 259l-106 -259c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-153 374h-59v47l109 -3l123 3v-47h-56l105 -258l79 192c1 3 4 9 4 13c0 0 0 3 -21 53h-59v47c16 -1 58 -3 100 -3l114 3v-47 h-56l114 -280l105 256c1 3 4 9 4 12c0 11 -49 12 -58 12v47l96 -3c24 0 54 1 77 3v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-D7" x="607" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="1386" y="0"></use>
</g>
</svg> is defined to be a vector such that
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.37ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 5325.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis bold v comma bold w comma bold v times bold w right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D430" d="M805 397c-59 0 -63 -8 -68 -21l-144 -353c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-106 259l-106 -259c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-153 374h-59v47l109 -3l123 3v-47h-56l105 -258l79 192c1 3 4 9 4 13c0 0 0 3 -21 53h-59v47c16 -1 58 -3 100 -3l114 3v-47 h-56l114 -280l105 256c1 3 4 9 4 12c0 11 -49 12 -58 12v47l96 -3c24 0 54 1 77 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-D7" d="M624 15c-7 -8 -20 -8 -28 0l-207 207l-207 -207c-8 -8 -21 -8 -28 0c-8 7 -8 20 0 28l207 207l-207 207c-8 8 -8 21 0 28c7 8 20 8 28 0l207 -207l207 207c8 8 21 8 28 0c8 -7 8 -20 0 -28l-207 -207l207 -207c8 -8 8 -21 0 -28Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="997" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="1442" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="2273" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="2718" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-D7" x="3326" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="4104" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4936" y="0"></use>
</g>
</svg> form an orthogonal coordinate system.

</p>
<p>The cross product is defined as:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="26.574ex" height="10.843ex" style="vertical-align: -4.554ex; margin-bottom: -0.284ex;" viewBox="0 -2585.3 11441.7 4668.3" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">StartLayout 1st Row 1st Column left-parenthesis bold v times bold w right-parenthesis Subscript x 2nd Column equals bold v Subscript y Baseline bold w Subscript z Baseline minus bold v Subscript z Baseline bold w Subscript y Baseline 2nd Row 1st Column left-parenthesis bold v times bold w right-parenthesis Subscript y 2nd Column equals bold v Subscript z Baseline bold w Subscript x Baseline minus bold v Subscript x Baseline bold w Subscript z Baseline 3rd Row 1st Column left-parenthesis bold v times bold w right-parenthesis Subscript z 2nd Column equals bold v Subscript x Baseline bold w Subscript y Baseline minus bold v Subscript y Baseline bold w Subscript x Baseline period EndLayout</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-D7" d="M624 15c-7 -8 -20 -8 -28 0l-207 207l-207 -207c-8 -8 -21 -8 -28 0c-8 7 -8 20 0 28l207 207l-207 207c-8 8 -8 21 0 28c7 8 20 8 28 0l207 -207l207 207c8 8 21 8 28 0c8 -7 8 -20 0 -28l-207 -207l207 -207c8 -8 8 -21 0 -28Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D430" d="M805 397c-59 0 -63 -8 -68 -21l-144 -353c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-106 259l-106 -259c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-153 374h-59v47l109 -3l123 3v-47h-56l105 -258l79 192c1 3 4 9 4 13c0 0 0 3 -21 53h-59v47c16 -1 58 -3 100 -3l114 3v-47 h-56l114 -280l105 256c1 3 4 9 4 12c0 11 -49 12 -58 12v47l96 -3c24 0 54 1 77 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,1660)">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-D7" x="997" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="1775" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2607" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="4237" y="-403"></use>
</g>
<g transform="translate(57,65)">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-D7" x="997" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="1775" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2607" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="4237" y="-403"></use>
</g>
<g transform="translate(74,-1666)">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-D7" x="997" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="1775" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2607" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="4237" y="-403"></use>
</g>
</g>
<g transform="translate(3768,0)">
<g transform="translate(0,1660)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
<g transform="translate(1056,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="859" y="-213"></use>
</g>
<g transform="translate(2110,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="1175" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="3594" y="0"></use>
<g transform="translate(4595,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="859" y="-213"></use>
</g>
<g transform="translate(5633,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="1175" y="-213"></use>
</g>
</g>
<g transform="translate(0,65)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
<g transform="translate(1056,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="859" y="-213"></use>
</g>
<g transform="translate(2094,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="1175" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="3652" y="0"></use>
<g transform="translate(4653,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="859" y="-213"></use>
</g>
<g transform="translate(5765,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="1175" y="-213"></use>
</g>
</g>
<g transform="translate(0,-1666)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
<g transform="translate(1056,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="859" y="-213"></use>
</g>
<g transform="translate(2168,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="1175" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="3669" y="0"></use>
<g transform="translate(4669,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="859" y="-213"></use>
</g>
<g transform="translate(5724,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="1175" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="7060" y="0"></use>
</g>
</g>
</g>
</g>
</svg>
</div>
<p>

A way to remember this is to compute the determinant of the matrix:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="24.59ex" height="9.843ex" style="vertical-align: -4.338ex;" viewBox="0 -2370 10587.3 4237.8" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v times bold w equals Start 3 By 3 Determinant 1st Row 1st Column i 2nd Column j 3rd Column k 2nd Row 1st Column bold v Subscript x Baseline 2nd Column bold v Subscript y Baseline 3rd Column bold v Subscript z Baseline 3rd Row 1st Column bold w Subscript x Baseline 2nd Column bold w Subscript y Baseline 3rd Column bold w Subscript z Baseline EndDeterminant comma</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-D7" d="M624 15c-7 -8 -20 -8 -28 0l-207 207l-207 -207c-8 -8 -21 -8 -28 0c-8 7 -8 20 0 28l207 207l-207 207c-8 8 -8 21 0 28c7 8 20 8 28 0l207 -207l207 207c8 8 21 8 28 0c8 -7 8 -20 0 -28l-207 -207l207 -207c8 -8 8 -21 0 -28Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D430" d="M805 397c-59 0 -63 -8 -68 -21l-144 -353c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-106 259l-106 -259c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-153 374h-59v47l109 -3l123 3v-47h-56l105 -258l79 192c1 3 4 9 4 13c0 0 0 3 -21 53h-59v47c16 -1 58 -3 100 -3l114 3v-47 h-56l114 -280l105 256c1 3 4 9 4 12c0 11 -49 12 -58 12v47l96 -3c24 0 54 1 77 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-7C" d="M159 -230c0 -11 -9 -20 -20 -20s-20 9 -20 20v960c0 11 9 20 20 20s20 -9 20 -20v-960Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D457" d="M397 625c0 -27 -27 -53 -54 -53c-23 0 -37 16 -37 36c0 30 30 53 53 53c24 0 38 -17 38 -36zM360 350c0 -3 0 -17 -5 -37l-92 -366c-25 -99 -118 -152 -188 -152c-48 0 -88 22 -88 62c0 36 29 57 54 57c27 0 38 -19 38 -35c0 -20 -15 -46 -45 -53c18 -9 33 -9 39 -9 c56 0 104 57 123 133l94 373c4 17 7 28 7 51c0 42 -18 46 -32 46c-55 0 -101 -61 -126 -122c-8 -19 -9 -20 -18 -20c0 0 -12 0 -12 10c0 9 57 154 159 154c50 0 92 -35 92 -92Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D458" d="M508 379c0 -39 -29 -61 -55 -61c-27 0 -38 19 -38 35c0 12 9 51 57 54c-2 2 -2 3 -4 4c-8 6 -9 6 -21 8c-2 1 -3 1 -9 1c-49 0 -95 -43 -143 -96c-23 -24 -55 -56 -86 -74c85 -11 148 -40 148 -105c0 -10 0 -14 -4 -31c-4 -16 -8 -39 -8 -56c0 -36 13 -47 32 -47 c44 0 67 51 87 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -11 -57 -36 -101c-22 -37 -49 -53 -79 -53c-52 0 -92 40 -92 99c0 11 2 23 4 35c3 10 3 14 3 21c0 66 -82 82 -116 85c-6 -25 -51 -210 -56 -219c-6 -12 -21 -21 -34 -21c-9 0 -29 5 -29 28c0 6 0 8 4 22l145 576 l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-104 -422c38 15 77 55 111 93c72 80 118 88 146 88c45 0 68 -33 68 -63Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE7-E006" d="M179 0h-79v1163c0 21 17 39 39 39s40 -18 40 -39v-1163Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE7-E004" d="M179 39c0 -21 -18 -39 -40 -39s-39 18 -39 39v1163h78Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE7-E005" d="M179 0h-79v1202h78Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-D7" x="607" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="1386" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="2495" y="0"></use>
<g transform="translate(3551,0)">
<g transform="translate(0,2248)">
 <use xlink:href="#E1-LATINMODERNSIZE7-E006" x="0" y="-1203"></use>
<g transform="translate(0,-2841.9248975084515) scale(1,1.403096340406028)">
 <use xlink:href="#E1-LATINMODERNSIZE7-E005"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSIZE7-E004" x="0" y="-3997"></use>
</g>
<g transform="translate(445,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D456" x="495" y="1448"></use>
<g transform="translate(112,42)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="859" y="-213"></use>
</g>
<g transform="translate(0,-1453)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="1175" y="-213"></use>
</g>
</g>
<g transform="translate(2325,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D457" x="432" y="1448"></use>
<g transform="translate(112,42)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="859" y="-213"></use>
</g>
<g transform="translate(0,-1453)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="1175" y="-213"></use>
</g>
</g>
<g transform="translate(4604,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D458" x="370" y="1448"></use>
<g transform="translate(112,42)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="859" y="-213"></use>
</g>
<g transform="translate(0,-1453)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="1175" y="-213"></use>
</g>
</g>
</g>
<g transform="translate(6478,2248)">
 <use xlink:href="#E1-LATINMODERNSIZE7-E006" x="0" y="-1203"></use>
<g transform="translate(0,-2841.9248975084515) scale(1,1.403096340406028)">
 <use xlink:href="#E1-LATINMODERNSIZE7-E005"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSIZE7-E004" x="0" y="-3997"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="10308" y="0"></use>
</g>
</svg>
</div>
<p>

where <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 345.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D456" x="0" y="0"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.987ex" height="2.509ex" style="vertical-align: -0.671ex; margin-left: -0.029ex;" viewBox="-12.5 -791.3 425 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">j</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D457" d="M397 625c0 -27 -27 -53 -54 -53c-23 0 -37 16 -37 36c0 30 30 53 53 53c24 0 38 -17 38 -36zM360 350c0 -3 0 -17 -5 -37l-92 -366c-25 -99 -118 -152 -188 -152c-48 0 -88 22 -88 62c0 36 29 57 54 57c27 0 38 -19 38 -35c0 -20 -15 -46 -45 -53c18 -9 33 -9 39 -9 c56 0 104 57 123 133l94 373c4 17 7 28 7 51c0 42 -18 46 -32 46c-55 0 -101 -61 -126 -122c-8 -19 -9 -20 -18 -20c0 0 -12 0 -12 10c0 9 57 154 159 154c50 0 92 -35 92 -92Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D457" x="0" y="0"></use>
</g>
</svg>, and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.211ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 521.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">k</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D458" d="M508 379c0 -39 -29 -61 -55 -61c-27 0 -38 19 -38 35c0 12 9 51 57 54c-2 2 -2 3 -4 4c-8 6 -9 6 -21 8c-2 1 -3 1 -9 1c-49 0 -95 -43 -143 -96c-23 -24 -55 -56 -86 -74c85 -11 148 -40 148 -105c0 -10 0 -14 -4 -31c-4 -16 -8 -39 -8 -56c0 -36 13 -47 32 -47 c44 0 67 51 87 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -11 -57 -36 -101c-22 -37 -49 -53 -79 -53c-52 0 -92 40 -92 99c0 11 2 23 4 35c3 10 3 14 3 21c0 66 -82 82 -116 85c-6 -25 -51 -210 -56 -219c-6 -12 -21 -21 -34 -21c-9 0 -29 5 -29 28c0 6 0 8 4 22l145 576 l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-104 -422c38 15 77 55 111 93c72 80 118 88 146 88c45 0 68 -33 68 -63Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D458" x="0" y="0"></use>
</g>
</svg> represent the axes <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.365ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3170.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 1 comma 0 comma 0 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="890" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="1335" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1835" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="2280" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2781" y="0"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.365ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3170.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 0 comma 1 comma 0 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="890" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1335" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1835" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="2280" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2781" y="0"></use>
</g>
</svg>, and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.365ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3170.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 0 comma 0 comma 1 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="890" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="1335" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1835" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="2280" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2781" y="0"></use>
</g>
</svg>,
respectively.  Note that this equation is merely a memory aid and not a
rigorous mathematical construction, since the matrix entries are a mix of
scalars and vectors. 

</p>
<p>The cross product implementation here uses the <a href="../Utilities/Mathematical_Infrastructure.html#DifferenceOfProducts"><tt>DifferenceOfProducts()</tt></a>
function that is introduced in Section&nbsp;<a href="../Utilities/Mathematical_Infrastructure.html#sec:fp-error-free-xforms">B.2.9</a>.
Given values <tt>a</tt>, <tt>b</tt>, <tt>c</tt>, and <tt>d</tt>, it computes
<tt>a*b-c*d</tt> in a way that maintains more floating-point accuracy
than a direct implementation of that expression would.  This concern is not
a theoretical one: previous versions of <tt>pbrt</tt> have resorted to using
double precision for the implementation of <tt>Cross()</tt> so that numerical
error would not lead to artifacts in rendered images.  Using
<a href="../Utilities/Mathematical_Infrastructure.html#DifferenceOfProducts"><tt>DifferenceOfProducts()</tt></a> is a better solution since it can operate
entirely in single precision while still computing a result with low
error.

</p>
<p></p>
<span class="anchor" id="fragment-Vector3InlineFunctions-7"></span><div class="fragmentname">&lt;&lt;Vector3 Inline Functions&gt;&gt;+=&nbsp;<a href="#fragment-Vector3InlineFunctions-6"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-Vector3InlineFunctions-8"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">template &lt;typename T&gt;
Vector3&lt;T&gt; <span class="anchor" id="Cross"></span>Cross(Vector3&lt;T&gt; v, Vector3&lt;T&gt; w) {
    return {<a href="../Utilities/Mathematical_Infrastructure.html#DifferenceOfProducts" class="code">DifferenceOfProducts</a>(v.y, w.z, v.z, w.y),
            <a href="../Utilities/Mathematical_Infrastructure.html#DifferenceOfProducts" class="code">DifferenceOfProducts</a>(v.z, w.x, v.x, w.z),
            <a href="../Utilities/Mathematical_Infrastructure.html#DifferenceOfProducts" class="code">DifferenceOfProducts</a>(v.x, w.y, v.y, w.x)};
}</div><p>


</p>
<p>From the definition of the cross product, we can derive
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="eq:cross-sin-theta"></span><div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="24.192ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 10416.1 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">double-vertical-bar bold v times bold w double-vertical-bar equals double-vertical-bar bold v double-vertical-bar double-vertical-bar bold w double-vertical-bar StartAbsoluteValue sine theta EndAbsoluteValue comma</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E2-LATINMODERNMAIN-2016" d="M151 -230c0 -11 -9 -20 -20 -20s-20 9 -20 20v960c0 11 9 20 20 20s20 -9 20 -20v-960zM287 -230c0 -11 -9 -20 -20 -20s-20 9 -20 20v960c0 11 9 20 20 20s20 -9 20 -20v-960Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-D7" d="M624 15c-7 -8 -20 -8 -28 0l-207 207l-207 -207c-8 -8 -21 -8 -28 0c-8 7 -8 20 0 28l207 207l-207 207c-8 8 -8 21 0 28c7 8 20 8 28 0l207 -207l207 207c8 8 21 8 28 0c8 -7 8 -20 0 -28l-207 -207l207 -207c8 -8 8 -21 0 -28Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D430" d="M805 397c-59 0 -63 -8 -68 -21l-144 -353c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-106 259l-106 -259c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-153 374h-59v47l109 -3l123 3v-47h-56l105 -258l79 192c1 3 4 9 4 13c0 0 0 3 -21 53h-59v47c16 -1 58 -3 100 -3l114 3v-47 h-56l114 -280l105 256c1 3 4 9 4 12c0 11 -49 12 -58 12v47l96 -3c24 0 54 1 77 3v-47Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-7C" d="M159 -230c0 -11 -9 -20 -20 -20s-20 9 -20 20v960c0 11 9 20 20 20s20 -9 20 -20v-960Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-6E" d="M535 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c58 0 91 -20 105 -37 c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E2-LATINMODERNMAIN-2016" x="0" y="0"></use>
<g transform="translate(398,0)">
 <use xlink:href="#E2-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-D7" x="607" y="0"></use>
 <use xlink:href="#E2-LATINMODERNNORMAL-1D430" x="1386" y="0"></use>
</g>
 <use xlink:href="#E2-LATINMODERNMAIN-2016" x="2616" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-3D" x="3292" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2016" x="4348" y="0"></use>
 <use xlink:href="#E2-LATINMODERNNORMAL-1D42F" x="4747" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2016" x="5354" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2016" x="5919" y="0"></use>
 <use xlink:href="#E2-LATINMODERNNORMAL-1D430" x="6318" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2016" x="7149" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-7C" x="7714" y="0"></use>
<g transform="translate(7993,0)">
 <use xlink:href="#E2-LATINMODERNMAIN-73"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-6E" x="673" y="0"></use>
</g>
 <use xlink:href="#E2-LATINMODERNNORMAL-1D703" x="9389" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-7C" x="9859" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2C" x="10137" y="0"></use>
</g>
</svg>
</div>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">
<div class="eqno">(<a href="#eq:cross-sin-theta">3.3</a>)</div>
</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<p>

where <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">theta</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="0" y="0"></use>
</g>
</svg> is the angle between <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
</g>
</svg> and
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.931ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 831.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold w</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D430" d="M805 397c-59 0 -63 -8 -68 -21l-144 -353c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-106 259l-106 -259c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-153 374h-59v47l109 -3l123 3v-47h-56l105 -258l79 192c1 3 4 9 4 13c0 0 0 3 -21 53h-59v47c16 -1 58 -3 100 -3l114 3v-47 h-56l114 -280l105 256c1 3 4 9 4 12c0 11 -49 12 -58 12v47l96 -3c24 0 54 1 77 3v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="0" y="0"></use>
</g>
</svg>.  An important implication of this is that the cross product of
two perpendicular unit vectors is itself a unit vector.  Note also
that the result of the cross product is a degenerate vector if <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
</g>
</svg>
and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.931ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 831.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold w</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D430" d="M805 397c-59 0 -63 -8 -68 -21l-144 -353c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-106 259l-106 -259c-7 -17 -11 -27 -36 -27s-29 10 -36 27l-153 374h-59v47l109 -3l123 3v-47h-56l105 -258l79 192c1 3 4 9 4 13c0 0 0 3 -21 53h-59v47c16 -1 58 -3 100 -3l114 3v-47 h-56l114 -280l105 256c1 3 4 9 4 12c0 11 -49 12 -58 12v47l96 -3c24 0 54 1 77 3v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D430" x="0" y="0"></use>
</g>
</svg> are parallel.

</p>
<p>This definition also shows a convenient way to compute the area of a
parallelogram (Figure&nbsp;<a href="#fig:parallelogram-area">3.6</a>).  If the two edges of
the parallelogram are given by vectors <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.588ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1114.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v bold 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7CF" d="M494 0c-44 3 -150 3 -199 3s-155 0 -199 -3v47h139v517c-59 -19 -114 -20 -130 -20h-20v47h20c21 0 124 0 201 57c9 7 11 7 22 7c26 0 26 -10 26 -32v-576h140v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7CF" x="859" y="-213"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.588ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1114.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v bold 2</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7D0" d="M517 222l-31 -222h-429v18c0 20 0 22 13 34l201 205c70 71 108 139 108 208c0 75 -46 143 -132 143c-36 0 -74 -11 -103 -35c15 -4 57 -20 57 -72c0 -50 -40 -72 -72 -72c-24 0 -72 15 -72 74c0 90 94 152 215 152c141 0 245 -74 245 -189c0 -95 -64 -142 -178 -226 c-45 -33 -97 -76 -144 -115h147c16 0 91 0 102 6c14 7 23 71 26 91h47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7D0" x="859" y="-213"></use>
</g>
</svg>, and it
has height <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.339ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 576.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">h</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-210E" d="M546 143c0 -8 -37 -154 -131 -154c-47 0 -82 35 -82 82c0 20 5 32 13 55c24 61 62 170 62 224c0 36 -11 70 -54 70s-74 -19 -96 -35c-34 -27 -65 -83 -68 -92c-1 -6 -9 -39 -11 -45c-5 -23 -11 -45 -17 -67l-22 -90l-19 -76c-5 -14 -21 -26 -37 -26c-9 0 -29 5 -29 28 c0 6 0 8 4 22l145 576l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-78 -318c37 46 85 77 148 77c75 0 115 -42 115 -107c0 -58 -45 -177 -61 -220c-9 -22 -18 -46 -18 -71c0 -23 7 -33 24 -33c55 0 87 71 102 124 c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-210E" x="0" y="0"></use>
</g>
</svg>, the area is given by <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.778ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2487.9 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">double-vertical-bar bold v bold 1 double-vertical-bar h</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E2-LATINMODERNMAIN-2016" d="M151 -230c0 -11 -9 -20 -20 -20s-20 9 -20 20v960c0 11 9 20 20 20s20 -9 20 -20v-960zM287 -230c0 -11 -9 -20 -20 -20s-20 9 -20 20v960c0 11 9 20 20 20s20 -9 20 -20v-960Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D7CF" d="M494 0c-44 3 -150 3 -199 3s-155 0 -199 -3v47h139v517c-59 -19 -114 -20 -130 -20h-20v47h20c21 0 124 0 201 57c9 7 11 7 22 7c26 0 26 -10 26 -32v-576h140v-47Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-210E" d="M546 143c0 -8 -37 -154 -131 -154c-47 0 -82 35 -82 82c0 20 5 32 13 55c24 61 62 170 62 224c0 36 -11 70 -54 70s-74 -19 -96 -35c-34 -27 -65 -83 -68 -92c-1 -6 -9 -39 -11 -45c-5 -23 -11 -45 -17 -67l-22 -90l-19 -76c-5 -14 -21 -26 -37 -26c-9 0 -29 5 -29 28 c0 6 0 8 4 22l145 576l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-78 -318c37 46 85 77 148 77c75 0 115 -42 115 -107c0 -58 -45 -177 -61 -220c-9 -22 -18 -46 -18 -71c0 -23 7 -33 24 -33c55 0 87 71 102 124 c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E2-LATINMODERNMAIN-2016" x="0" y="0"></use>
<g transform="translate(398,0)">
 <use xlink:href="#E2-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E2-LATINMODERNNORMAL-1D7CF" x="859" y="-213"></use>
</g>
 <use xlink:href="#E2-LATINMODERNMAIN-2016" x="1512" y="0"></use>
 <use xlink:href="#E2-LATINMODERNNORMAL-210E" x="1911" y="0"></use>
</g>
</svg>.  Since <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.21ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 5687.7 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">h equals sine theta double-vertical-bar bold v bold 2 double-vertical-bar</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E2-LATINMODERNNORMAL-210E" d="M546 143c0 -8 -37 -154 -131 -154c-47 0 -82 35 -82 82c0 20 5 32 13 55c24 61 62 170 62 224c0 36 -11 70 -54 70s-74 -19 -96 -35c-34 -27 -65 -83 -68 -92c-1 -6 -9 -39 -11 -45c-5 -23 -11 -45 -17 -67l-22 -90l-19 -76c-5 -14 -21 -26 -37 -26c-9 0 -29 5 -29 28 c0 6 0 8 4 22l145 576l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-78 -318c37 46 85 77 148 77c75 0 115 -42 115 -107c0 -58 -45 -177 -61 -220c-9 -22 -18 -46 -18 -71c0 -23 7 -33 24 -33c55 0 87 71 102 124 c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-6E" d="M535 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c58 0 91 -20 105 -37 c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-2016" d="M151 -230c0 -11 -9 -20 -20 -20s-20 9 -20 20v960c0 11 9 20 20 20s20 -9 20 -20v-960zM287 -230c0 -11 -9 -20 -20 -20s-20 9 -20 20v960c0 11 9 20 20 20s20 -9 20 -20v-960Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D7D0" d="M517 222l-31 -222h-429v18c0 20 0 22 13 34l201 205c70 71 108 139 108 208c0 75 -46 143 -132 143c-36 0 -74 -11 -103 -35c15 -4 57 -20 57 -72c0 -50 -40 -72 -72 -72c-24 0 -72 15 -72 74c0 90 94 152 215 152c141 0 245 -74 245 -189c0 -95 -64 -142 -178 -226 c-45 -33 -97 -76 -144 -115h147c16 0 91 0 102 6c14 7 23 71 26 91h47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E2-LATINMODERNNORMAL-210E" x="0" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-3D" x="854" y="0"></use>
<g transform="translate(1910,0)">
 <use xlink:href="#E2-LATINMODERNMAIN-73"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-6E" x="673" y="0"></use>
</g>
 <use xlink:href="#E2-LATINMODERNNORMAL-1D703" x="3306" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2016" x="3776" y="0"></use>
<g transform="translate(4174,0)">
 <use xlink:href="#E2-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E2-LATINMODERNNORMAL-1D7D0" x="859" y="-213"></use>
</g>
 <use xlink:href="#E2-LATINMODERNMAIN-2016" x="5289" y="0"></use>
</g>
</svg>, we can use Equation&nbsp;(<a href="#eq:cross-sin-theta">3.3</a>) to see
that the area is <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.836ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3804.4 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">double-vertical-bar bold v bold 1 times bold v bold 2 double-vertical-bar</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E2-LATINMODERNMAIN-2016" d="M151 -230c0 -11 -9 -20 -20 -20s-20 9 -20 20v960c0 11 9 20 20 20s20 -9 20 -20v-960zM287 -230c0 -11 -9 -20 -20 -20s-20 9 -20 20v960c0 11 9 20 20 20s20 -9 20 -20v-960Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D7CF" d="M494 0c-44 3 -150 3 -199 3s-155 0 -199 -3v47h139v517c-59 -19 -114 -20 -130 -20h-20v47h20c21 0 124 0 201 57c9 7 11 7 22 7c26 0 26 -10 26 -32v-576h140v-47Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-D7" d="M624 15c-7 -8 -20 -8 -28 0l-207 207l-207 -207c-8 -8 -21 -8 -28 0c-8 7 -8 20 0 28l207 207l-207 207c-8 8 -8 21 0 28c7 8 20 8 28 0l207 -207l207 207c8 8 21 8 28 0c8 -7 8 -20 0 -28l-207 -207l207 -207c8 -8 8 -21 0 -28Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D7D0" d="M517 222l-31 -222h-429v18c0 20 0 22 13 34l201 205c70 71 108 139 108 208c0 75 -46 143 -132 143c-36 0 -74 -11 -103 -35c15 -4 57 -20 57 -72c0 -50 -40 -72 -72 -72c-24 0 -72 15 -72 74c0 90 94 152 215 152c141 0 245 -74 245 -189c0 -95 -64 -142 -178 -226 c-45 -33 -97 -76 -144 -115h147c16 0 91 0 102 6c14 7 23 71 26 91h47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E2-LATINMODERNMAIN-2016" x="0" y="0"></use>
<g transform="translate(398,0)">
 <use xlink:href="#E2-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E2-LATINMODERNNORMAL-1D7CF" x="859" y="-213"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-D7" x="1114" y="0"></use>
<g transform="translate(1892,0)">
 <use xlink:href="#E2-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E2-LATINMODERNNORMAL-1D7D0" x="859" y="-213"></use>
</g>
</g>
 <use xlink:href="#E2-LATINMODERNMAIN-2016" x="3405" y="0"></use>
</g>
</svg>.

</p>
<p></p>
<span class="anchor" id="fig:parallelogram-area"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha03f06.svg" title=""><img src="pha03f06.svg" width=339 height=232 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 3.6: <span class="legend"> The area of a parallelogram with
edges given by vectors <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.588ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1114.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v bold 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7CF" d="M494 0c-44 3 -150 3 -199 3s-155 0 -199 -3v47h139v517c-59 -19 -114 -20 -130 -20h-20v47h20c21 0 124 0 201 57c9 7 11 7 22 7c26 0 26 -10 26 -32v-576h140v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7CF" x="859" y="-213"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.588ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1114.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v bold 2</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7D0" d="M517 222l-31 -222h-429v18c0 20 0 22 13 34l201 205c70 71 108 139 108 208c0 75 -46 143 -132 143c-36 0 -74 -11 -103 -35c15 -4 57 -20 57 -72c0 -50 -40 -72 -72 -72c-24 0 -72 15 -72 74c0 90 94 152 215 152c141 0 245 -74 245 -189c0 -95 -64 -142 -178 -226 c-45 -33 -97 -76 -144 -115h147c16 0 91 0 102 6c14 7 23 71 26 91h47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7D0" x="859" y="-213"></use>
</g>
</svg> is equal to
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.778ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2487.9 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">double-vertical-bar bold v bold 1 double-vertical-bar h</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E2-LATINMODERNMAIN-2016" d="M151 -230c0 -11 -9 -20 -20 -20s-20 9 -20 20v960c0 11 9 20 20 20s20 -9 20 -20v-960zM287 -230c0 -11 -9 -20 -20 -20s-20 9 -20 20v960c0 11 9 20 20 20s20 -9 20 -20v-960Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D7CF" d="M494 0c-44 3 -150 3 -199 3s-155 0 -199 -3v47h139v517c-59 -19 -114 -20 -130 -20h-20v47h20c21 0 124 0 201 57c9 7 11 7 22 7c26 0 26 -10 26 -32v-576h140v-47Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-210E" d="M546 143c0 -8 -37 -154 -131 -154c-47 0 -82 35 -82 82c0 20 5 32 13 55c24 61 62 170 62 224c0 36 -11 70 -54 70s-74 -19 -96 -35c-34 -27 -65 -83 -68 -92c-1 -6 -9 -39 -11 -45c-5 -23 -11 -45 -17 -67l-22 -90l-19 -76c-5 -14 -21 -26 -37 -26c-9 0 -29 5 -29 28 c0 6 0 8 4 22l145 576l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-78 -318c37 46 85 77 148 77c75 0 115 -42 115 -107c0 -58 -45 -177 -61 -220c-9 -22 -18 -46 -18 -71c0 -23 7 -33 24 -33c55 0 87 71 102 124 c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E2-LATINMODERNMAIN-2016" x="0" y="0"></use>
<g transform="translate(398,0)">
 <use xlink:href="#E2-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E2-LATINMODERNNORMAL-1D7CF" x="859" y="-213"></use>
</g>
 <use xlink:href="#E2-LATINMODERNMAIN-2016" x="1512" y="0"></use>
 <use xlink:href="#E2-LATINMODERNNORMAL-210E" x="1911" y="0"></use>
</g>
</svg>.  From Equation&nbsp;(<a href="#eq:cross-sin-theta">3.3</a>), the length of the cross
product of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.588ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1114.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v bold 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7CF" d="M494 0c-44 3 -150 3 -199 3s-155 0 -199 -3v47h139v517c-59 -19 -114 -20 -130 -20h-20v47h20c21 0 124 0 201 57c9 7 11 7 22 7c26 0 26 -10 26 -32v-576h140v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7CF" x="859" y="-213"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.588ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1114.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v bold 2</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7D0" d="M517 222l-31 -222h-429v18c0 20 0 22 13 34l201 205c70 71 108 139 108 208c0 75 -46 143 -132 143c-36 0 -74 -11 -103 -35c15 -4 57 -20 57 -72c0 -50 -40 -72 -72 -72c-24 0 -72 15 -72 74c0 90 94 152 215 152c141 0 245 -74 245 -189c0 -95 -64 -142 -178 -226 c-45 -33 -97 -76 -144 -115h147c16 0 91 0 102 6c14 7 23 71 26 91h47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7D0" x="859" y="-213"></use>
</g>
</svg>  is equal to the product of the two
vector lengths times the sine of the angle between them&mdash;the parallelogram
area.</span>
</figcaption>
</div></div><p>


</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#CoordinateSystemfromaVector"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="CoordinateSystemfromaVector"></span><h3>3.3.3  Coordinate System from a Vector</h3><p>


</p>
<p>We will sometimes find it useful to construct a local coordinate system
given only a single normalized 3D vector.  To do so, we must find two
additional normalized vectors such that all three vectors are mutually
perpendicular.

</p>
<p>Given a vector <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
</g>
</svg>, it can be shown that the two vectors
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="66.964ex" height="7.509ex" style="vertical-align: -3.171ex;" viewBox="0 -1867.7 28831.8 3233.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 1 minus StartFraction bold v Subscript x Superscript 2 Baseline Over 1 plus bold v Subscript z Baseline EndFraction comma minus StartFraction bold v Subscript x Baseline bold v Subscript y Baseline Over 1 plus bold v Subscript z Baseline EndFraction comma minus bold v Subscript x Baseline right-parenthesis normal a normal n normal d left-parenthesis minus StartFraction bold v Subscript x Baseline bold v Subscript y Baseline Over 1 plus bold v Subscript z Baseline EndFraction comma 1 minus StartFraction bold v Subscript y Superscript 2 Baseline Over 1 plus bold v Subscript z Baseline EndFraction comma minus bold v Subscript y Baseline right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE6-28" d="M682 -928c0 -10 -8 -18 -18 -18c-4 0 -8 2 -11 4c-222 167 -427 613 -427 1006v372c0 393 205 839 427 1006c3 2 7 4 11 4c10 0 18 -8 18 -18c0 -6 -3 -11 -7 -14c-213 -160 -361 -603 -361 -978v-372c0 -375 148 -818 361 -978c4 -3 7 -8 7 -14Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE6-29" d="M510 64c0 -393 -205 -839 -427 -1006c-3 -2 -7 -4 -11 -4c-10 0 -18 8 -18 18c0 6 3 11 7 14c213 160 361 603 361 978v372c0 375 -148 818 -361 978c-4 3 -7 8 -7 14c0 10 8 18 18 18c4 0 8 -2 11 -4c222 -167 427 -613 427 -1006v-372Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-61" d="M483 89c0 -81 -61 -95 -82 -95c-47 0 -74 42 -78 82c-19 -47 -65 -87 -131 -87c-63 0 -160 25 -160 106c0 44 25 96 100 130c63 30 133 33 184 36v37c0 89 -57 128 -106 128c-32 0 -81 -11 -108 -46c46 -1 51 -34 51 -46c0 -26 -18 -46 -46 -46c-26 0 -46 17 -46 47 c0 66 69 113 151 113c48 0 98 -16 137 -55c36 -37 36 -76 36 -118v-200c0 -5 4 -50 37 -50c11 0 36 6 36 64v56h25v-56zM316 140v100c-165 -6 -207 -89 -207 -144c0 -50 41 -85 90 -85c45 0 117 34 117 129Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6E" d="M535 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c58 0 91 -20 105 -37 c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-64" d="M527 0l-147 -11v66c-25 -32 -70 -66 -134 -66c-114 0 -212 99 -212 226c0 129 105 227 223 227c54 0 97 -26 126 -62v216c0 49 -8 56 -78 56v31l144 11v-607c0 -49 8 -56 78 -56v-31zM380 118v205c0 18 0 20 -11 37c-31 45 -73 60 -108 60c-54 0 -92 -33 -113 -64 c-29 -45 -31 -105 -31 -142c0 -41 3 -98 29 -139c24 -38 60 -64 105 -64c43 0 88 22 118 70c11 17 11 19 11 37Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE7-28" d="M823 -1224c0 -11 -10 -21 -21 -21c-5 0 -9 2 -12 4c-268 202 -513 751 -513 1241v500c0 490 245 1039 513 1241c3 2 7 4 12 4c11 0 21 -10 21 -21c0 -7 -3 -13 -9 -17c-255 -192 -435 -739 -435 -1207v-500c0 -468 180 -1015 435 -1207c6 -4 9 -10 9 -17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE7-29" d="M598 0c0 -490 -245 -1039 -513 -1241c-3 -2 -7 -4 -12 -4c-11 0 -21 10 -21 21c0 7 3 13 9 17c255 192 435 739 435 1207v500c0 468 -180 1015 -435 1207c-6 4 -9 10 -9 17c0 11 10 21 21 21c5 0 9 -2 12 -4c268 -202 513 -751 513 -1241v-500Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNSIZE6-28"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="736" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="1459" y="0"></use>
<g transform="translate(2237,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="2881" height="60" x="0" y="220"></rect>
<g transform="translate(884,676)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="859" y="488"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="859" y="-211"></use>
</g>
<g transform="translate(60,-687)">
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="722" y="0"></use>
<g transform="translate(1723,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="859" y="-213"></use>
</g>
</g>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="5581" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="6026" y="0"></use>
<g transform="translate(6805,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="2881" height="60" x="0" y="220"></rect>
<g transform="translate(357,815)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="859" y="-213"></use>
<g transform="translate(1112,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="859" y="-213"></use>
</g>
</g>
<g transform="translate(60,-687)">
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="722" y="0"></use>
<g transform="translate(1723,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="859" y="-213"></use>
</g>
</g>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="9926" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="10371" y="0"></use>
<g transform="translate(11150,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="859" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSIZE6-29" x="12262" y="0"></use>
<g transform="translate(13499,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-61" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="1057" y="0"></use>
</g>
<g transform="translate(15612,0)">
 <use xlink:href="#E1-LATINMODERNSIZE7-28"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="875" y="0"></use>
<g transform="translate(1654,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="2881" height="60" x="0" y="220"></rect>
<g transform="translate(357,815)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="859" y="-213"></use>
<g transform="translate(1112,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="859" y="-213"></use>
</g>
</g>
<g transform="translate(60,-687)">
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="722" y="0"></use>
<g transform="translate(1723,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="859" y="-213"></use>
</g>
</g>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="4775" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="5220" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="5943" y="0"></use>
<g transform="translate(6721,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="2881" height="60" x="0" y="220"></rect>
<g transform="translate(910,813)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="859" y="488"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="859" y="-211"></use>
</g>
<g transform="translate(60,-687)">
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="722" y="0"></use>
<g transform="translate(1723,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="859" y="-213"></use>
</g>
</g>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="10065" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="10510" y="0"></use>
<g transform="translate(11289,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="859" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSIZE7-29" x="12343" y="0"></use>
</g>
</g>
</svg>
</div>
<p>

fulfill these conditions.  However, computing those properties directly has
high error when <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.468ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 3646.1 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v Subscript z Baseline almost-equals negative 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2248" d="M717 438v-2c-20 -93 -56 -149 -139 -169c-11 -3 -23 -4 -35 -4c-62 0 -120 37 -172 76c-43 32 -89 67 -138 67c-9 0 -17 -1 -26 -3c-67 -17 -111 -49 -127 -124c-1 -5 -6 -9 -12 -9c-7 0 -12 5 -12 12v2c20 93 56 149 139 169c12 3 24 4 35 4c62 0 120 -37 172 -76 c43 -32 89 -67 139 -67c8 0 16 1 25 3c67 17 111 49 127 124c2 5 6 9 12 9c7 0 12 -5 12 -12zM717 218v-2c-20 -93 -56 -149 -139 -169c-11 -3 -23 -4 -35 -4c-62 0 -120 37 -172 76c-43 32 -89 67 -138 67c-9 0 -17 -1 -26 -3c-67 -17 -111 -49 -127 -124 c-1 -5 -6 -9 -12 -9c-7 0 -12 5 -12 12v2c20 93 56 149 139 169c12 3 24 4 35 4c62 0 120 -37 172 -76c43 -32 89 -67 139 -67c8 0 16 1 25 3c67 17 111 49 127 124c2 5 6 9 12 9c7 0 12 -5 12 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="859" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2248" x="1315" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="2367" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="3145" y="0"></use>
</g>
</svg> due to a loss of accuracy
when <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.548ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4541.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">1 slash left-parenthesis 1 plus bold v Subscript z Baseline right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1001" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1390" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="2113" y="0"></use>
<g transform="translate(3113,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="859" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4152" y="0"></use>
</g>
</svg> is calculated.  A reformulation of that
computation, used in the following implementation, addresses that
issue.

</p>
<p></p>
<span class="anchor" id="fragment-Vector3InlineFunctions-8"></span><div class="fragmentname">&lt;&lt;Vector3 Inline Functions&gt;&gt;+=&nbsp;<a href="#fragment-Vector3InlineFunctions-7"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">template &lt;typename T&gt;
void <span class="anchor" id="CoordinateSystem"></span>CoordinateSystem(Vector3&lt;T&gt; v1, Vector3&lt;T&gt; *v2, Vector3&lt;T&gt; *v3) {
    Float sign = pstd::copysign(Float(1), v1.z);
    Float a = -1 / (sign + v1.z);
    Float b = v1.x * v1.y * a;
    *v2 = Vector3&lt;T&gt;(1 + sign * <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(v1.x) * a, sign * b, -sign * v1.x);
    *v3 = Vector3&lt;T&gt;(b, sign + <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(v1.y) * a, -v1.y);
}</div><p>


</p>
<p>

</p>
<p>

</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

</div>  <!-- container-fluid -->
</div>  <!-- maincontainer -->

<nav class="navbar navbar-expand-md bg-light navbar-light">
<div class="container-fluid">
  <span class="navbar-text"><i>Physically Based Rendering: From Theory To Implementation</i>,<br>
<a href="https://creativecommons.org/licenses/by-nc-nd/4.0/">&copy; 2004-2023</a> Matt Pharr, Wenzel Jakob, and Greg Humphreys.
<a href="https://github.com/mmp/pbr-book-website/"><span class="fab fa-github"></span></a><br>
Purchase a printed copy: <a href="https://www.amazon.com/Physically-Based-Rendering-fourth-Implementation/dp/0262048027?keywords=physically+based+rendering+4th+edition&qid=1671730412&sprefix=physically+based%!C(MISSING)aps%!C(MISSING)145&sr=8-1&linkCode=ll1&tag=pharr-20&linkId=81a816d90f0c7e872617f1f930a51fd6&language=en_US&ref_=as_li_ss_tl"><span class="fab fa-amazon"></span></a>
<a href="https://mitpress.mit.edu/9780262048026/physically-based-rendering/"><img src="/mitpress.png" width=10 height=16></a>
</span>
</div>
  <div class="container">
    <ul class="nav navbar-nav ml-auto">
      <li class="nav-item">Next: <a href="../Geometry_and_Transformations/Points.html">Geometry and Transformations / Points</a></li>
    </ul>
  </div>

</nav>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script>
  $(function () {
    $('[data-toggle="popover"]').popover()
    $('[data-toggle="tooltip"]').tooltip()
   })
</script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

<script>
// https://stackoverflow.com/a/17535094
// The function actually applying the offset
function offsetAnchor() {
  if (location.hash.length !== 0) {
    window.scrollTo(window.scrollX, window.scrollY - window.innerHeight / 8);
  }
}

// Captures click events of all <a> elements with href starting with #
$(document).on('click', 'a[href^="#"]', function(event) {
  // Click events are captured before hashchanges. Timeout
  // causes offsetAnchor to be called after the page jump.
  window.setTimeout(function() {
    offsetAnchor();
  }, 500);
});

// Set the offset when entering page with hash present in the url
window.setTimeout(offsetAnchor, 1500);
</script>

</body>
</html>
