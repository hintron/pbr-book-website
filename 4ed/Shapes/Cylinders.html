
<!doctype html>
<html lang="en">
<head>

<!-- all praise to https://realfavicongenerator.net -->
<link rel="icon" href="/favicon.ico?v=2" /> <!-- force refresh -->
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="/fonts.css">
  <link rel="stylesheet" href="../pbrstyle.css">
  <link rel="stylesheet" href="/fontawesome-free-5.15.3-web/css/all.css">

<script async src="https://cse.google.com/cse.js?cx=22a43cef261a245ea"></script>  <script src="/react.min.js"></script>
  <script src="/react-dom.min.js"></script>
  <script src="/jeri.min.js"></script>
  <link rel="preload" href="/exr.worker.js" as="script" crossorigin="anonymous">
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="/bootstrap.min.css">

  <title>Cylinders</title>
</head>
        
<body>

<nav class="fixed-top-lg-navbar navbar navbar-expand bg-light navbar-light">
  <ul class="nav navbar-nav">
    <a class="navbar-brand" href="../contents.html"><img src="../pbr.jpg" width=25 height=25></a>
    <li class="nav-item"><a class="nav-link" href="../Shapes.html">Shapes</a></li>
    <span class="navbar-text">/</span>
    <li class="nav-item"><a class="nav-link" href="#">Cylinders</a></li>
    <span class="navbar-text">&nbsp;&nbsp;</span>
    <li class="nav-item"><a class="nav-link" href="../Shapes/Spheres.html">(Previous: Spheres)</a></li>
  </ul>

  <ul class="nav navbar-nav ml-auto d-none d-md-block">
        <li class="nav-item"><div class="gcse-search"></div></li>
    </ul>
  <ul class="nav navbar-nav d-block d-md-none">
        <li class="nav-item"><div class="gcse-search"></div></li>
    </ul>
</nav>

<div class="maincontainer">
<div class="container-fluid">

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#"><i class="fas fa-link "></i></a>
</div>
<div class="col-md-10 col-lg-8">
<h2>6.3 Cylinders</h2><p>


</p>
<p>Another useful quadric is the cylinder; <tt>pbrt</tt> provides a cylinder
<a href="../Shapes/Basic_Shape_Interface.html#Shape"><tt>Shape</tt></a> that is centered around the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.086ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 467.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
</g>
</svg> axis.  The user can supply a
minimum and maximum <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.086ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 467.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
</g>
</svg> value for the cylinder, as well as a radius and
maximum <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.385ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 596.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">phi</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D719" d="M573 262c0 -134 -145 -269 -306 -274l-38 -149c-3 -14 -9 -38 -11 -40c-3 -3 -5 -4 -10 -4s-12 1 -12 11c0 3 10 41 22 88l23 94c-122 7 -192 86 -192 181c0 136 147 269 306 274l58 231c4 17 5 20 15 20c12 0 12 -10 12 -10l-3 -14l-56 -227c139 -10 192 -102 192 -181z M349 421c-149 -13 -235 -153 -235 -273c0 -100 72 -135 132 -138zM508 283c0 88 -57 134 -133 138l-103 -411c150 12 236 155 236 273Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="0" y="0"></use>
</g>
</svg> sweep value (Figure&nbsp;<a href="#fig:cylinder-setting">6.7</a>).

</p>
<p></p>
<span class="anchor" id="fig:cylinder-setting"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha06f07.svg" title=""><img src="pha06f07.svg" width=518 height=399 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 6.7: Basic Setting for the Cylinder Shape. <span class="legend"> 
The cylinder has a radius of&nbsp;<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.049ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 451.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">r</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45F" d="M436 377c0 -36 -28 -59 -55 -59s-38 19 -38 35c0 26 22 50 52 55c0 0 -16 12 -42 12c-43 0 -72 -26 -80 -33c-24 -22 -52 -69 -56 -82l-32 -130c-4 -18 -38 -154 -40 -158c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43l58 231c13 52 16 63 16 84 c0 38 -14 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 3 13 63 31 97c9 18 28 57 74 57c47 0 83 -32 91 -77c19 28 63 77 128 77c51 0 83 -30 83 -65Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45F" x="0" y="0"></use>
</g>
</svg> and  covers a range along the
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.086ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 467.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
</g>
</svg> axis.  A&nbsp;partial cylinder may be swept by specifying a maximum <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.385ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 596.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">phi</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D719" d="M573 262c0 -134 -145 -269 -306 -274l-38 -149c-3 -14 -9 -38 -11 -40c-3 -3 -5 -4 -10 -4s-12 1 -12 11c0 3 10 41 22 88l23 94c-122 7 -192 86 -192 181c0 136 147 269 306 274l58 231c4 17 5 20 15 20c12 0 12 -10 12 -10l-3 -14l-56 -227c139 -10 192 -102 192 -181z M349 421c-149 -13 -235 -153 -235 -273c0 -100 72 -135 132 -138zM508 283c0 88 -57 134 -133 138l-103 -411c150 12 236 155 236 273Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="0" y="0"></use>
</g>
</svg>
value.</span>
</figcaption><p>



</p>
</div></div><p>


</p>
<p></p>
<span class="anchor" id="fragment-CylinderDefinition-0"></span><div class="fragmentname">&lt;&lt;Cylinder Definition&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">class <span class="anchor" id="Cylinder"></span>Cylinder {
  public:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-CylinderPublicMethods-0">Cylinder Public Methods</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-446" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-446"><i></i></a><div id="fragbit-446" class="collapse show"><div class="fragmentcode">       Cylinder(const <a href="../Geometry_and_Transformations/Transformations.html#Transform" class="code">Transform</a> *renderFromObj, const <a href="../Geometry_and_Transformations/Transformations.html#Transform" class="code">Transform</a> *objFromRender,
           bool reverseOrientation, Float <a href="#Cylinder::radius" class="code">radius</a>, Float <a href="#Cylinder::zMin" class="code">zMin</a>, Float <a href="#Cylinder::zMax" class="code">zMax</a>,
           Float <a href="#Cylinder::phiMax" class="code">phiMax</a>);
       static Cylinder *Create(const <a href="../Geometry_and_Transformations/Transformations.html#Transform" class="code">Transform</a> *renderFromObject,
                               const <a href="../Geometry_and_Transformations/Transformations.html#Transform" class="code">Transform</a> *objectFromRender, bool reverseOrientation,
                               const ParameterDictionary &amp;parameters, const FileLoc *loc,
                               Allocator alloc);
       PBRT_CPU_GPU
       <a href="../Geometry_and_Transformations/Bounding_Boxes.html#Bounds3f" class="code">Bounds3f</a> Bounds() const;
       std::string ToString() const;
       Float <a href="#Cylinder::Area" class="code">Area</a>() const { return (<a href="#Cylinder::zMax" class="code">zMax</a> - <a href="#Cylinder::zMin" class="code">zMin</a>) * <a href="#Cylinder::radius" class="code">radius</a> * <a href="#Cylinder::phiMax" class="code">phiMax</a>; }
       <a href="../Geometry_and_Transformations/Spherical_Geometry.html#DirectionCone" class="code">DirectionCone</a> NormalBounds() const { return <a href="../Geometry_and_Transformations/Spherical_Geometry.html#DirectionCone" class="code">DirectionCone</a>::EntireSphere(); }
       pstd::optional&lt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeIntersection" class="code">ShapeIntersection</a>&gt; Intersect(const <a href="../Geometry_and_Transformations/Rays.html#Ray" class="code">Ray</a> &amp;ray,
                                                   Float tMax = Infinity) const {
           pstd::optional&lt;<a href="../Shapes/Spheres.html#QuadricIntersection" class="code">QuadricIntersection</a>&gt; isect = <a href="#Cylinder::BasicIntersect" class="code">BasicIntersect</a>(ray, tMax);
           if (!isect) return {};
           <a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction" class="code">SurfaceInteraction</a> intr =
               <a href="#Cylinder::InteractionFromIntersection" class="code">InteractionFromIntersection</a>(*isect, -ray.<a href="../Geometry_and_Transformations/Rays.html#Ray::d" class="code">d</a>, ray.<a href="../Geometry_and_Transformations/Rays.html#Ray::time" class="code">time</a>);
           return <a href="../Shapes/Basic_Shape_Interface.html#ShapeIntersection" class="code">ShapeIntersection</a>{intr, isect-&gt;<a href="../Shapes/Spheres.html#QuadricIntersection::tHit" class="code">tHit</a>};
       }
       pstd::optional&lt;<a href="../Shapes/Spheres.html#QuadricIntersection" class="code">QuadricIntersection</a>&gt; <a href="#Cylinder::BasicIntersect" class="code">BasicIntersect</a>(const <a href="../Geometry_and_Transformations/Rays.html#Ray" class="code">Ray</a> &amp;r,
                                                          Float tMax) const {
           Float <a href="../Shapes/Spheres.html#QuadricIntersection::phi" class="code">phi</a>;
           <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> pHit;
           &lt;&lt;<span class="fragmentname"><a href="Spheres.html#fragment-TransformmonoRayoriginanddirectiontoobjectspace-0">Transform <tt>Ray</tt> origin and direction to object space</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-447" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-447"><i></i></a><div id="fragbit-447" class="collapse show"><div class="fragmentcode">              <a href="../Utilities/Mathematical_Infrastructure.html#Point3fi" class="code">Point3fi</a> oi = (*<a href="../Shapes/Spheres.html#Sphere::objectFromRender" class="code">objectFromRender</a>)(<a href="../Utilities/Mathematical_Infrastructure.html#Point3fi" class="code">Point3fi</a>(r.<a href="../Geometry_and_Transformations/Rays.html#Ray::o" class="code">o</a>));
              <a href="../Utilities/Mathematical_Infrastructure.html#Vector3fi" class="code">Vector3fi</a> di = (*<a href="../Shapes/Spheres.html#Sphere::objectFromRender" class="code">objectFromRender</a>)(<a href="../Utilities/Mathematical_Infrastructure.html#Vector3fi" class="code">Vector3fi</a>(r.<a href="../Geometry_and_Transformations/Rays.html#Ray::d" class="code">d</a>));</div></div>
           &lt;&lt;<span class="fragmentname"><a href="#fragment-Solvequadraticequationtofindcylindermonot0andmonot1values-0">Solve quadratic equation to find cylinder <tt>t0</tt> and <tt>t1</tt> values</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-448" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-448"><i></i></a><div id="fragbit-448" class="collapse show"><div class="fragmentcode">              <a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a> t0, t1;
              &lt;&lt;<span class="fragmentname"><a href="#fragment-Computecylinderquadraticcoefficients-0">Compute cylinder quadratic coefficients</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-449" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-449"><i></i></a><div id="fragbit-449" class="collapse show"><div class="fragmentcode">                 <a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a> a = <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(di.x) + <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(di.y);
                 <a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a> b = 2 * (di.x * oi.x + di.y * oi.y);
                 <a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a> c = <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(oi.x) + <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(oi.y) - <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(<a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a>(radius));</div></div>
              &lt;&lt;<span class="fragmentname"><a href="Managing_Rounding_Error.html#fragment-Computecylinderquadraticdiscriminantmonodiscrim-0">Compute cylinder quadratic discriminant <tt>discrim</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-450" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-450"><i></i></a><div id="fragbit-450" class="collapse show"><div class="fragmentcode">                 <a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a> f = b / (2 * a);
                 <a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a> vx = oi.x - f * di.x, vy = oi.y - f * di.y;
                 <a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a> length = <a href="../Utilities/Mathematical_Infrastructure.html#Interval::Sqrt" class="code">Sqrt</a>(<a href="../Utilities/Mathematical_Infrastructure.html#Interval::Sqr" class="code">Sqr</a>(vx) + <a href="../Utilities/Mathematical_Infrastructure.html#Interval::Sqr" class="code">Sqr</a>(vy));
                 <a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a> discrim = 4 * a * (<a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a>(radius) + length) *
                                            (<a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a>(radius) - length);
                 if (discrim.<a href="../Utilities/Mathematical_Infrastructure.html#Interval::LowerBound" class="code">LowerBound</a>() &lt; 0)
                     return {};</div></div>
              &lt;&lt;<span class="fragmentname"><a href="Spheres.html#fragment-Computequadratictvalues-0">Compute quadratic <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="2.009ex" style="vertical-align: -0.338ex;" viewBox="0 -719.6 361.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">t</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="0" y="0"></use>
</g>
</svg> values</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-451" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-451"><i></i></a><div id="fragbit-451" class="collapse show"><div class="fragmentcode">                 <a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a> rootDiscrim = <a href="../Utilities/Mathematical_Infrastructure.html#Interval::Sqrt" class="code">Sqrt</a>(discrim);
                 <a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a> q;
                 if ((Float)b &lt; 0) q = -.5f * (b - rootDiscrim);
                 else              q = -.5f * (b + rootDiscrim);
                 t0 = q / a;
                 t1 = c / q;
                 &lt;&lt;<span class="fragmentname"><a href="Spheres.html#fragment-Swapquadratictvaluessothatmonot0isthelesser-0">Swap quadratic <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="2.009ex" style="vertical-align: -0.338ex;" viewBox="0 -719.6 361.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">t</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="0" y="0"></use>
</g>
</svg> values so that <tt>t0</tt> is the lesser</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-452" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-452"><i></i></a><div id="fragbit-452" class="collapse show"><div class="fragmentcode">                    if (t0.<a href="../Utilities/Mathematical_Infrastructure.html#Interval::LowerBound" class="code">LowerBound</a>() &gt; t1.<a href="../Utilities/Mathematical_Infrastructure.html#Interval::LowerBound" class="code">LowerBound</a>())
                        pstd::swap(t0, t1);</div></div></div></div></div></div>
           &lt;&lt;<span class="fragmentname"><a href="Spheres.html#fragment-Checkquadricshapemonot0andmonot1fornearestintersection-0">Check quadric shape <tt>t0</tt> and <tt>t1</tt> for nearest intersection</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-453" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-453"><i></i></a><div id="fragbit-453" class="collapse show"><div class="fragmentcode">              if (t0.<a href="../Utilities/Mathematical_Infrastructure.html#Interval::UpperBound" class="code">UpperBound</a>() &gt; tMax || t1.<a href="../Utilities/Mathematical_Infrastructure.html#Interval::LowerBound" class="code">LowerBound</a>() &lt;= 0)
                  return {};
              <a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a> tShapeHit = t0;
              if (tShapeHit.<a href="../Utilities/Mathematical_Infrastructure.html#Interval::LowerBound" class="code">LowerBound</a>() &lt;= 0) {
                  tShapeHit = t1;
                  if (tShapeHit.<a href="../Utilities/Mathematical_Infrastructure.html#Interval::UpperBound" class="code">UpperBound</a>() &gt; tMax)
                      return {};
              }</div></div>
           &lt;&lt;<span class="fragmentname"><a href="#fragment-Computecylinderhitpointandphi-0">Compute cylinder hit point and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.385ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 596.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">phi</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D719" d="M573 262c0 -134 -145 -269 -306 -274l-38 -149c-3 -14 -9 -38 -11 -40c-3 -3 -5 -4 -10 -4s-12 1 -12 11c0 3 10 41 22 88l23 94c-122 7 -192 86 -192 181c0 136 147 269 306 274l58 231c4 17 5 20 15 20c12 0 12 -10 12 -10l-3 -14l-56 -227c139 -10 192 -102 192 -181z M349 421c-149 -13 -235 -153 -235 -273c0 -100 72 -135 132 -138zM508 283c0 88 -57 134 -133 138l-103 -411c150 12 236 155 236 273Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="0" y="0"></use>
</g>
</svg></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-454" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-454"><i></i></a><div id="fragbit-454" class="collapse show"><div class="fragmentcode">              pHit = <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a>(oi) + (Float)tShapeHit * <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(di);
              &lt;&lt;<span class="fragmentname"><a href="Managing_Rounding_Error.html#fragment-Refinecylinderintersectionpoint-0">Refine cylinder intersection point</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-455" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-455"><i></i></a><div id="fragbit-455" class="collapse show"><div class="fragmentcode">                 Float hitRad = std::sqrt(<a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(pHit.x) + <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(pHit.y));
                 pHit.x *= <a href="#Cylinder::radius" class="code">radius</a> / hitRad;
                 pHit.y *= <a href="#Cylinder::radius" class="code">radius</a> / hitRad;</div></div>
              phi = std::atan2(pHit.y, pHit.x);
              if (phi &lt; 0) phi += 2 * <a href="../Utilities/Mathematical_Infrastructure.html#Pi" class="code">Pi</a>;</div></div>
           &lt;&lt;<span class="fragmentname"><a href="#fragment-Testcylinderintersectionagainstclippingparameters-0">Test cylinder intersection against clipping parameters</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-456" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-456"><i></i></a><div id="fragbit-456" class="collapse show"><div class="fragmentcode">              if (pHit.z &lt; <a href="#Cylinder::zMin" class="code">zMin</a> || pHit.z &gt; <a href="#Cylinder::zMax" class="code">zMax</a> || phi &gt; <a href="#Cylinder::phiMax" class="code">phiMax</a>) {
                  if (tShapeHit == t1)
                      return {};
                  tShapeHit = t1;
                  if (t1.<a href="../Utilities/Mathematical_Infrastructure.html#Interval::UpperBound" class="code">UpperBound</a>() &gt; tMax)
                      return {};
                  &lt;&lt;<span class="fragmentname"><a href="#fragment-Computecylinderhitpointandphi-0">Compute cylinder hit point and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.385ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 596.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">phi</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D719" d="M573 262c0 -134 -145 -269 -306 -274l-38 -149c-3 -14 -9 -38 -11 -40c-3 -3 -5 -4 -10 -4s-12 1 -12 11c0 3 10 41 22 88l23 94c-122 7 -192 86 -192 181c0 136 147 269 306 274l58 231c4 17 5 20 15 20c12 0 12 -10 12 -10l-3 -14l-56 -227c139 -10 192 -102 192 -181z M349 421c-149 -13 -235 -153 -235 -273c0 -100 72 -135 132 -138zM508 283c0 88 -57 134 -133 138l-103 -411c150 12 236 155 236 273Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="0" y="0"></use>
</g>
</svg></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-457" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-457"><i></i></a><div id="fragbit-457" class="collapse show"><div class="fragmentcode">                     pHit = <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a>(oi) + (Float)tShapeHit * <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(di);
                     &lt;&lt;<span class="fragmentname"><a href="Managing_Rounding_Error.html#fragment-Refinecylinderintersectionpoint-0">Refine cylinder intersection point</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-458" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-458"><i></i></a><div id="fragbit-458" class="collapse show"><div class="fragmentcode">                        Float hitRad = std::sqrt(<a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(pHit.x) + <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(pHit.y));
                        pHit.x *= <a href="#Cylinder::radius" class="code">radius</a> / hitRad;
                        pHit.y *= <a href="#Cylinder::radius" class="code">radius</a> / hitRad;</div></div>
                     phi = std::atan2(pHit.y, pHit.x);
                     if (phi &lt; 0) phi += 2 * <a href="../Utilities/Mathematical_Infrastructure.html#Pi" class="code">Pi</a>;</div></div>
                  if (pHit.z &lt; <a href="#Cylinder::zMin" class="code">zMin</a> || pHit.z &gt; <a href="#Cylinder::zMax" class="code">zMax</a> || phi &gt; <a href="#Cylinder::phiMax" class="code">phiMax</a>)
                      return {};
              }</div></div>
           &lt;&lt;<span class="fragmentname"><a href="#fragment-ReturnmonoQuadricIntersectionforcylinderintersection-0">Return <tt>QuadricIntersection</tt> for cylinder intersection</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-459" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-459"><i></i></a><div id="fragbit-459" class="collapse show"><div class="fragmentcode">              return <a href="../Shapes/Spheres.html#QuadricIntersection" class="code">QuadricIntersection</a>{Float(tShapeHit), pHit, phi};</div></div>
       }
       bool IntersectP(const <a href="../Geometry_and_Transformations/Rays.html#Ray" class="code">Ray</a> &amp;r, Float tMax = Infinity) const {
           return <a href="#Cylinder::BasicIntersect" class="code">BasicIntersect</a>(r, tMax).has_value();
       }
       <a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction" class="code">SurfaceInteraction</a> <a href="#Cylinder::InteractionFromIntersection" class="code">InteractionFromIntersection</a>(
               const <a href="../Shapes/Spheres.html#QuadricIntersection" class="code">QuadricIntersection</a> &amp;isect, <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> wo, Float <a href="../Geometry_and_Transformations/Rays.html#Ray::time" class="code">time</a>) const {
           <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> pHit = isect.<a href="../Shapes/Spheres.html#QuadricIntersection::pObj" class="code">pObj</a>;
           Float <a href="../Shapes/Spheres.html#QuadricIntersection::phi" class="code">phi</a> = isect.<a href="../Shapes/Spheres.html#QuadricIntersection::phi" class="code">phi</a>;
           &lt;&lt;<span class="fragmentname"><a href="#fragment-Findparametricrepresentationofcylinderhit-0">Find parametric representation of cylinder hit</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-460" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-460"><i></i></a><div id="fragbit-460" class="collapse show"><div class="fragmentcode">              Float u = phi / <a href="#Cylinder::phiMax" class="code">phiMax</a>;
              Float v = (pHit.z - <a href="#Cylinder::zMin" class="code">zMin</a>) / (<a href="#Cylinder::zMax" class="code">zMax</a> - <a href="#Cylinder::zMin" class="code">zMin</a>);
              &lt;&lt;<span class="fragmentname"><a href="#fragment-Computecylinderdpduanddpdv-0">Compute cylinder <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.509ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2802.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential normal p slash partial-differential u</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1143" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1643" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="2230" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.307ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2715.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential normal p slash partial-differential v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1143" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1643" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="2230" y="0"></use>
</g>
</svg></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-461" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-461"><i></i></a><div id="fragbit-461" class="collapse show"><div class="fragmentcode">                 <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> dpdu(-<a href="#Cylinder::phiMax" class="code">phiMax</a> * pHit.y, <a href="#Cylinder::phiMax" class="code">phiMax</a> * pHit.x, 0);
                 <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> dpdv(0, 0, <a href="#Cylinder::zMax" class="code">zMax</a> - <a href="#Cylinder::zMin" class="code">zMin</a>);</div></div>
              &lt;&lt;<span class="fragmentname"><a href="#fragment-Computecylinderdnduanddndv-0">Compute cylinder <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.702ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2885.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential bold n Subscript slash partial-differential u</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D427" d="M615 0l-126 3l-126 -3v47h69v270c0 76 -21 97 -55 97c-63 0 -149 -49 -149 -158v-209h69v-47l-126 3l-126 -3v47h69v309c0 39 -7 39 -69 39v47l172 8v-108c26 51 79 108 175 108c100 0 154 -39 154 -144v-259h69v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D427" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1226" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1726" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="2313" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.5ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2798.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential bold n Subscript slash partial-differential v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D427" d="M615 0l-126 3l-126 -3v47h69v270c0 76 -21 97 -55 97c-63 0 -149 -49 -149 -158v-209h69v-47l-126 3l-126 -3v47h69v309c0 39 -7 39 -69 39v47l172 8v-108c26 51 79 108 175 108c100 0 154 -39 154 -144v-259h69v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D427" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1226" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1726" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="2313" y="0"></use>
</g>
</svg></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-462" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-462"><i></i></a><div id="fragbit-462" class="collapse show"><div class="fragmentcode">                 <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> d2Pduu = -phiMax * phiMax * <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(pHit.x, pHit.y, 0);
                 <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> d2Pduv(0, 0, 0), d2Pdvv(0, 0, 0);
                 &lt;&lt;<span class="fragmentname"><a href="Spheres.html#fragment-Computecoefficientsforfundamentalforms-0">Compute coefficients for fundamental forms</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-463" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-463"><i></i></a><div id="fragbit-463" class="collapse show"><div class="fragmentcode">                    Float E = <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(dpdu, dpdu), F = <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(dpdu, dpdv), G = <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(dpdv, dpdv);
                    <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> n = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(<a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(dpdu, dpdv));
                    Float e = <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(n, d2Pduu), f = <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(n, d2Pduv), g = <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(n, d2Pdvv);</div></div>
                 &lt;&lt;<span class="fragmentname"><a href="Spheres.html#fragment-Computednduanddndvfromfundamentalformcoefficients-0">Compute <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.702ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2885.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential bold n Subscript slash partial-differential u</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D427" d="M615 0l-126 3l-126 -3v47h69v270c0 76 -21 97 -55 97c-63 0 -149 -49 -149 -158v-209h69v-47l-126 3l-126 -3v47h69v309c0 39 -7 39 -69 39v47l172 8v-108c26 51 79 108 175 108c100 0 154 -39 154 -144v-259h69v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D427" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1226" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1726" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="2313" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.5ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2798.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential bold n Subscript slash partial-differential v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D427" d="M615 0l-126 3l-126 -3v47h69v270c0 76 -21 97 -55 97c-63 0 -149 -49 -149 -158v-209h69v-47l-126 3l-126 -3v47h69v309c0 39 -7 39 -69 39v47l172 8v-108c26 51 79 108 175 108c100 0 154 -39 154 -144v-259h69v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D427" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1226" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1726" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="2313" y="0"></use>
</g>
</svg> from fundamental form coefficients</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-464" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-464"><i></i></a><div id="fragbit-464" class="collapse show"><div class="fragmentcode">                    Float EGF2 = <a href="../Utilities/Mathematical_Infrastructure.html#DifferenceOfProducts" class="code">DifferenceOfProducts</a>(E, G, F, F);
                    Float invEGF2 = (EGF2 == 0) ? Float(0) : 1 / EGF2;
                    <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> dndu = <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>((f * F - e * G) * invEGF2 * dpdu + 
                                             (e * F - f * E) * invEGF2 * dpdv);
                    <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> dndv = <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>((g * F - f * G) * invEGF2 * dpdu + 
                                             (f * F - g * E) * invEGF2 * dpdv);</div></div></div></div></div></div>
           &lt;&lt;<span class="fragmentname"><a href="Managing_Rounding_Error.html#fragment-Computeerrorboundsforcylinderintersection-0">Compute error bounds for cylinder intersection</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-465" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-465"><i></i></a><div id="fragbit-465" class="collapse show"><div class="fragmentcode">              <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> pError = <a href="../Shapes/Managing_Rounding_Error.html#gamma" class="code">gamma</a>(3) * <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Abs" class="code">Abs</a>(<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(pHit.x, pHit.y, 0));</div></div>
           &lt;&lt;<span class="fragmentname"><a href="Spheres.html#fragment-ReturnmonoSurfaceInteractionforquadricintersection-0">Return <tt>SurfaceInteraction</tt> for quadric intersection</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-466" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-466"><i></i></a><div id="fragbit-466" class="collapse show"><div class="fragmentcode">              bool flipNormal = <a href="../Shapes/Spheres.html#Sphere::reverseOrientation" class="code">reverseOrientation</a> ^ <a href="../Shapes/Spheres.html#Sphere::transformSwapsHandedness" class="code">transformSwapsHandedness</a>;
              <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> woObject = (*<a href="../Shapes/Spheres.html#Sphere::objectFromRender" class="code">objectFromRender</a>)(wo);
              return (*renderFromObject)(
                  <a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction" class="code">SurfaceInteraction</a>(Point3fi(pHit, pError), <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(u, v), woObject,
                                     dpdu, dpdv, dndu, dndv, time, flipNormal));</div></div>
       }
       pstd::optional&lt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample" class="code">ShapeSample</a>&gt; Sample(<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> u) const {
           Float z = <a href="../Monte_Carlo_Integration/Sampling_Using_the_Inversion_Method.html#Lerp" class="code">Lerp</a>(u[0], <a href="#Cylinder::zMin" class="code">zMin</a>, <a href="#Cylinder::zMax" class="code">zMax</a>);
           Float <a href="../Shapes/Spheres.html#QuadricIntersection::phi" class="code">phi</a> = u[1] * <a href="#Cylinder::phiMax" class="code">phiMax</a>;
           &lt;&lt;<span class="fragmentname"><a href="#fragment-Computecylindersamplepositionmonopiandnormalmononfromzandphi-0">Compute cylinder sample position <tt>pi</tt> and normal <tt>n</tt> from <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.086ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 467.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.385ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 596.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">phi</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D719" d="M573 262c0 -134 -145 -269 -306 -274l-38 -149c-3 -14 -9 -38 -11 -40c-3 -3 -5 -4 -10 -4s-12 1 -12 11c0 3 10 41 22 88l23 94c-122 7 -192 86 -192 181c0 136 147 269 306 274l58 231c4 17 5 20 15 20c12 0 12 -10 12 -10l-3 -14l-56 -227c139 -10 192 -102 192 -181z M349 421c-149 -13 -235 -153 -235 -273c0 -100 72 -135 132 -138zM508 283c0 88 -57 134 -133 138l-103 -411c150 12 236 155 236 273Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="0" y="0"></use>
</g>
</svg></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-467" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-467"><i></i></a><div id="fragbit-467" class="collapse show"><div class="fragmentcode">              <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> pObj = <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a>(<a href="#Cylinder::radius" class="code">radius</a> * std::cos(phi), <a href="#Cylinder::radius" class="code">radius</a> * std::sin(phi), z);
              &lt;&lt;<span class="fragmentname"><a href="Managing_Rounding_Error.html#fragment-ReprojectmonopObjtocylindersurfaceandcomputemonopObjError-0">Reproject <tt>pObj</tt> to cylinder surface and compute <tt>pObjError</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-468" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-468"><i></i></a><div id="fragbit-468" class="collapse show"><div class="fragmentcode">                 Float hitRad = std::sqrt(<a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(pObj.x) + <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(pObj.y));
                 pObj.x *= <a href="#Cylinder::radius" class="code">radius</a> / hitRad;
                 pObj.y *= <a href="#Cylinder::radius" class="code">radius</a> / hitRad;
                 <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> pObjError = <a href="../Shapes/Managing_Rounding_Error.html#gamma" class="code">gamma</a>(3) * <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Abs" class="code">Abs</a>(<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(pObj.x, pObj.y, 0));</div></div>
              Point3fi pi = (*renderFromObject)(Point3fi(pObj, pObjError));
              <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> n = Normalize((*renderFromObject)(<a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(pObj.x, pObj.y, 0)));
              if (<a href="#Cylinder::reverseOrientation" class="code">reverseOrientation</a>)
                  n *= -1;</div></div>
           <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> uv(<a href="../Shapes/Spheres.html#QuadricIntersection::phi" class="code">phi</a> / <a href="#Cylinder::phiMax" class="code">phiMax</a>, (<a href="../Shapes/Spheres.html#QuadricIntersection::pObj" class="code">pObj</a>.z - <a href="#Cylinder::zMin" class="code">zMin</a>) / (<a href="#Cylinder::zMax" class="code">zMax</a> - <a href="#Cylinder::zMin" class="code">zMin</a>));
           return <a href="../Shapes/Basic_Shape_Interface.html#ShapeSample" class="code">ShapeSample</a>{<a href="../Geometry_and_Transformations/Interactions.html#Interaction" class="code">Interaction</a>(pi, n, uv), 1 / <a href="#Cylinder::Area" class="code">Area</a>()};
       }
       Float PDF(const <a href="../Geometry_and_Transformations/Interactions.html#Interaction" class="code">Interaction</a> &amp;) const { return 1 / <a href="#Cylinder::Area" class="code">Area</a>(); }
       pstd::optional&lt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample" class="code">ShapeSample</a>&gt; Sample(const <a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext" class="code">ShapeSampleContext</a> &amp;ctx, 
                                          <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> u) const {
           &lt;&lt;<span class="fragmentname"><a href="Spheres.html#fragment-Sampleshapebyareaandcomputeincidentdirectionmonowi-0">Sample shape by area and compute incident direction <tt>wi</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-469" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-469"><i></i></a><div id="fragbit-469" class="collapse show"><div class="fragmentcode">              pstd::optional&lt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample" class="code">ShapeSample</a>&gt; ss = Sample(u);
              ss-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample::intr" class="code">intr</a>.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::time" class="code">time</a> = ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::time" class="code">time</a>;
              <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> wi = ss-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample::intr" class="code">intr</a>.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::p" class="code">p</a>() - ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::p" class="code">p</a>();
              if (<a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(wi) == 0) return {};
              wi = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(wi);</div></div>
           &lt;&lt;<span class="fragmentname"><a href="Spheres.html#fragment-ConvertareasamplingPDFinmonosstosolidanglemeasure-0">Convert area sampling PDF in <tt>ss</tt> to solid angle measure</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-470" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-470"><i></i></a><div id="fragbit-470" class="collapse show"><div class="fragmentcode">              ss-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample::pdf" class="code">pdf</a> /= <a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(ss-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample::intr" class="code">intr</a>.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>, -wi) /
                         <a href="../Geometry_and_Transformations/Points.html#DistanceSquared" class="code">DistanceSquared</a>(ctx.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::p" class="code">p</a>(), ss-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample::intr" class="code">intr</a>.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::p" class="code">p</a>());
              if (<a href="../Shapes/Managing_Rounding_Error.html#IsInf" class="code">IsInf</a>(ss-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample::pdf" class="code">pdf</a>))
                  return {};</div></div>
           return ss;
       }
       Float PDF(const <a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext" class="code">ShapeSampleContext</a> &amp;ctx, <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> wi) const {
           &lt;&lt;<span class="fragmentname"><a href="Spheres.html#fragment-Intersectsampleraywithshapegeometry-0">Intersect sample ray with shape geometry</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-471" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-471"><i></i></a><div id="fragbit-471" class="collapse show"><div class="fragmentcode">              <a href="../Geometry_and_Transformations/Rays.html#Ray" class="code">Ray</a> ray = ctx.<a href="../Shapes/Managing_Rounding_Error.html#ShapeSampleContext::SpawnRay" class="code">SpawnRay</a>(wi);
              pstd::optional&lt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeIntersection" class="code">ShapeIntersection</a>&gt; isect = <a href="../Shapes/Spheres.html#Sphere::Intersect" class="code">Intersect</a>(ray);
              if (!isect) return 0;</div></div>
           &lt;&lt;<span class="fragmentname"><a href="Spheres.html#fragment-ComputePDFinsolidanglemeasurefromshapeintersectionpoint-0">Compute PDF in solid angle measure from shape intersection point</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-472" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-472"><i></i></a><div id="fragbit-472" class="collapse show"><div class="fragmentcode">              Float pdf = (1 / <a href="../Shapes/Spheres.html#Sphere::Area" class="code">Area</a>()) / (<a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(isect-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeIntersection::intr" class="code">intr</a>.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>, -wi) /
                                          <a href="../Geometry_and_Transformations/Points.html#DistanceSquared" class="code">DistanceSquared</a>(ctx.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::p" class="code">p</a>(), isect-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeIntersection::intr" class="code">intr</a>.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::p" class="code">p</a>()));
              if (<a href="../Shapes/Managing_Rounding_Error.html#IsInf" class="code">IsInf</a>(pdf)) pdf = 0;</div></div>
           return pdf;
       }</div></div>
  private:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-CylinderPrivateMembers-0">Cylinder Private Members</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-473" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-473"><i></i></a><div id="fragbit-473" class="collapse show"><div class="fragmentcode">       const <a href="../Geometry_and_Transformations/Transformations.html#Transform" class="code">Transform</a> *renderFromObject, *objectFromRender;
       bool reverseOrientation, transformSwapsHandedness;
       Float radius, zMin, zMax, phiMax;</div></div>
};</div><p>


</p>
<p>In parametric form, a cylinder is described by the following equations:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="26.979ex" height="13.509ex" style="vertical-align: -6.171ex;" viewBox="0 -3159.4 11616.1 5816.5" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">StartLayout 1st Row 1st Column phi 2nd Column equals u phi Subscript normal m normal a normal x Baseline 2nd Row 1st Column x 2nd Column equals r cosine phi 3rd Row 1st Column y 2nd Column equals r sine phi 4th Row 1st Column z 2nd Column equals z Subscript normal m normal i normal n Baseline plus v left-parenthesis z Subscript normal m normal a normal x Baseline minus z Subscript normal m normal i normal n Baseline right-parenthesis period EndLayout</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D719" d="M573 262c0 -134 -145 -269 -306 -274l-38 -149c-3 -14 -9 -38 -11 -40c-3 -3 -5 -4 -10 -4s-12 1 -12 11c0 3 10 41 22 88l23 94c-122 7 -192 86 -192 181c0 136 147 269 306 274l58 231c4 17 5 20 15 20c12 0 12 -10 12 -10l-3 -14l-56 -227c139 -10 192 -102 192 -181z M349 421c-149 -13 -235 -153 -235 -273c0 -100 72 -135 132 -138zM508 283c0 88 -57 134 -133 138l-103 -411c150 12 236 155 236 273Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6D" d="M813 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31 c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c45 0 119 -11 133 -98c17 38 61 98 145 98c58 0 91 -20 105 -37c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-61" d="M483 89c0 -81 -61 -95 -82 -95c-47 0 -74 42 -78 82c-19 -47 -65 -87 -131 -87c-63 0 -160 25 -160 106c0 44 25 96 100 130c63 30 133 33 184 36v37c0 89 -57 128 -106 128c-32 0 -81 -11 -108 -46c46 -1 51 -34 51 -46c0 -26 -18 -46 -46 -46c-26 0 -46 17 -46 47 c0 66 69 113 151 113c48 0 98 -16 137 -55c36 -37 36 -76 36 -118v-200c0 -5 4 -50 37 -50c11 0 36 6 36 64v56h25v-56zM316 140v100c-165 -6 -207 -89 -207 -144c0 -50 41 -85 90 -85c45 0 117 34 117 129Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-78" d="M516 0c-30 2 -69 3 -96 3l-108 -3v31c27 1 36 16 36 25c0 6 -13 22 -21 33l-76 100c-61 -72 -90 -105 -90 -127c0 -15 7 -28 29 -31v-31l-95 3c-26 0 -57 -1 -83 -3v31c21 0 80 2 128 60c47 57 47 59 94 119l-99 129c-47 60 -48 61 -118 61v31c27 -2 74 -3 95 -3l108 3 v-31c-20 -1 -35 -10 -35 -25c0 -6 0 -8 9 -18l78 -101l62 78c5 6 15 19 15 35s-8 29 -29 31v31c13 -1 66 -3 96 -3c26 0 56 1 82 3v-31c-47 -1 -88 -16 -119 -52c-24 -26 -62 -75 -92 -113l134 -173c23 -29 41 -31 95 -31v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45F" d="M436 377c0 -36 -28 -59 -55 -59s-38 19 -38 35c0 26 22 50 52 55c0 0 -16 12 -42 12c-43 0 -72 -26 -80 -33c-24 -22 -52 -69 -56 -82l-32 -130c-4 -18 -38 -154 -40 -158c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43l58 231c13 52 16 63 16 84 c0 38 -14 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 3 13 63 31 97c9 18 28 57 74 57c47 0 83 -32 91 -77c19 28 63 77 128 77c51 0 83 -30 83 -65Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6E" d="M535 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c58 0 91 -20 105 -37 c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="0" y="2233"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="24" y="727"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="106" y="-779"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="129" y="-2285"></use>
</g>
<g transform="translate(863,0)">
<g transform="translate(0,2233)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="1056" y="0"></use>
<g transform="translate(1795,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="0" y="0"></use>
<g transform="translate(596,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-6D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-61" x="833" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-78" x="1334" y="0"></use>
</g>
</g>
</g>
<g transform="translate(0,727)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45F" x="1056" y="0"></use>
<g transform="translate(1674,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="3180" y="0"></use>
</g>
<g transform="translate(0,-779)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45F" x="1056" y="0"></use>
<g transform="translate(1674,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-73"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="673" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="3070" y="0"></use>
</g>
<g transform="translate(0,-2285)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
<g transform="translate(1056,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
<g transform="translate(465,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-6D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-69" x="833" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-6E" x="1112" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="3023" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="4024" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="4510" y="0"></use>
<g transform="translate(4899,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
<g transform="translate(465,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-6D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-61" x="833" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-78" x="1334" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="7004" y="0"></use>
<g transform="translate(8004,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
<g transform="translate(465,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-6D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-69" x="833" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-6E" x="1112" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="9750" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="10139" y="0"></use>
</g>
</g>
</g>
</g>
</svg>
</div>
<p>

Figure&nbsp;<a href="#fig:cylinder-rendered">6.8</a> shows a rendered image of two
cylinders.  Like the sphere image, the right cylinder is a complete
cylinder, while the left one is a partial cylinder because it has a
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.677ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 2013.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">phi Subscript normal m normal a normal x</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D719" d="M573 262c0 -134 -145 -269 -306 -274l-38 -149c-3 -14 -9 -38 -11 -40c-3 -3 -5 -4 -10 -4s-12 1 -12 11c0 3 10 41 22 88l23 94c-122 7 -192 86 -192 181c0 136 147 269 306 274l58 231c4 17 5 20 15 20c12 0 12 -10 12 -10l-3 -14l-56 -227c139 -10 192 -102 192 -181z M349 421c-149 -13 -235 -153 -235 -273c0 -100 72 -135 132 -138zM508 283c0 88 -57 134 -133 138l-103 -411c150 12 236 155 236 273Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6D" d="M813 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31 c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c45 0 119 -11 133 -98c17 38 61 98 145 98c58 0 91 -20 105 -37c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-61" d="M483 89c0 -81 -61 -95 -82 -95c-47 0 -74 42 -78 82c-19 -47 -65 -87 -131 -87c-63 0 -160 25 -160 106c0 44 25 96 100 130c63 30 133 33 184 36v37c0 89 -57 128 -106 128c-32 0 -81 -11 -108 -46c46 -1 51 -34 51 -46c0 -26 -18 -46 -46 -46c-26 0 -46 17 -46 47 c0 66 69 113 151 113c48 0 98 -16 137 -55c36 -37 36 -76 36 -118v-200c0 -5 4 -50 37 -50c11 0 36 6 36 64v56h25v-56zM316 140v100c-165 -6 -207 -89 -207 -144c0 -50 41 -85 90 -85c45 0 117 34 117 129Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-78" d="M516 0c-30 2 -69 3 -96 3l-108 -3v31c27 1 36 16 36 25c0 6 -13 22 -21 33l-76 100c-61 -72 -90 -105 -90 -127c0 -15 7 -28 29 -31v-31l-95 3c-26 0 -57 -1 -83 -3v31c21 0 80 2 128 60c47 57 47 59 94 119l-99 129c-47 60 -48 61 -118 61v31c27 -2 74 -3 95 -3l108 3 v-31c-20 -1 -35 -10 -35 -25c0 -6 0 -8 9 -18l78 -101l62 78c5 6 15 19 15 35s-8 29 -29 31v31c13 -1 66 -3 96 -3c26 0 56 1 82 3v-31c-47 -1 -88 -16 -119 -52c-24 -26 -62 -75 -92 -113l134 -173c23 -29 41 -31 95 -31v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="0" y="0"></use>
<g transform="translate(596,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-6D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-61" x="833" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-78" x="1334" y="0"></use>
</g>
</g>
</svg> value less than&nbsp;<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.487ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1071 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">2 pi</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D70B" d="M567 407c0 -34 -36 -34 -49 -34h-114c-11 -52 -18 -106 -18 -159c0 -28 0 -93 29 -165c6 -14 6 -16 6 -22c0 -20 -21 -38 -41 -38c-15 0 -26 6 -36 50c-8 34 -8 61 -8 76c0 67 9 110 42 258h-113l-56 -221c-13 -50 -13 -52 -27 -98c-12 -37 -20 -65 -50 -65 c-13 0 -29 8 -29 27c0 7 0 9 8 24c42 91 96 212 128 333h-57c-20 0 -78 0 -127 -77c-6 -8 -8 -12 -16 -12c-12 0 -12 10 -12 10c0 5 26 51 61 90c44 47 82 47 104 47h335c19 0 40 0 40 -24Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D70B" x="500" y="0"></use>
</g>
</svg>.

</p>
<p></p>
<span class="anchor" id="fig:cylinder-rendered"></span><div class="card outerfigure"><div class="card-body figure"><p>


</p>
<div class="figure-row">
<img src="cylinders.png" style="max-width: 100%; height: auto;" width=1500 height=900>
</div>
<p>

</p>
<figcaption class="caption">Figure 6.8: Two Cylinders. <span class="legend"> A partial cylinder is
on the left, and a complete cylinder is on the right. </span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>Similar to the <a href="../Shapes/Spheres.html#Sphere"><tt>Sphere</tt></a> constructor, the <a href="#Cylinder"><tt>Cylinder</tt></a> constructor
takes transformations that define its object space and the parameters that
define the cylinder itself.  Its constructor just initializes the
corresponding member variables, so we will not include it here.

</p>
<p></p>
<span class="anchor" id="fragment-CylinderPublicMethods-0"></span><div class="fragmentname">&lt;&lt;Cylinder Public Methods&gt;&gt;=&nbsp;<a href="#fragment-CylinderPublicMethods-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">Cylinder(const <a href="../Geometry_and_Transformations/Transformations.html#Transform" class="code">Transform</a> *renderFromObj, const <a href="../Geometry_and_Transformations/Transformations.html#Transform" class="code">Transform</a> *objFromRender,
    bool reverseOrientation, Float radius, Float zMin, Float zMax,
    Float phiMax);</div><p>


</p>
<p>

</p>
<p></p>
<span class="anchor" id="fragment-CylinderPrivateMembers-0"></span><div class="fragmentname">&lt;&lt;Cylinder Private Members&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">const <a href="../Geometry_and_Transformations/Transformations.html#Transform" class="code">Transform</a> *<span class="anchor" id="Cylinder::renderFromObject"></span>renderFromObject, *<span class="anchor" id="Cylinder::objectFromRender"></span>objectFromRender;
bool <span class="anchor" id="Cylinder::reverseOrientation"></span>reverseOrientation, <span class="anchor" id="Cylinder::transformSwapsHandedness"></span>transformSwapsHandedness;
Float <span class="anchor" id="Cylinder::radius"></span>radius, <span class="anchor" id="Cylinder::zMin"></span>zMin, <span class="anchor" id="Cylinder::zMax"></span>zMax, <span class="anchor" id="Cylinder::phiMax"></span>phiMax;</div><p>


</p>
<p>

</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#AreaandBounding"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="AreaandBounding"></span><h3>6.3.1  Area and Bounding</h3><p>


</p>
<p>A cylinder is a rolled-up rectangle.  If you unroll the rectangle, its
height is <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.266ex" height="2.343ex" style="vertical-align: -0.671ex;" viewBox="0 -719.6 4850.7 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z Subscript normal m normal a normal x Baseline minus z Subscript normal m normal i normal n</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6D" d="M813 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31 c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c45 0 119 -11 133 -98c17 38 61 98 145 98c58 0 91 -20 105 -37c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-61" d="M483 89c0 -81 -61 -95 -82 -95c-47 0 -74 42 -78 82c-19 -47 -65 -87 -131 -87c-63 0 -160 25 -160 106c0 44 25 96 100 130c63 30 133 33 184 36v37c0 89 -57 128 -106 128c-32 0 -81 -11 -108 -46c46 -1 51 -34 51 -46c0 -26 -18 -46 -46 -46c-26 0 -46 17 -46 47 c0 66 69 113 151 113c48 0 98 -16 137 -55c36 -37 36 -76 36 -118v-200c0 -5 4 -50 37 -50c11 0 36 6 36 64v56h25v-56zM316 140v100c-165 -6 -207 -89 -207 -144c0 -50 41 -85 90 -85c45 0 117 34 117 129Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-78" d="M516 0c-30 2 -69 3 -96 3l-108 -3v31c27 1 36 16 36 25c0 6 -13 22 -21 33l-76 100c-61 -72 -90 -105 -90 -127c0 -15 7 -28 29 -31v-31l-95 3c-26 0 -57 -1 -83 -3v31c21 0 80 2 128 60c47 57 47 59 94 119l-99 129c-47 60 -48 61 -118 61v31c27 -2 74 -3 95 -3l108 3 v-31c-20 -1 -35 -10 -35 -25c0 -6 0 -8 9 -18l78 -101l62 78c5 6 15 19 15 35s-8 29 -29 31v31c13 -1 66 -3 96 -3c26 0 56 1 82 3v-31c-47 -1 -88 -16 -119 -52c-24 -26 -62 -75 -92 -113l134 -173c23 -29 41 -31 95 -31v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6E" d="M535 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c58 0 91 -20 105 -37 c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
<g transform="translate(465,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-6D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-61" x="833" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-78" x="1334" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="2104" y="0"></use>
<g transform="translate(3105,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
<g transform="translate(465,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-6D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-69" x="833" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-6E" x="1112" y="0"></use>
</g>
</g>
</g>
</svg>, and its width is <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.725ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 2465 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">r phi Subscript normal m normal a normal x</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45F" d="M436 377c0 -36 -28 -59 -55 -59s-38 19 -38 35c0 26 22 50 52 55c0 0 -16 12 -42 12c-43 0 -72 -26 -80 -33c-24 -22 -52 -69 -56 -82l-32 -130c-4 -18 -38 -154 -40 -158c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43l58 231c13 52 16 63 16 84 c0 38 -14 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 3 13 63 31 97c9 18 28 57 74 57c47 0 83 -32 91 -77c19 28 63 77 128 77c51 0 83 -30 83 -65Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D719" d="M573 262c0 -134 -145 -269 -306 -274l-38 -149c-3 -14 -9 -38 -11 -40c-3 -3 -5 -4 -10 -4s-12 1 -12 11c0 3 10 41 22 88l23 94c-122 7 -192 86 -192 181c0 136 147 269 306 274l58 231c4 17 5 20 15 20c12 0 12 -10 12 -10l-3 -14l-56 -227c139 -10 192 -102 192 -181z M349 421c-149 -13 -235 -153 -235 -273c0 -100 72 -135 132 -138zM508 283c0 88 -57 134 -133 138l-103 -411c150 12 236 155 236 273Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6D" d="M813 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31 c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c45 0 119 -11 133 -98c17 38 61 98 145 98c58 0 91 -20 105 -37c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-61" d="M483 89c0 -81 -61 -95 -82 -95c-47 0 -74 42 -78 82c-19 -47 -65 -87 -131 -87c-63 0 -160 25 -160 106c0 44 25 96 100 130c63 30 133 33 184 36v37c0 89 -57 128 -106 128c-32 0 -81 -11 -108 -46c46 -1 51 -34 51 -46c0 -26 -18 -46 -46 -46c-26 0 -46 17 -46 47 c0 66 69 113 151 113c48 0 98 -16 137 -55c36 -37 36 -76 36 -118v-200c0 -5 4 -50 37 -50c11 0 36 6 36 64v56h25v-56zM316 140v100c-165 -6 -207 -89 -207 -144c0 -50 41 -85 90 -85c45 0 117 34 117 129Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-78" d="M516 0c-30 2 -69 3 -96 3l-108 -3v31c27 1 36 16 36 25c0 6 -13 22 -21 33l-76 100c-61 -72 -90 -105 -90 -127c0 -15 7 -28 29 -31v-31l-95 3c-26 0 -57 -1 -83 -3v31c21 0 80 2 128 60c47 57 47 59 94 119l-99 129c-47 60 -48 61 -118 61v31c27 -2 74 -3 95 -3l108 3 v-31c-20 -1 -35 -10 -35 -25c0 -6 0 -8 9 -18l78 -101l62 78c5 6 15 19 15 35s-8 29 -29 31v31c13 -1 66 -3 96 -3c26 0 56 1 82 3v-31c-47 -1 -88 -16 -119 -52c-24 -26 -62 -75 -92 -113l134 -173c23 -29 41 -31 95 -31v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45F" x="0" y="0"></use>
<g transform="translate(451,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="0" y="0"></use>
<g transform="translate(596,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-6D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-61" x="833" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-78" x="1334" y="0"></use>
</g>
</g>
</g>
</svg>:

</p>
<p></p>
<span class="anchor" id="fragment-CylinderPublicMethods-1"></span><div class="fragmentname">&lt;&lt;Cylinder Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-CylinderPublicMethods-0"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-CylinderPublicMethods-2"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">Float <span class="anchor" id="Cylinder::Area"></span>Area() const { return (<a href="#Cylinder::zMax" class="code">zMax</a> - <a href="#Cylinder::zMin" class="code">zMin</a>) * <a href="#Cylinder::radius" class="code">radius</a> * <a href="#Cylinder::phiMax" class="code">phiMax</a>; }</div><p>


</p>
<p>As was done with the sphere, the cylinder&rsquo;s spatial bounding method
computes a conservative bounding box using the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.086ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 467.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
</g>
</svg> range but does not take
into account the maximum <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.385ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 596.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">phi</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D719" d="M573 262c0 -134 -145 -269 -306 -274l-38 -149c-3 -14 -9 -38 -11 -40c-3 -3 -5 -4 -10 -4s-12 1 -12 11c0 3 10 41 22 88l23 94c-122 7 -192 86 -192 181c0 136 147 269 306 274l58 231c4 17 5 20 15 20c12 0 12 -10 12 -10l-3 -14l-56 -227c139 -10 192 -102 192 -181z M349 421c-149 -13 -235 -153 -235 -273c0 -100 72 -135 132 -138zM508 283c0 88 -57 134 -133 138l-103 -411c150 12 236 155 236 273Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="0" y="0"></use>
</g>
</svg>.

</p>
<p></p>
<span class="anchor" id="fragment-CylinderMethodDefinitions-0"></span><div class="fragmentname">&lt;&lt;Cylinder Method Definitions&gt;&gt;=&nbsp;</div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Bounding_Boxes.html#Bounds3f" class="code">Bounds3f</a> <span class="anchor" id="Cylinder::Bounds"></span>Cylinder::Bounds() const {
    return (*<a href="#Cylinder::renderFromObject" class="code">renderFromObject</a>)(<a href="../Geometry_and_Transformations/Bounding_Boxes.html#Bounds3f" class="code">Bounds3f</a>({-<a href="#Cylinder::radius" class="code">radius</a>, -<a href="#Cylinder::radius" class="code">radius</a>, <a href="#Cylinder::zMin" class="code">zMin</a>},
                                        { <a href="#Cylinder::radius" class="code">radius</a>,  <a href="#Cylinder::radius" class="code">radius</a>, <a href="#Cylinder::zMax" class="code">zMax</a>}));
}</div><p>


</p>
<p>Its surface normal bounding function is conservative in two ways: not only does it
not account for <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.262ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 4418.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">phi Subscript normal m normal a normal x Baseline less-than 2 pi</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D719" d="M573 262c0 -134 -145 -269 -306 -274l-38 -149c-3 -14 -9 -38 -11 -40c-3 -3 -5 -4 -10 -4s-12 1 -12 11c0 3 10 41 22 88l23 94c-122 7 -192 86 -192 181c0 136 147 269 306 274l58 231c4 17 5 20 15 20c12 0 12 -10 12 -10l-3 -14l-56 -227c139 -10 192 -102 192 -181z M349 421c-149 -13 -235 -153 -235 -273c0 -100 72 -135 132 -138zM508 283c0 88 -57 134 -133 138l-103 -411c150 12 236 155 236 273Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6D" d="M813 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31 c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c45 0 119 -11 133 -98c17 38 61 98 145 98c58 0 91 -20 105 -37c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-61" d="M483 89c0 -81 -61 -95 -82 -95c-47 0 -74 42 -78 82c-19 -47 -65 -87 -131 -87c-63 0 -160 25 -160 106c0 44 25 96 100 130c63 30 133 33 184 36v37c0 89 -57 128 -106 128c-32 0 -81 -11 -108 -46c46 -1 51 -34 51 -46c0 -26 -18 -46 -46 -46c-26 0 -46 17 -46 47 c0 66 69 113 151 113c48 0 98 -16 137 -55c36 -37 36 -76 36 -118v-200c0 -5 4 -50 37 -50c11 0 36 6 36 64v56h25v-56zM316 140v100c-165 -6 -207 -89 -207 -144c0 -50 41 -85 90 -85c45 0 117 34 117 129Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-78" d="M516 0c-30 2 -69 3 -96 3l-108 -3v31c27 1 36 16 36 25c0 6 -13 22 -21 33l-76 100c-61 -72 -90 -105 -90 -127c0 -15 7 -28 29 -31v-31l-95 3c-26 0 -57 -1 -83 -3v31c21 0 80 2 128 60c47 57 47 59 94 119l-99 129c-47 60 -48 61 -118 61v31c27 -2 74 -3 95 -3l108 3 v-31c-20 -1 -35 -10 -35 -25c0 -6 0 -8 9 -18l78 -101l62 78c5 6 15 19 15 35s-8 29 -29 31v31c13 -1 66 -3 96 -3c26 0 56 1 82 3v-31c-47 -1 -88 -16 -119 -52c-24 -26 -62 -75 -92 -113l134 -173c23 -29 41 -31 95 -31v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3C" d="M689 -9c24 -11 7 -47 -18 -36l-581 275c-17 8 -17 32 0 40l581 275c25 11 42 -25 18 -36l-548 -259Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D70B" d="M567 407c0 -34 -36 -34 -49 -34h-114c-11 -52 -18 -106 -18 -159c0 -28 0 -93 29 -165c6 -14 6 -16 6 -22c0 -20 -21 -38 -41 -38c-15 0 -26 6 -36 50c-8 34 -8 61 -8 76c0 67 9 110 42 258h-113l-56 -221c-13 -50 -13 -52 -27 -98c-12 -37 -20 -65 -50 -65 c-13 0 -29 8 -29 27c0 7 0 9 8 24c42 91 96 212 128 333h-57c-20 0 -78 0 -127 -77c-6 -8 -8 -12 -16 -12c-12 0 -12 10 -12 10c0 5 26 51 61 90c44 47 82 47 104 47h335c19 0 40 0 40 -24Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="0" y="0"></use>
<g transform="translate(596,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-6D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-61" x="833" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-78" x="1334" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-3C" x="2291" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="3347" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D70B" x="3848" y="0"></use>
</g>
</svg>, but the actual set of normals of
a cylinder can be described by a circle on the sphere of all directions.
However, <a href="../Geometry_and_Transformations/Spherical_Geometry.html#DirectionCone"><tt>DirectionCone</tt></a>&rsquo;s representation is not able to bound such a
distribution more tightly than with the entire sphere of directions, and so
that is the bound that is returned.

</p>
<p></p>
<span class="anchor" id="fragment-CylinderPublicMethods-2"></span><div class="fragmentname">&lt;&lt;Cylinder Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-CylinderPublicMethods-1"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-CylinderPublicMethods-3"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Spherical_Geometry.html#DirectionCone" class="code">DirectionCone</a> <span class="anchor" id="Cylinder::NormalBounds"></span>NormalBounds() const { return <a href="../Geometry_and_Transformations/Spherical_Geometry.html#DirectionCone" class="code">DirectionCone</a>::EntireSphere(); }</div><p>


</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#IntersectionTests"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="sec:cylinder-intersection"></span><span id="IntersectionTests"></span><h3>6.3.2  Intersection Tests</h3><p>



</p>
<p>Also similar to the sphere (and for similar reasons), <tt>Cylinder</tt>
provides a <tt>BasicIntersect()</tt> method that returns a
<a href="../Shapes/Spheres.html#QuadricIntersection"><tt>QuadricIntersection</tt></a> as well as an <tt>InteractionFromIntersection()</tt>
method that converts that to a full <a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction"><tt>SurfaceInteraction</tt></a>.  Given these,
the <tt>Intersect()</tt> method is again a simple composition of them.  (If
<tt>pbrt</tt> used virtual functions, a design alternative would be to have a
<tt>QuadricShape</tt> class that provided a default <tt>Intersect()</tt> method
and left <tt>BasicIntersect()</tt> and <tt>InteractionFromIntersection()</tt> as
pure virtual functions for subclasses to implement.)

</p>
<p></p>
<span class="anchor" id="fragment-CylinderPublicMethods-3"></span><div class="fragmentname">&lt;&lt;Cylinder Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-CylinderPublicMethods-2"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-CylinderPublicMethods-4"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">pstd::optional&lt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeIntersection" class="code">ShapeIntersection</a>&gt; <span class="anchor" id="Cylinder::Intersect"></span>Intersect(const <a href="../Geometry_and_Transformations/Rays.html#Ray" class="code">Ray</a> &amp;ray,
                                            Float tMax = Infinity) const {
    pstd::optional&lt;<a href="../Shapes/Spheres.html#QuadricIntersection" class="code">QuadricIntersection</a>&gt; isect = <a href="#Cylinder::BasicIntersect" class="code">BasicIntersect</a>(ray, tMax);
    if (!isect) return {};
    <a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction" class="code">SurfaceInteraction</a> intr =
        <a href="#Cylinder::InteractionFromIntersection" class="code">InteractionFromIntersection</a>(*isect, -ray.<a href="../Geometry_and_Transformations/Rays.html#Ray::d" class="code">d</a>, ray.<a href="../Geometry_and_Transformations/Rays.html#Ray::time" class="code">time</a>);
    return <a href="../Shapes/Basic_Shape_Interface.html#ShapeIntersection" class="code">ShapeIntersection</a>{intr, isect-&gt;<a href="../Shapes/Spheres.html#QuadricIntersection::tHit" class="code">tHit</a>};
}</div><p>


</p>
<p>The form of the <tt>BasicIntersect()</tt> method also parallels the sphere&rsquo;s,
computing appropriate quadratic coefficients, solving the quadratic
equation, and then handling the various cases for partial cylinders.
A number of fragments can be reused from the <a href="../Shapes/Spheres.html#Sphere"><tt>Sphere</tt></a>&rsquo;s implementation.

</p>
<p></p>
<span class="anchor" id="fragment-CylinderPublicMethods-4"></span><div class="fragmentname">&lt;&lt;Cylinder Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-CylinderPublicMethods-3"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-CylinderPublicMethods-5"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">pstd::optional&lt;<a href="../Shapes/Spheres.html#QuadricIntersection" class="code">QuadricIntersection</a>&gt; <span class="anchor" id="Cylinder::BasicIntersect"></span>BasicIntersect(const <a href="../Geometry_and_Transformations/Rays.html#Ray" class="code">Ray</a> &amp;r,
                                                   Float tMax) const {
    Float phi;
    <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> pHit;
    &lt;&lt;<span class="fragmentname"><a href="Spheres.html#fragment-TransformmonoRayoriginanddirectiontoobjectspace-0">Transform <tt>Ray</tt> origin and direction to object space</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-474" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-474"><i></i></a><div id="fragbit-474" class="collapse show"><div class="fragmentcode">       <a href="../Utilities/Mathematical_Infrastructure.html#Point3fi" class="code">Point3fi</a> oi = (*<a href="../Shapes/Spheres.html#Sphere::objectFromRender" class="code">objectFromRender</a>)(<a href="../Utilities/Mathematical_Infrastructure.html#Point3fi" class="code">Point3fi</a>(r.<a href="../Geometry_and_Transformations/Rays.html#Ray::o" class="code">o</a>));
       <a href="../Utilities/Mathematical_Infrastructure.html#Vector3fi" class="code">Vector3fi</a> di = (*<a href="../Shapes/Spheres.html#Sphere::objectFromRender" class="code">objectFromRender</a>)(<a href="../Utilities/Mathematical_Infrastructure.html#Vector3fi" class="code">Vector3fi</a>(r.<a href="../Geometry_and_Transformations/Rays.html#Ray::d" class="code">d</a>));</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Solvequadraticequationtofindcylindermonot0andmonot1values-0">Solve quadratic equation to find cylinder <tt>t0</tt> and <tt>t1</tt> values</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-475" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-475"><i></i></a><div id="fragbit-475" class="collapse show"><div class="fragmentcode">       <a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a> t0, t1;
       &lt;&lt;<span class="fragmentname"><a href="#fragment-Computecylinderquadraticcoefficients-0">Compute cylinder quadratic coefficients</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-476" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-476"><i></i></a><div id="fragbit-476" class="collapse show"><div class="fragmentcode">          <a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a> a = <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(di.x) + <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(di.y);
          <a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a> b = 2 * (di.x * oi.x + di.y * oi.y);
          <a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a> c = <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(oi.x) + <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(oi.y) - <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(<a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a>(radius));</div></div>
       &lt;&lt;<span class="fragmentname"><a href="Managing_Rounding_Error.html#fragment-Computecylinderquadraticdiscriminantmonodiscrim-0">Compute cylinder quadratic discriminant <tt>discrim</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-477" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-477"><i></i></a><div id="fragbit-477" class="collapse show"><div class="fragmentcode">          <a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a> f = b / (2 * a);
          <a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a> vx = oi.x - f * di.x, vy = oi.y - f * di.y;
          <a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a> length = <a href="../Utilities/Mathematical_Infrastructure.html#Interval::Sqrt" class="code">Sqrt</a>(<a href="../Utilities/Mathematical_Infrastructure.html#Interval::Sqr" class="code">Sqr</a>(vx) + <a href="../Utilities/Mathematical_Infrastructure.html#Interval::Sqr" class="code">Sqr</a>(vy));
          <a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a> discrim = 4 * a * (<a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a>(radius) + length) *
                                     (<a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a>(radius) - length);
          if (discrim.<a href="../Utilities/Mathematical_Infrastructure.html#Interval::LowerBound" class="code">LowerBound</a>() &lt; 0)
              return {};</div></div>
       &lt;&lt;<span class="fragmentname"><a href="Spheres.html#fragment-Computequadratictvalues-0">Compute quadratic <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="2.009ex" style="vertical-align: -0.338ex;" viewBox="0 -719.6 361.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">t</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="0" y="0"></use>
</g>
</svg> values</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-478" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-478"><i></i></a><div id="fragbit-478" class="collapse show"><div class="fragmentcode">          <a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a> rootDiscrim = <a href="../Utilities/Mathematical_Infrastructure.html#Interval::Sqrt" class="code">Sqrt</a>(discrim);
          <a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a> q;
          if ((Float)b &lt; 0) q = -.5f * (b - rootDiscrim);
          else              q = -.5f * (b + rootDiscrim);
          t0 = q / a;
          t1 = c / q;
          &lt;&lt;<span class="fragmentname"><a href="Spheres.html#fragment-Swapquadratictvaluessothatmonot0isthelesser-0">Swap quadratic <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="2.009ex" style="vertical-align: -0.338ex;" viewBox="0 -719.6 361.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">t</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="0" y="0"></use>
</g>
</svg> values so that <tt>t0</tt> is the lesser</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-479" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-479"><i></i></a><div id="fragbit-479" class="collapse show"><div class="fragmentcode">             if (t0.<a href="../Utilities/Mathematical_Infrastructure.html#Interval::LowerBound" class="code">LowerBound</a>() &gt; t1.<a href="../Utilities/Mathematical_Infrastructure.html#Interval::LowerBound" class="code">LowerBound</a>())
                 pstd::swap(t0, t1);</div></div></div></div></div></div>
    &lt;&lt;<span class="fragmentname"><a href="Spheres.html#fragment-Checkquadricshapemonot0andmonot1fornearestintersection-0">Check quadric shape <tt>t0</tt> and <tt>t1</tt> for nearest intersection</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-480" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-480"><i></i></a><div id="fragbit-480" class="collapse show"><div class="fragmentcode">       if (t0.<a href="../Utilities/Mathematical_Infrastructure.html#Interval::UpperBound" class="code">UpperBound</a>() &gt; tMax || t1.<a href="../Utilities/Mathematical_Infrastructure.html#Interval::LowerBound" class="code">LowerBound</a>() &lt;= 0)
           return {};
       <a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a> tShapeHit = t0;
       if (tShapeHit.<a href="../Utilities/Mathematical_Infrastructure.html#Interval::LowerBound" class="code">LowerBound</a>() &lt;= 0) {
           tShapeHit = t1;
           if (tShapeHit.<a href="../Utilities/Mathematical_Infrastructure.html#Interval::UpperBound" class="code">UpperBound</a>() &gt; tMax)
               return {};
       }</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Computecylinderhitpointandphi-0">Compute cylinder hit point and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.385ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 596.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">phi</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D719" d="M573 262c0 -134 -145 -269 -306 -274l-38 -149c-3 -14 -9 -38 -11 -40c-3 -3 -5 -4 -10 -4s-12 1 -12 11c0 3 10 41 22 88l23 94c-122 7 -192 86 -192 181c0 136 147 269 306 274l58 231c4 17 5 20 15 20c12 0 12 -10 12 -10l-3 -14l-56 -227c139 -10 192 -102 192 -181z M349 421c-149 -13 -235 -153 -235 -273c0 -100 72 -135 132 -138zM508 283c0 88 -57 134 -133 138l-103 -411c150 12 236 155 236 273Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="0" y="0"></use>
</g>
</svg></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-481" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-481"><i></i></a><div id="fragbit-481" class="collapse show"><div class="fragmentcode">       pHit = <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a>(oi) + (Float)tShapeHit * <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(di);
       &lt;&lt;<span class="fragmentname"><a href="Managing_Rounding_Error.html#fragment-Refinecylinderintersectionpoint-0">Refine cylinder intersection point</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-482" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-482"><i></i></a><div id="fragbit-482" class="collapse show"><div class="fragmentcode">          Float hitRad = std::sqrt(<a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(pHit.x) + <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(pHit.y));
          pHit.x *= <a href="#Cylinder::radius" class="code">radius</a> / hitRad;
          pHit.y *= <a href="#Cylinder::radius" class="code">radius</a> / hitRad;</div></div>
       phi = std::atan2(pHit.y, pHit.x);
       if (phi &lt; 0) phi += 2 * <a href="../Utilities/Mathematical_Infrastructure.html#Pi" class="code">Pi</a>;</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Testcylinderintersectionagainstclippingparameters-0">Test cylinder intersection against clipping parameters</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-483" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-483"><i></i></a><div id="fragbit-483" class="collapse show"><div class="fragmentcode">       if (pHit.z &lt; <a href="#Cylinder::zMin" class="code">zMin</a> || pHit.z &gt; <a href="#Cylinder::zMax" class="code">zMax</a> || phi &gt; <a href="#Cylinder::phiMax" class="code">phiMax</a>) {
           if (tShapeHit == t1)
               return {};
           tShapeHit = t1;
           if (t1.<a href="../Utilities/Mathematical_Infrastructure.html#Interval::UpperBound" class="code">UpperBound</a>() &gt; tMax)
               return {};
           &lt;&lt;<span class="fragmentname"><a href="#fragment-Computecylinderhitpointandphi-0">Compute cylinder hit point and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.385ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 596.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">phi</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D719" d="M573 262c0 -134 -145 -269 -306 -274l-38 -149c-3 -14 -9 -38 -11 -40c-3 -3 -5 -4 -10 -4s-12 1 -12 11c0 3 10 41 22 88l23 94c-122 7 -192 86 -192 181c0 136 147 269 306 274l58 231c4 17 5 20 15 20c12 0 12 -10 12 -10l-3 -14l-56 -227c139 -10 192 -102 192 -181z M349 421c-149 -13 -235 -153 -235 -273c0 -100 72 -135 132 -138zM508 283c0 88 -57 134 -133 138l-103 -411c150 12 236 155 236 273Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="0" y="0"></use>
</g>
</svg></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-484" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-484"><i></i></a><div id="fragbit-484" class="collapse show"><div class="fragmentcode">              pHit = <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a>(oi) + (Float)tShapeHit * <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(di);
              &lt;&lt;<span class="fragmentname"><a href="Managing_Rounding_Error.html#fragment-Refinecylinderintersectionpoint-0">Refine cylinder intersection point</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-485" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-485"><i></i></a><div id="fragbit-485" class="collapse show"><div class="fragmentcode">                 Float hitRad = std::sqrt(<a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(pHit.x) + <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(pHit.y));
                 pHit.x *= <a href="#Cylinder::radius" class="code">radius</a> / hitRad;
                 pHit.y *= <a href="#Cylinder::radius" class="code">radius</a> / hitRad;</div></div>
              phi = std::atan2(pHit.y, pHit.x);
              if (phi &lt; 0) phi += 2 * <a href="../Utilities/Mathematical_Infrastructure.html#Pi" class="code">Pi</a>;</div></div>
           if (pHit.z &lt; <a href="#Cylinder::zMin" class="code">zMin</a> || pHit.z &gt; <a href="#Cylinder::zMax" class="code">zMax</a> || phi &gt; <a href="#Cylinder::phiMax" class="code">phiMax</a>)
               return {};
       }</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-ReturnmonoQuadricIntersectionforcylinderintersection-0">Return <tt>QuadricIntersection</tt> for cylinder intersection</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-486" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-486"><i></i></a><div id="fragbit-486" class="collapse show"><div class="fragmentcode">       return <a href="../Shapes/Spheres.html#QuadricIntersection" class="code">QuadricIntersection</a>{Float(tShapeHit), pHit, phi};</div></div>
}</div><p>


</p>
<p>As before, the fragment that computes the quadratic
discriminant, &lt;&lt;<span class="fragmentname"><a href="Managing_Rounding_Error.html#fragment-Computecylinderquadraticdiscriminantmonodiscrim-0">Compute cylinder quadratic discriminant
<tt>discrim</tt></a></span>&gt;&gt;, is defined in
Section&nbsp;<a href="../Shapes/Managing_Rounding_Error.html#sec:accurate-quadratic-discriminants">6.8.3</a> after topics related to
floating-point accuracy have been discussed.

</p>
<p></p>
<span class="anchor" id="fragment-Solvequadraticequationtofindcylindermonot0andmonot1values-0"></span><div class="fragmentname">&lt;&lt;Solve quadratic equation to find cylinder <tt>t0</tt> and <tt>t1</tt> values&gt;&gt;=&nbsp;</div>
<div class="fragmentcode"><a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a> t0, t1;
&lt;&lt;<span class="fragmentname"><a href="#fragment-Computecylinderquadraticcoefficients-0">Compute cylinder quadratic coefficients</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-487" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-487"><i></i></a><div id="fragbit-487" class="collapse show"><div class="fragmentcode">   <a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a> a = <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(di.x) + <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(di.y);
   <a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a> b = 2 * (di.x * oi.x + di.y * oi.y);
   <a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a> c = <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(oi.x) + <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(oi.y) - <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(<a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a>(radius));</div></div>
&lt;&lt;<span class="fragmentname"><a href="Managing_Rounding_Error.html#fragment-Computecylinderquadraticdiscriminantmonodiscrim-0">Compute cylinder quadratic discriminant <tt>discrim</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-488" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-488"><i></i></a><div id="fragbit-488" class="collapse show"><div class="fragmentcode">   <a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a> f = b / (2 * a);
   <a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a> vx = oi.x - f * di.x, vy = oi.y - f * di.y;
   <a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a> length = <a href="../Utilities/Mathematical_Infrastructure.html#Interval::Sqrt" class="code">Sqrt</a>(<a href="../Utilities/Mathematical_Infrastructure.html#Interval::Sqr" class="code">Sqr</a>(vx) + <a href="../Utilities/Mathematical_Infrastructure.html#Interval::Sqr" class="code">Sqr</a>(vy));
   <a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a> discrim = 4 * a * (<a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a>(radius) + length) *
                              (<a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a>(radius) - length);
   if (discrim.<a href="../Utilities/Mathematical_Infrastructure.html#Interval::LowerBound" class="code">LowerBound</a>() &lt; 0)
       return {};</div></div>
&lt;&lt;<span class="fragmentname"><a href="Spheres.html#fragment-Computequadratictvalues-0">Compute quadratic <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="2.009ex" style="vertical-align: -0.338ex;" viewBox="0 -719.6 361.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">t</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="0" y="0"></use>
</g>
</svg> values</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-489" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-489"><i></i></a><div id="fragbit-489" class="collapse show"><div class="fragmentcode">   <a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a> rootDiscrim = <a href="../Utilities/Mathematical_Infrastructure.html#Interval::Sqrt" class="code">Sqrt</a>(discrim);
   <a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a> q;
   if ((Float)b &lt; 0) q = -.5f * (b - rootDiscrim);
   else              q = -.5f * (b + rootDiscrim);
   t0 = q / a;
   t1 = c / q;
   &lt;&lt;<span class="fragmentname"><a href="Spheres.html#fragment-Swapquadratictvaluessothatmonot0isthelesser-0">Swap quadratic <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="2.009ex" style="vertical-align: -0.338ex;" viewBox="0 -719.6 361.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">t</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="0" y="0"></use>
</g>
</svg> values so that <tt>t0</tt> is the lesser</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-490" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-490"><i></i></a><div id="fragbit-490" class="collapse show"><div class="fragmentcode">      if (t0.<a href="../Utilities/Mathematical_Infrastructure.html#Interval::LowerBound" class="code">LowerBound</a>() &gt; t1.<a href="../Utilities/Mathematical_Infrastructure.html#Interval::LowerBound" class="code">LowerBound</a>())
          pstd::swap(t0, t1);</div></div></div></div></div><p>


</p>
<p>As with spheres, the ray&ndash;cylinder intersection formula can be found by substituting the ray
equation into the cylinder&rsquo;s implicit equation.  The implicit equation for
an infinitely long cylinder centered on
the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.086ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 467.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
</g>
</svg> axis with radius <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.049ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 451.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">r</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45F" d="M436 377c0 -36 -28 -59 -55 -59s-38 19 -38 35c0 26 22 50 52 55c0 0 -16 12 -42 12c-43 0 -72 -26 -80 -33c-24 -22 -52 -69 -56 -82l-32 -130c-4 -18 -38 -154 -40 -158c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43l58 231c13 52 16 63 16 84 c0 38 -14 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 3 13 63 31 97c9 18 28 57 74 57c47 0 83 -32 91 -77c19 28 63 77 128 77c51 0 83 -30 83 -65Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45F" x="0" y="0"></use>
</g>
</svg>&nbsp;is
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="17.269ex" height="3.009ex" style="vertical-align: -0.671ex;" viewBox="0 -1006.6 7435.2 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x squared plus y squared minus r squared equals 0 period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45F" d="M436 377c0 -36 -28 -59 -55 -59s-38 19 -38 35c0 26 22 50 52 55c0 0 -16 12 -42 12c-43 0 -72 -26 -80 -33c-24 -22 -52 -69 -56 -82l-32 -130c-4 -18 -38 -154 -40 -158c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43l58 231c13 52 16 63 16 84 c0 38 -14 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 3 13 63 31 97c9 18 28 57 74 57c47 0 83 -32 91 -77c19 28 63 77 128 77c51 0 83 -30 83 -65Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="809" y="583"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="1248" y="0"></use>
<g transform="translate(2249,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="693" y="583"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="3415" y="0"></use>
<g transform="translate(4416,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="638" y="583"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="5599" y="0"></use>
<g transform="translate(6656,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
</g>
</g>
</svg>
</div>
<p>

Substituting the ray equation, Equation (<a href="../Geometry_and_Transformations/Rays.html#eq:ray">3.4</a>), we have
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="31.492ex" height="3.509ex" style="vertical-align: -1.005ex;" viewBox="0 -1078.4 13558.9 1510.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis normal o Subscript x Baseline plus t bold d Subscript x Baseline right-parenthesis squared plus left-parenthesis normal o Subscript y Baseline plus t bold d Subscript y Baseline right-parenthesis squared equals r squared period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41D" d="M601 0l-183 -6v49c-31 -25 -79 -49 -140 -49c-148 0 -240 95 -240 227c0 141 105 229 251 229c33 0 85 -6 135 -45v195c0 39 -7 39 -69 39v47l177 8v-608c0 -39 7 -39 69 -39v-47zM418 103v250c-22 29 -62 61 -119 61c-31 0 -78 -10 -107 -52c-26 -39 -26 -93 -26 -141 c0 -70 0 -191 122 -191c76 0 117 55 130 73Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45F" d="M436 377c0 -36 -28 -59 -55 -59s-38 19 -38 35c0 26 22 50 52 55c0 0 -16 12 -42 12c-43 0 -72 -26 -80 -33c-24 -22 -52 -69 -56 -82l-32 -130c-4 -18 -38 -154 -40 -158c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43l58 231c13 52 16 63 16 84 c0 38 -14 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 3 13 63 31 97c9 18 28 57 74 57c47 0 83 -32 91 -77c19 28 63 77 128 77c51 0 83 -30 83 -65Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="707" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="1617" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="2617" y="0"></use>
<g transform="translate(2979,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="904" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4123" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="6382" y="673"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="5189" y="0"></use>
<g transform="translate(6189,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-28"></use>
<g transform="translate(389,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="707" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="1559" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="2559" y="0"></use>
<g transform="translate(2921,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="904" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4007" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="6218" y="673"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="11318" y="0"></use>
<g transform="translate(12375,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="638" y="583"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="13280" y="0"></use>
</g>
</svg>
</div>
<p>

When we expand this equation and find the coefficients of the quadratic equation 
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.909ex" height="2.676ex" style="vertical-align: -0.505ex;" viewBox="0 -934.9 6849.9 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">a t squared plus b t plus c equals 0</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="0" y="0"></use>
<g transform="translate(529,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="511" y="513"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="1567" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="2567" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="2997" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="3581" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="4581" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="5293" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="6349" y="0"></use>
</g>
</svg>, we have
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.608ex" height="11.176ex" style="vertical-align: -5.005ex;" viewBox="0 -2657.1 8872.9 4811.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">StartLayout 1st Row 1st Column a 2nd Column equals bold d Subscript x Superscript 2 Baseline plus bold d Subscript y Superscript 2 Baseline 2nd Row 1st Column b 2nd Column equals 2 left-parenthesis bold d Subscript x Baseline normal o Subscript x Baseline plus bold d Subscript y Baseline normal o Subscript y Baseline right-parenthesis 3rd Row 1st Column c 2nd Column equals normal o Subscript x Superscript 2 Baseline plus normal o Subscript y Superscript 2 Baseline minus r squared period EndLayout</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41D" d="M601 0l-183 -6v49c-31 -25 -79 -49 -140 -49c-148 0 -240 95 -240 227c0 141 105 229 251 229c33 0 85 -6 135 -45v195c0 39 -7 39 -69 39v47l177 8v-608c0 -39 7 -39 69 -39v-47zM418 103v250c-22 29 -62 61 -119 61c-31 0 -78 -10 -107 -52c-26 -39 -26 -93 -26 -141 c0 -70 0 -191 122 -191c76 0 117 55 130 73Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45F" d="M436 377c0 -36 -28 -59 -55 -59s-38 19 -38 35c0 26 22 50 52 55c0 0 -16 12 -42 12c-43 0 -72 -26 -80 -33c-24 -22 -52 -69 -56 -82l-32 -130c-4 -18 -38 -154 -40 -158c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43l58 231c13 52 16 63 16 84 c0 38 -14 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 3 13 63 31 97c9 18 28 57 74 57c47 0 83 -32 91 -77c19 28 63 77 128 77c51 0 83 -30 83 -65Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="0" y="1636"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="100" y="-56"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="96" y="-1737"></use>
</g>
<g transform="translate(796,0)">
<g transform="translate(0,1636)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
<g transform="translate(1056,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="904" y="596"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="904" y="-350"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="2422" y="0"></use>
<g transform="translate(3423,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="904" y="596"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="904" y="-350"></use>
</g>
</g>
<g transform="translate(0,-56)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="1056" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1556" y="0"></use>
<g transform="translate(1946,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="904" y="-213"></use>
</g>
<g transform="translate(3090,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="707" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="4318" y="0"></use>
<g transform="translate(5318,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="904" y="-213"></use>
</g>
<g transform="translate(6405,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="707" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="7352" y="0"></use>
</g>
<g transform="translate(0,-1737)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
<g transform="translate(1056,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="707" y="488"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="707" y="-211"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="2283" y="0"></use>
<g transform="translate(3284,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="707" y="488"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="707" y="-211"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="4461" y="0"></use>
<g transform="translate(5461,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="638" y="583"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="6367" y="0"></use>
</g>
</g>
</g>
</g>
</svg>
</div>
<p>


</p>
<p></p>
<span class="anchor" id="fragment-Computecylinderquadraticcoefficients-0"></span><div class="fragmentname">&lt;&lt;Compute cylinder quadratic coefficients&gt;&gt;=&nbsp;</div>
<div class="fragmentcode"><a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a> a = <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(di.x) + <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(di.y);
<a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a> b = 2 * (di.x * oi.x + di.y * oi.y);
<a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a> c = <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(oi.x) + <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(oi.y) - <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(<a href="../Utilities/Mathematical_Infrastructure.html#Interval" class="code">Interval</a>(radius));</div><p>


</p>
<p>As with spheres, the implementation refines the computed intersection point
to reduce the rounding error in the point
computed by evaluating the ray equation; see
Section&nbsp;<a href="../Shapes/Managing_Rounding_Error.html#sec:ray-quadric-precision">6.8.5</a>.  Afterward, we invert the
parametric description of the cylinder to compute <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.385ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 596.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">phi</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D719" d="M573 262c0 -134 -145 -269 -306 -274l-38 -149c-3 -14 -9 -38 -11 -40c-3 -3 -5 -4 -10 -4s-12 1 -12 11c0 3 10 41 22 88l23 94c-122 7 -192 86 -192 181c0 136 147 269 306 274l58 231c4 17 5 20 15 20c12 0 12 -10 12 -10l-3 -14l-56 -227c139 -10 192 -102 192 -181z M349 421c-149 -13 -235 -153 -235 -273c0 -100 72 -135 132 -138zM508 283c0 88 -57 134 -133 138l-103 -411c150 12 236 155 236 273Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="0" y="0"></use>
</g>
</svg> from <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.139ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 490.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
</g>
</svg>;
it turns out that the result is the same as for the sphere.

</p>
<p></p>
<span class="anchor" id="fragment-Computecylinderhitpointandphi-0"></span><div class="fragmentname">&lt;&lt;Compute cylinder hit point and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.385ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 596.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">phi</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D719" d="M573 262c0 -134 -145 -269 -306 -274l-38 -149c-3 -14 -9 -38 -11 -40c-3 -3 -5 -4 -10 -4s-12 1 -12 11c0 3 10 41 22 88l23 94c-122 7 -192 86 -192 181c0 136 147 269 306 274l58 231c4 17 5 20 15 20c12 0 12 -10 12 -10l-3 -14l-56 -227c139 -10 192 -102 192 -181z M349 421c-149 -13 -235 -153 -235 -273c0 -100 72 -135 132 -138zM508 283c0 88 -57 134 -133 138l-103 -411c150 12 236 155 236 273Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="0" y="0"></use>
</g>
</svg>&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">pHit = <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a>(oi) + (Float)tShapeHit * <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(di);
&lt;&lt;<span class="fragmentname"><a href="Managing_Rounding_Error.html#fragment-Refinecylinderintersectionpoint-0">Refine cylinder intersection point</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-491" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-491"><i></i></a><div id="fragbit-491" class="collapse show"><div class="fragmentcode">   Float hitRad = std::sqrt(<a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(pHit.x) + <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(pHit.y));
   pHit.x *= <a href="#Cylinder::radius" class="code">radius</a> / hitRad;
   pHit.y *= <a href="#Cylinder::radius" class="code">radius</a> / hitRad;</div></div>
phi = std::atan2(pHit.y, pHit.x);
if (phi &lt; 0) phi += 2 * <a href="../Utilities/Mathematical_Infrastructure.html#Pi" class="code">Pi</a>;</div><p>


</p>
<p>The next step in the intersection method makes sure that the hit is in the
specified <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.086ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 467.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
</g>
</svg> range and that the angle <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.385ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 596.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">phi</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D719" d="M573 262c0 -134 -145 -269 -306 -274l-38 -149c-3 -14 -9 -38 -11 -40c-3 -3 -5 -4 -10 -4s-12 1 -12 11c0 3 10 41 22 88l23 94c-122 7 -192 86 -192 181c0 136 147 269 306 274l58 231c4 17 5 20 15 20c12 0 12 -10 12 -10l-3 -14l-56 -227c139 -10 192 -102 192 -181z M349 421c-149 -13 -235 -153 -235 -273c0 -100 72 -135 132 -138zM508 283c0 88 -57 134 -133 138l-103 -411c150 12 236 155 236 273Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="0" y="0"></use>
</g>
</svg> is acceptable.  If not, it
rejects the hit and checks <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.894ex" height="2.343ex" style="vertical-align: -0.671ex;" viewBox="0 -719.6 815.4 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">t 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="511" y="-213"></use>
</g>
</svg> if it has not already been
considered&mdash;these tests resemble the conditional logic in
<a href="../Shapes/Spheres.html#Sphere::Intersect"><tt>Sphere::Intersect()</tt></a>.

</p>
<p></p>
<span class="anchor" id="fragment-Testcylinderintersectionagainstclippingparameters-0"></span><div class="fragmentname">&lt;&lt;Test cylinder intersection against clipping parameters&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">if (pHit.z &lt; <a href="#Cylinder::zMin" class="code">zMin</a> || pHit.z &gt; <a href="#Cylinder::zMax" class="code">zMax</a> || phi &gt; <a href="#Cylinder::phiMax" class="code">phiMax</a>) {
    if (tShapeHit == t1)
        return {};
    tShapeHit = t1;
    if (t1.<a href="../Utilities/Mathematical_Infrastructure.html#Interval::UpperBound" class="code">UpperBound</a>() &gt; tMax)
        return {};
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Computecylinderhitpointandphi-0">Compute cylinder hit point and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.385ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 596.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">phi</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D719" d="M573 262c0 -134 -145 -269 -306 -274l-38 -149c-3 -14 -9 -38 -11 -40c-3 -3 -5 -4 -10 -4s-12 1 -12 11c0 3 10 41 22 88l23 94c-122 7 -192 86 -192 181c0 136 147 269 306 274l58 231c4 17 5 20 15 20c12 0 12 -10 12 -10l-3 -14l-56 -227c139 -10 192 -102 192 -181z M349 421c-149 -13 -235 -153 -235 -273c0 -100 72 -135 132 -138zM508 283c0 88 -57 134 -133 138l-103 -411c150 12 236 155 236 273Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="0" y="0"></use>
</g>
</svg></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-492" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-492"><i></i></a><div id="fragbit-492" class="collapse show"><div class="fragmentcode">       pHit = <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a>(oi) + (Float)tShapeHit * <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(di);
       &lt;&lt;<span class="fragmentname"><a href="Managing_Rounding_Error.html#fragment-Refinecylinderintersectionpoint-0">Refine cylinder intersection point</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-493" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-493"><i></i></a><div id="fragbit-493" class="collapse show"><div class="fragmentcode">          Float hitRad = std::sqrt(<a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(pHit.x) + <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(pHit.y));
          pHit.x *= <a href="#Cylinder::radius" class="code">radius</a> / hitRad;
          pHit.y *= <a href="#Cylinder::radius" class="code">radius</a> / hitRad;</div></div>
       phi = std::atan2(pHit.y, pHit.x);
       if (phi &lt; 0) phi += 2 * <a href="../Utilities/Mathematical_Infrastructure.html#Pi" class="code">Pi</a>;</div></div>
    if (pHit.z &lt; <a href="#Cylinder::zMin" class="code">zMin</a> || pHit.z &gt; <a href="#Cylinder::zMax" class="code">zMax</a> || phi &gt; <a href="#Cylinder::phiMax" class="code">phiMax</a>)
        return {};
}</div><p>


</p>
<p>For a successful intersection, the same three values suffice to provide
enough information to later compute the corresponding
<a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction"><tt>SurfaceInteraction</tt></a>.

</p>
<p></p>
<span class="anchor" id="fragment-ReturnmonoQuadricIntersectionforcylinderintersection-0"></span><div class="fragmentname">&lt;&lt;Return <tt>QuadricIntersection</tt> for cylinder intersection&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">return <a href="../Shapes/Spheres.html#QuadricIntersection" class="code">QuadricIntersection</a>{Float(tShapeHit), pHit, phi};</div><p>


</p>
<p>As with the sphere, <tt>IntersectP()</tt>&rsquo;s implementation is a simple
wrapper around <tt>BasicIntersect()</tt>.

</p>
<p></p>
<span class="anchor" id="fragment-CylinderPublicMethods-5"></span><div class="fragmentname">&lt;&lt;Cylinder Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-CylinderPublicMethods-4"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-CylinderPublicMethods-6"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">bool <span class="anchor" id="Cylinder::IntersectP"></span>IntersectP(const <a href="../Geometry_and_Transformations/Rays.html#Ray" class="code">Ray</a> &amp;r, Float tMax = Infinity) const {
    return <a href="#Cylinder::BasicIntersect" class="code">BasicIntersect</a>(r, tMax).has_value();
}</div><p>


</p>
<p><tt>InteractionFromIntersection()</tt> computes all the quantities needed
to initialize a <a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction"><tt>SurfaceInteraction</tt></a> from a cylinder&rsquo;s
<a href="../Shapes/Spheres.html#QuadricIntersection"><tt>QuadricIntersection</tt></a>.

</p>
<p></p>
<span class="anchor" id="fragment-CylinderPublicMethods-6"></span><div class="fragmentname">&lt;&lt;Cylinder Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-CylinderPublicMethods-5"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-CylinderPublicMethods-7"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction" class="code">SurfaceInteraction</a> <span class="anchor" id="Cylinder::InteractionFromIntersection"></span>InteractionFromIntersection(
        const <a href="../Shapes/Spheres.html#QuadricIntersection" class="code">QuadricIntersection</a> &amp;isect, <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> wo, Float time) const {
    <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> pHit = isect.<a href="../Shapes/Spheres.html#QuadricIntersection::pObj" class="code">pObj</a>;
    Float <a href="../Shapes/Spheres.html#QuadricIntersection::phi" class="code">phi</a> = isect.<a href="../Shapes/Spheres.html#QuadricIntersection::phi" class="code">phi</a>;
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Findparametricrepresentationofcylinderhit-0">Find parametric representation of cylinder hit</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-494" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-494"><i></i></a><div id="fragbit-494" class="collapse show"><div class="fragmentcode">       Float u = phi / <a href="#Cylinder::phiMax" class="code">phiMax</a>;
       Float v = (pHit.z - <a href="#Cylinder::zMin" class="code">zMin</a>) / (<a href="#Cylinder::zMax" class="code">zMax</a> - <a href="#Cylinder::zMin" class="code">zMin</a>);
       &lt;&lt;<span class="fragmentname"><a href="#fragment-Computecylinderdpduanddpdv-0">Compute cylinder <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.509ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2802.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential normal p slash partial-differential u</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1143" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1643" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="2230" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.307ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2715.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential normal p slash partial-differential v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1143" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1643" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="2230" y="0"></use>
</g>
</svg></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-495" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-495"><i></i></a><div id="fragbit-495" class="collapse show"><div class="fragmentcode">          <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> dpdu(-<a href="#Cylinder::phiMax" class="code">phiMax</a> * pHit.y, <a href="#Cylinder::phiMax" class="code">phiMax</a> * pHit.x, 0);
          <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> dpdv(0, 0, <a href="#Cylinder::zMax" class="code">zMax</a> - <a href="#Cylinder::zMin" class="code">zMin</a>);</div></div>
       &lt;&lt;<span class="fragmentname"><a href="#fragment-Computecylinderdnduanddndv-0">Compute cylinder <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.702ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2885.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential bold n Subscript slash partial-differential u</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D427" d="M615 0l-126 3l-126 -3v47h69v270c0 76 -21 97 -55 97c-63 0 -149 -49 -149 -158v-209h69v-47l-126 3l-126 -3v47h69v309c0 39 -7 39 -69 39v47l172 8v-108c26 51 79 108 175 108c100 0 154 -39 154 -144v-259h69v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D427" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1226" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1726" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="2313" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.5ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2798.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential bold n Subscript slash partial-differential v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D427" d="M615 0l-126 3l-126 -3v47h69v270c0 76 -21 97 -55 97c-63 0 -149 -49 -149 -158v-209h69v-47l-126 3l-126 -3v47h69v309c0 39 -7 39 -69 39v47l172 8v-108c26 51 79 108 175 108c100 0 154 -39 154 -144v-259h69v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D427" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1226" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1726" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="2313" y="0"></use>
</g>
</svg></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-496" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-496"><i></i></a><div id="fragbit-496" class="collapse show"><div class="fragmentcode">          <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> d2Pduu = -phiMax * phiMax * <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(pHit.x, pHit.y, 0);
          <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> d2Pduv(0, 0, 0), d2Pdvv(0, 0, 0);
          &lt;&lt;<span class="fragmentname"><a href="Spheres.html#fragment-Computecoefficientsforfundamentalforms-0">Compute coefficients for fundamental forms</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-497" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-497"><i></i></a><div id="fragbit-497" class="collapse show"><div class="fragmentcode">             Float E = <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(dpdu, dpdu), F = <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(dpdu, dpdv), G = <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(dpdv, dpdv);
             <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> n = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(<a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(dpdu, dpdv));
             Float e = <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(n, d2Pduu), f = <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(n, d2Pduv), g = <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(n, d2Pdvv);</div></div>
          &lt;&lt;<span class="fragmentname"><a href="Spheres.html#fragment-Computednduanddndvfromfundamentalformcoefficients-0">Compute <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.702ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2885.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential bold n Subscript slash partial-differential u</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D427" d="M615 0l-126 3l-126 -3v47h69v270c0 76 -21 97 -55 97c-63 0 -149 -49 -149 -158v-209h69v-47l-126 3l-126 -3v47h69v309c0 39 -7 39 -69 39v47l172 8v-108c26 51 79 108 175 108c100 0 154 -39 154 -144v-259h69v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D427" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1226" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1726" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="2313" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.5ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2798.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential bold n Subscript slash partial-differential v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D427" d="M615 0l-126 3l-126 -3v47h69v270c0 76 -21 97 -55 97c-63 0 -149 -49 -149 -158v-209h69v-47l-126 3l-126 -3v47h69v309c0 39 -7 39 -69 39v47l172 8v-108c26 51 79 108 175 108c100 0 154 -39 154 -144v-259h69v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D427" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1226" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1726" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="2313" y="0"></use>
</g>
</svg> from fundamental form coefficients</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-498" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-498"><i></i></a><div id="fragbit-498" class="collapse show"><div class="fragmentcode">             Float EGF2 = <a href="../Utilities/Mathematical_Infrastructure.html#DifferenceOfProducts" class="code">DifferenceOfProducts</a>(E, G, F, F);
             Float invEGF2 = (EGF2 == 0) ? Float(0) : 1 / EGF2;
             <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> dndu = <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>((f * F - e * G) * invEGF2 * dpdu + 
                                      (e * F - f * E) * invEGF2 * dpdv);
             <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> dndv = <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>((g * F - f * G) * invEGF2 * dpdu + 
                                      (f * F - g * E) * invEGF2 * dpdv);</div></div></div></div></div></div>
    &lt;&lt;<span class="fragmentname"><a href="Managing_Rounding_Error.html#fragment-Computeerrorboundsforcylinderintersection-0">Compute error bounds for cylinder intersection</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-499" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-499"><i></i></a><div id="fragbit-499" class="collapse show"><div class="fragmentcode">       <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> pError = <a href="../Shapes/Managing_Rounding_Error.html#gamma" class="code">gamma</a>(3) * <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Abs" class="code">Abs</a>(<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(pHit.x, pHit.y, 0));</div></div>
    &lt;&lt;<span class="fragmentname"><a href="Spheres.html#fragment-ReturnmonoSurfaceInteractionforquadricintersection-0">Return <tt>SurfaceInteraction</tt> for quadric intersection</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-500" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-500"><i></i></a><div id="fragbit-500" class="collapse show"><div class="fragmentcode">       bool flipNormal = <a href="../Shapes/Spheres.html#Sphere::reverseOrientation" class="code">reverseOrientation</a> ^ <a href="../Shapes/Spheres.html#Sphere::transformSwapsHandedness" class="code">transformSwapsHandedness</a>;
       <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> woObject = (*<a href="../Shapes/Spheres.html#Sphere::objectFromRender" class="code">objectFromRender</a>)(wo);
       return (*renderFromObject)(
           <a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction" class="code">SurfaceInteraction</a>(Point3fi(pHit, pError), <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(u, v), woObject,
                              dpdu, dpdv, dndu, dndv, time, flipNormal));</div></div>
}</div><p>


</p>
<p>Again the parametric <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">u</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="0" y="0"></use>
</g>
</svg> value is computed by scaling <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.385ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 596.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">phi</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D719" d="M573 262c0 -134 -145 -269 -306 -274l-38 -149c-3 -14 -9 -38 -11 -40c-3 -3 -5 -4 -10 -4s-12 1 -12 11c0 3 10 41 22 88l23 94c-122 7 -192 86 -192 181c0 136 147 269 306 274l58 231c4 17 5 20 15 20c12 0 12 -10 12 -10l-3 -14l-56 -227c139 -10 192 -102 192 -181z M349 421c-149 -13 -235 -153 -235 -273c0 -100 72 -135 132 -138zM508 283c0 88 -57 134 -133 138l-103 -411c150 12 236 155 236 273Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="0" y="0"></use>
</g>
</svg> to lie between
0 and&nbsp;1.  Inversion of the parametric equation for the
cylinder&rsquo;s <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.086ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 467.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
</g>
</svg> value gives the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.128ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 485.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="0" y="0"></use>
</g>
</svg> parametric coordinate.

</p>
<p></p>
<span class="anchor" id="fragment-Findparametricrepresentationofcylinderhit-0"></span><div class="fragmentname">&lt;&lt;Find parametric representation of cylinder hit&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">Float u = phi / <a href="#Cylinder::phiMax" class="code">phiMax</a>;
Float v = (pHit.z - <a href="#Cylinder::zMin" class="code">zMin</a>) / (<a href="#Cylinder::zMax" class="code">zMax</a> - <a href="#Cylinder::zMin" class="code">zMin</a>);
&lt;&lt;<span class="fragmentname"><a href="#fragment-Computecylinderdpduanddpdv-0">Compute cylinder <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.509ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2802.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential normal p slash partial-differential u</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1143" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1643" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="2230" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.307ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2715.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential normal p slash partial-differential v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1143" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1643" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="2230" y="0"></use>
</g>
</svg></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-501" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-501"><i></i></a><div id="fragbit-501" class="collapse show"><div class="fragmentcode">   <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> dpdu(-<a href="#Cylinder::phiMax" class="code">phiMax</a> * pHit.y, <a href="#Cylinder::phiMax" class="code">phiMax</a> * pHit.x, 0);
   <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> dpdv(0, 0, <a href="#Cylinder::zMax" class="code">zMax</a> - <a href="#Cylinder::zMin" class="code">zMin</a>);</div></div>
&lt;&lt;<span class="fragmentname"><a href="#fragment-Computecylinderdnduanddndv-0">Compute cylinder <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.702ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2885.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential bold n Subscript slash partial-differential u</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D427" d="M615 0l-126 3l-126 -3v47h69v270c0 76 -21 97 -55 97c-63 0 -149 -49 -149 -158v-209h69v-47l-126 3l-126 -3v47h69v309c0 39 -7 39 -69 39v47l172 8v-108c26 51 79 108 175 108c100 0 154 -39 154 -144v-259h69v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D427" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1226" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1726" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="2313" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.5ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2798.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential bold n Subscript slash partial-differential v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D427" d="M615 0l-126 3l-126 -3v47h69v270c0 76 -21 97 -55 97c-63 0 -149 -49 -149 -158v-209h69v-47l-126 3l-126 -3v47h69v309c0 39 -7 39 -69 39v47l172 8v-108c26 51 79 108 175 108c100 0 154 -39 154 -144v-259h69v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D427" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1226" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1726" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="2313" y="0"></use>
</g>
</svg></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-502" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-502"><i></i></a><div id="fragbit-502" class="collapse show"><div class="fragmentcode">   <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> d2Pduu = -phiMax * phiMax * <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(pHit.x, pHit.y, 0);
   <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> d2Pduv(0, 0, 0), d2Pdvv(0, 0, 0);
   &lt;&lt;<span class="fragmentname"><a href="Spheres.html#fragment-Computecoefficientsforfundamentalforms-0">Compute coefficients for fundamental forms</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-503" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-503"><i></i></a><div id="fragbit-503" class="collapse show"><div class="fragmentcode">      Float E = <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(dpdu, dpdu), F = <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(dpdu, dpdv), G = <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(dpdv, dpdv);
      <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> n = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(<a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(dpdu, dpdv));
      Float e = <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(n, d2Pduu), f = <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(n, d2Pduv), g = <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(n, d2Pdvv);</div></div>
   &lt;&lt;<span class="fragmentname"><a href="Spheres.html#fragment-Computednduanddndvfromfundamentalformcoefficients-0">Compute <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.702ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2885.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential bold n Subscript slash partial-differential u</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D427" d="M615 0l-126 3l-126 -3v47h69v270c0 76 -21 97 -55 97c-63 0 -149 -49 -149 -158v-209h69v-47l-126 3l-126 -3v47h69v309c0 39 -7 39 -69 39v47l172 8v-108c26 51 79 108 175 108c100 0 154 -39 154 -144v-259h69v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D427" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1226" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1726" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="2313" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.5ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2798.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential bold n Subscript slash partial-differential v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D427" d="M615 0l-126 3l-126 -3v47h69v270c0 76 -21 97 -55 97c-63 0 -149 -49 -149 -158v-209h69v-47l-126 3l-126 -3v47h69v309c0 39 -7 39 -69 39v47l172 8v-108c26 51 79 108 175 108c100 0 154 -39 154 -144v-259h69v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D427" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1226" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1726" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="2313" y="0"></use>
</g>
</svg> from fundamental form coefficients</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-504" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-504"><i></i></a><div id="fragbit-504" class="collapse show"><div class="fragmentcode">      Float EGF2 = <a href="../Utilities/Mathematical_Infrastructure.html#DifferenceOfProducts" class="code">DifferenceOfProducts</a>(E, G, F, F);
      Float invEGF2 = (EGF2 == 0) ? Float(0) : 1 / EGF2;
      <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> dndu = <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>((f * F - e * G) * invEGF2 * dpdu + 
                               (e * F - f * E) * invEGF2 * dpdv);
      <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> dndv = <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>((g * F - f * G) * invEGF2 * dpdu + 
                               (f * F - g * E) * invEGF2 * dpdv);</div></div></div></div></div><p>


</p>
<p>The partial derivatives for a cylinder are easy to derive:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="26.822ex" height="11.843ex" style="vertical-align: -5.338ex;" viewBox="0 -2800.6 11548.2 5098.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">StartLayout 1st Row 1st Column StartFraction partial-differential normal p Over partial-differential u EndFraction 2nd Column equals left-parenthesis minus phi Subscript normal m normal a normal x Baseline y comma phi Subscript normal m normal a normal x Baseline x comma 0 right-parenthesis 2nd Row 1st Column StartFraction partial-differential normal p Over partial-differential v EndFraction 2nd Column equals left-parenthesis 0 comma 0 comma z Subscript normal m normal a normal x Baseline minus z Subscript normal m normal i normal n Baseline right-parenthesis period EndLayout</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D719" d="M573 262c0 -134 -145 -269 -306 -274l-38 -149c-3 -14 -9 -38 -11 -40c-3 -3 -5 -4 -10 -4s-12 1 -12 11c0 3 10 41 22 88l23 94c-122 7 -192 86 -192 181c0 136 147 269 306 274l58 231c4 17 5 20 15 20c12 0 12 -10 12 -10l-3 -14l-56 -227c139 -10 192 -102 192 -181z M349 421c-149 -13 -235 -153 -235 -273c0 -100 72 -135 132 -138zM508 283c0 88 -57 134 -133 138l-103 -411c150 12 236 155 236 273Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6D" d="M813 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31 c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c45 0 119 -11 133 -98c17 38 61 98 145 98c58 0 91 -20 105 -37c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-61" d="M483 89c0 -81 -61 -95 -82 -95c-47 0 -74 42 -78 82c-19 -47 -65 -87 -131 -87c-63 0 -160 25 -160 106c0 44 25 96 100 130c63 30 133 33 184 36v37c0 89 -57 128 -106 128c-32 0 -81 -11 -108 -46c46 -1 51 -34 51 -46c0 -26 -18 -46 -46 -46c-26 0 -46 17 -46 47 c0 66 69 113 151 113c48 0 98 -16 137 -55c36 -37 36 -76 36 -118v-200c0 -5 4 -50 37 -50c11 0 36 6 36 64v56h25v-56zM316 140v100c-165 -6 -207 -89 -207 -144c0 -50 41 -85 90 -85c45 0 117 34 117 129Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-78" d="M516 0c-30 2 -69 3 -96 3l-108 -3v31c27 1 36 16 36 25c0 6 -13 22 -21 33l-76 100c-61 -72 -90 -105 -90 -127c0 -15 7 -28 29 -31v-31l-95 3c-26 0 -57 -1 -83 -3v31c21 0 80 2 128 60c47 57 47 59 94 119l-99 129c-47 60 -48 61 -118 61v31c27 -2 74 -3 95 -3l108 3 v-31c-20 -1 -35 -10 -35 -25c0 -6 0 -8 9 -18l78 -101l62 78c5 6 15 19 15 35s-8 29 -29 31v31c13 -1 66 -3 96 -3c26 0 56 1 82 3v-31c-47 -1 -88 -16 -119 -52c-24 -26 -62 -75 -92 -113l134 -173c23 -29 41 -31 95 -31v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6E" d="M535 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c58 0 91 -20 105 -37 c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,1259)">
<g transform="translate(120,0)">
<rect stroke="none" width="1279" height="60" x="0" y="220"></rect>
<g transform="translate(68,714)">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="586" y="0"></use>
</g>
<g transform="translate(60,-737)">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="586" y="0"></use>
</g>
</g>
</g>
<g transform="translate(16,-1432)">
<g transform="translate(120,0)">
<rect stroke="none" width="1263" height="60" x="0" y="220"></rect>
<g transform="translate(60,714)">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="586" y="0"></use>
</g>
<g transform="translate(95,-737)">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="586" y="0"></use>
</g>
</g>
</g>
</g>
<g transform="translate(1786,0)">
<g transform="translate(0,1259)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1056" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="1445" y="0"></use>
<g transform="translate(2224,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="0" y="0"></use>
<g transform="translate(596,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-6D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-61" x="833" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-78" x="1334" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="4237" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="4728" y="0"></use>
<g transform="translate(5340,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="0" y="0"></use>
<g transform="translate(596,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-6D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-61" x="833" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-78" x="1334" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="7353" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="7926" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="8537" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="9038" y="0"></use>
</g>
<g transform="translate(0,-1432)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1056" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="1445" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1946" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="2558" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="3058" y="0"></use>
<g transform="translate(3670,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
<g transform="translate(465,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-6D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-61" x="833" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-78" x="1334" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="5775" y="0"></use>
<g transform="translate(6775,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
<g transform="translate(465,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-6D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-69" x="833" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-6E" x="1112" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="8521" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="8910" y="0"></use>
</g>
</g>
</g>
</g>
</svg>
</div>
<p>


</p>
<p></p>
<span class="anchor" id="fragment-Computecylinderdpduanddpdv-0"></span><div class="fragmentname">&lt;&lt;Compute cylinder <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.509ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2802.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential normal p slash partial-differential u</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1143" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1643" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="2230" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.307ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2715.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential normal p slash partial-differential v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1143" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1643" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="2230" y="0"></use>
</g>
</svg>&gt;&gt;=&nbsp;</div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> dpdu(-<a href="#Cylinder::phiMax" class="code">phiMax</a> * pHit.y, <a href="#Cylinder::phiMax" class="code">phiMax</a> * pHit.x, 0);
<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> dpdv(0, 0, <a href="#Cylinder::zMax" class="code">zMax</a> - <a href="#Cylinder::zMin" class="code">zMin</a>);</div><p>


</p>
<p>We again use the Weingarten equations to compute the parametric partial
derivatives of the cylinder normal.  The relevant partial derivatives are
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="23.861ex" height="19.176ex" style="vertical-align: -8.724ex; margin-bottom: -0.281ex;" viewBox="0 -4379.3 10273.4 8256.3" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">StartLayout 1st Row 1st Column StartFraction partial-differential squared normal p Over partial-differential u squared EndFraction 2nd Column equals minus phi Subscript normal m normal a normal x Superscript 2 Baseline left-parenthesis x comma y comma 0 right-parenthesis 2nd Row 1st Column StartFraction partial-differential squared normal p Over partial-differential u partial-differential v EndFraction 2nd Column equals left-parenthesis 0 comma 0 comma 0 right-parenthesis 3rd Row 1st Column StartFraction partial-differential squared normal p Over partial-differential v squared EndFraction 2nd Column equals left-parenthesis 0 comma 0 comma 0 right-parenthesis period EndLayout</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D719" d="M573 262c0 -134 -145 -269 -306 -274l-38 -149c-3 -14 -9 -38 -11 -40c-3 -3 -5 -4 -10 -4s-12 1 -12 11c0 3 10 41 22 88l23 94c-122 7 -192 86 -192 181c0 136 147 269 306 274l58 231c4 17 5 20 15 20c12 0 12 -10 12 -10l-3 -14l-56 -227c139 -10 192 -102 192 -181z M349 421c-149 -13 -235 -153 -235 -273c0 -100 72 -135 132 -138zM508 283c0 88 -57 134 -133 138l-103 -411c150 12 236 155 236 273Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6D" d="M813 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31 c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c45 0 119 -11 133 -98c17 38 61 98 145 98c58 0 91 -20 105 -37c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-61" d="M483 89c0 -81 -61 -95 -82 -95c-47 0 -74 42 -78 82c-19 -47 -65 -87 -131 -87c-63 0 -160 25 -160 106c0 44 25 96 100 130c63 30 133 33 184 36v37c0 89 -57 128 -106 128c-32 0 -81 -11 -108 -46c46 -1 51 -34 51 -46c0 -26 -18 -46 -46 -46c-26 0 -46 17 -46 47 c0 66 69 113 151 113c48 0 98 -16 137 -55c36 -37 36 -76 36 -118v-200c0 -5 4 -50 37 -50c11 0 36 6 36 64v56h25v-56zM316 140v100c-165 -6 -207 -89 -207 -144c0 -50 41 -85 90 -85c45 0 117 34 117 129Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-78" d="M516 0c-30 2 -69 3 -96 3l-108 -3v31c27 1 36 16 36 25c0 6 -13 22 -21 33l-76 100c-61 -72 -90 -105 -90 -127c0 -15 7 -28 29 -31v-31l-95 3c-26 0 -57 -1 -83 -3v31c21 0 80 2 128 60c47 57 47 59 94 119l-99 129c-47 60 -48 61 -118 61v31c27 -2 74 -3 95 -3l108 3 v-31c-20 -1 -35 -10 -35 -25c0 -6 0 -8 9 -18l78 -101l62 78c5 6 15 19 15 35s-8 29 -29 31v31c13 -1 66 -3 96 -3c26 0 56 1 82 3v-31c-47 -1 -88 -16 -119 -52c-24 -26 -62 -75 -92 -113l134 -173c23 -29 41 -31 95 -31v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(618,2707)">
<g transform="translate(120,0)">
<rect stroke="none" width="1732" height="60" x="0" y="220"></rect>
<g transform="translate(68,714)">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="829" y="513"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="1040" y="0"></use>
</g>
<g transform="translate(60,-780)">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
<g transform="translate(586,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="809" y="408"></use>
</g>
</g>
</g>
</g>
<g transform="translate(0,-145)">
<g transform="translate(120,0)">
<rect stroke="none" width="2351" height="60" x="0" y="220"></rect>
<g transform="translate(377,714)">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="829" y="513"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="1040" y="0"></use>
</g>
<g transform="translate(60,-737)">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1159" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="1745" y="0"></use>
</g>
</g>
</g>
<g transform="translate(634,-2954)">
<g transform="translate(120,0)">
<rect stroke="none" width="1716" height="60" x="0" y="220"></rect>
<g transform="translate(60,714)">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="829" y="513"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="1040" y="0"></use>
</g>
<g transform="translate(95,-780)">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
<g transform="translate(586,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="686" y="408"></use>
</g>
</g>
</g>
</g>
</g>
<g transform="translate(2858,0)">
<g transform="translate(0,2707)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="1056" y="0"></use>
<g transform="translate(1834,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="843" y="488"></use>
<g transform="translate(596,-154)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-6D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-61" x="833" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-78" x="1334" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="3848" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="4237" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="4810" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="5255" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="5745" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="6191" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="6691" y="0"></use>
</g>
<g transform="translate(0,-145)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1056" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="1445" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1946" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="2391" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="2891" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="3337" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3837" y="0"></use>
</g>
<g transform="translate(0,-2954)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1056" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="1445" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1946" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="2391" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="2891" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="3337" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3837" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="4227" y="0"></use>
</g>
</g>
</g>
</g>
</svg>
</div>
<p>


</p>
<p></p>
<span class="anchor" id="fragment-Computecylinderdnduanddndv-0"></span><div class="fragmentname">&lt;&lt;Compute cylinder <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.702ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2885.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential bold n Subscript slash partial-differential u</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D427" d="M615 0l-126 3l-126 -3v47h69v270c0 76 -21 97 -55 97c-63 0 -149 -49 -149 -158v-209h69v-47l-126 3l-126 -3v47h69v309c0 39 -7 39 -69 39v47l172 8v-108c26 51 79 108 175 108c100 0 154 -39 154 -144v-259h69v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D427" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1226" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1726" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="2313" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.5ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2798.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential bold n Subscript slash partial-differential v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D427" d="M615 0l-126 3l-126 -3v47h69v270c0 76 -21 97 -55 97c-63 0 -149 -49 -149 -158v-209h69v-47l-126 3l-126 -3v47h69v309c0 39 -7 39 -69 39v47l172 8v-108c26 51 79 108 175 108c100 0 154 -39 154 -144v-259h69v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D427" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1226" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1726" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="2313" y="0"></use>
</g>
</svg>&gt;&gt;=&nbsp;</div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> d2Pduu = -phiMax * phiMax * <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(pHit.x, pHit.y, 0);
<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> d2Pduv(0, 0, 0), d2Pdvv(0, 0, 0);
&lt;&lt;<span class="fragmentname"><a href="Spheres.html#fragment-Computecoefficientsforfundamentalforms-0">Compute coefficients for fundamental forms</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-505" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-505"><i></i></a><div id="fragbit-505" class="collapse show"><div class="fragmentcode">   Float E = <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(dpdu, dpdu), F = <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(dpdu, dpdv), G = <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(dpdv, dpdv);
   <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> n = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(<a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(dpdu, dpdv));
   Float e = <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(n, d2Pduu), f = <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(n, d2Pduv), g = <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(n, d2Pdvv);</div></div>
&lt;&lt;<span class="fragmentname"><a href="Spheres.html#fragment-Computednduanddndvfromfundamentalformcoefficients-0">Compute <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.702ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2885.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential bold n Subscript slash partial-differential u</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D427" d="M615 0l-126 3l-126 -3v47h69v270c0 76 -21 97 -55 97c-63 0 -149 -49 -149 -158v-209h69v-47l-126 3l-126 -3v47h69v309c0 39 -7 39 -69 39v47l172 8v-108c26 51 79 108 175 108c100 0 154 -39 154 -144v-259h69v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D427" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1226" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1726" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="2313" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.5ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2798.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential bold n Subscript slash partial-differential v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D427" d="M615 0l-126 3l-126 -3v47h69v270c0 76 -21 97 -55 97c-63 0 -149 -49 -149 -158v-209h69v-47l-126 3l-126 -3v47h69v309c0 39 -7 39 -69 39v47l172 8v-108c26 51 79 108 175 108c100 0 154 -39 154 -144v-259h69v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D427" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1226" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1726" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="2313" y="0"></use>
</g>
</svg> from fundamental form coefficients</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-506" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-506"><i></i></a><div id="fragbit-506" class="collapse show"><div class="fragmentcode">   Float EGF2 = <a href="../Utilities/Mathematical_Infrastructure.html#DifferenceOfProducts" class="code">DifferenceOfProducts</a>(E, G, F, F);
   Float invEGF2 = (EGF2 == 0) ? Float(0) : 1 / EGF2;
   <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> dndu = <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>((f * F - e * G) * invEGF2 * dpdu + 
                            (e * F - f * E) * invEGF2 * dpdv);
   <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> dndv = <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>((g * F - f * G) * invEGF2 * dpdu + 
                            (f * F - g * E) * invEGF2 * dpdv);</div></div></div><p>


</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#Sampling"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="Sampling"></span><h3>6.3.3  Sampling</h3><p>


</p>
<p>Uniformly sampling the surface area of a cylinder is straightforward:
uniform sampling of the height and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.385ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 596.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">phi</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D719" d="M573 262c0 -134 -145 -269 -306 -274l-38 -149c-3 -14 -9 -38 -11 -40c-3 -3 -5 -4 -10 -4s-12 1 -12 11c0 3 10 41 22 88l23 94c-122 7 -192 86 -192 181c0 136 147 269 306 274l58 231c4 17 5 20 15 20c12 0 12 -10 12 -10l-3 -14l-56 -227c139 -10 192 -102 192 -181z M349 421c-149 -13 -235 -153 -235 -273c0 -100 72 -135 132 -138zM508 283c0 88 -57 134 -133 138l-103 -411c150 12 236 155 236 273Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="0" y="0"></use>
</g>
</svg> give uniform area sampling.
Intuitively, it can be understood that this approach works because a
cylinder is just a rolled-up rectangle.

</p>
<p></p>
<span class="anchor" id="fragment-CylinderPublicMethods-7"></span><div class="fragmentname">&lt;&lt;Cylinder Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-CylinderPublicMethods-6"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-CylinderPublicMethods-8"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">pstd::optional&lt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample" class="code">ShapeSample</a>&gt; <span class="anchor" id="Cylinder::Sample"></span>Sample(<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> u) const {
    Float z = <a href="../Monte_Carlo_Integration/Sampling_Using_the_Inversion_Method.html#Lerp" class="code">Lerp</a>(u[0], <a href="#Cylinder::zMin" class="code">zMin</a>, <a href="#Cylinder::zMax" class="code">zMax</a>);
    Float phi = u[1] * <a href="#Cylinder::phiMax" class="code">phiMax</a>;
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Computecylindersamplepositionmonopiandnormalmononfromzandphi-0">Compute cylinder sample position <tt>pi</tt> and normal <tt>n</tt> from <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.086ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 467.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.385ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 596.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">phi</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D719" d="M573 262c0 -134 -145 -269 -306 -274l-38 -149c-3 -14 -9 -38 -11 -40c-3 -3 -5 -4 -10 -4s-12 1 -12 11c0 3 10 41 22 88l23 94c-122 7 -192 86 -192 181c0 136 147 269 306 274l58 231c4 17 5 20 15 20c12 0 12 -10 12 -10l-3 -14l-56 -227c139 -10 192 -102 192 -181z M349 421c-149 -13 -235 -153 -235 -273c0 -100 72 -135 132 -138zM508 283c0 88 -57 134 -133 138l-103 -411c150 12 236 155 236 273Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="0" y="0"></use>
</g>
</svg></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-507" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-507"><i></i></a><div id="fragbit-507" class="collapse show"><div class="fragmentcode">       <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> pObj = <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a>(<a href="#Cylinder::radius" class="code">radius</a> * std::cos(phi), <a href="#Cylinder::radius" class="code">radius</a> * std::sin(phi), z);
       &lt;&lt;<span class="fragmentname"><a href="Managing_Rounding_Error.html#fragment-ReprojectmonopObjtocylindersurfaceandcomputemonopObjError-0">Reproject <tt>pObj</tt> to cylinder surface and compute <tt>pObjError</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-508" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-508"><i></i></a><div id="fragbit-508" class="collapse show"><div class="fragmentcode">          Float hitRad = std::sqrt(<a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(pObj.x) + <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(pObj.y));
          pObj.x *= <a href="#Cylinder::radius" class="code">radius</a> / hitRad;
          pObj.y *= <a href="#Cylinder::radius" class="code">radius</a> / hitRad;
          <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> pObjError = <a href="../Shapes/Managing_Rounding_Error.html#gamma" class="code">gamma</a>(3) * <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Abs" class="code">Abs</a>(<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(pObj.x, pObj.y, 0));</div></div>
       Point3fi pi = (*renderFromObject)(Point3fi(pObj, pObjError));
       <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> n = Normalize((*renderFromObject)(<a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(pObj.x, pObj.y, 0)));
       if (<a href="#Cylinder::reverseOrientation" class="code">reverseOrientation</a>)
           n *= -1;</div></div>
    <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> uv(phi / <a href="#Cylinder::phiMax" class="code">phiMax</a>, (pObj.z - <a href="#Cylinder::zMin" class="code">zMin</a>) / (<a href="#Cylinder::zMax" class="code">zMax</a> - <a href="#Cylinder::zMin" class="code">zMin</a>));
    return <a href="../Shapes/Basic_Shape_Interface.html#ShapeSample" class="code">ShapeSample</a>{<a href="../Geometry_and_Transformations/Interactions.html#Interaction" class="code">Interaction</a>(pi, n, uv), 1 / <a href="#Cylinder::Area" class="code">Area</a>()};
}</div><p>


</p>
<p>Given <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.086ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 467.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.385ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 596.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">phi</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D719" d="M573 262c0 -134 -145 -269 -306 -274l-38 -149c-3 -14 -9 -38 -11 -40c-3 -3 -5 -4 -10 -4s-12 1 -12 11c0 3 10 41 22 88l23 94c-122 7 -192 86 -192 181c0 136 147 269 306 274l58 231c4 17 5 20 15 20c12 0 12 -10 12 -10l-3 -14l-56 -227c139 -10 192 -102 192 -181z M349 421c-149 -13 -235 -153 -235 -273c0 -100 72 -135 132 -138zM508 283c0 88 -57 134 -133 138l-103 -411c150 12 236 155 236 273Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="0" y="0"></use>
</g>
</svg>, the corresponding object-space position and normal
are easily found.

</p>
<p></p>
<span class="anchor" id="fragment-Computecylindersamplepositionmonopiandnormalmononfromzandphi-0"></span><div class="fragmentname">&lt;&lt;Compute cylinder sample position <tt>pi</tt> and normal <tt>n</tt> from <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.086ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 467.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.385ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 596.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">phi</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D719" d="M573 262c0 -134 -145 -269 -306 -274l-38 -149c-3 -14 -9 -38 -11 -40c-3 -3 -5 -4 -10 -4s-12 1 -12 11c0 3 10 41 22 88l23 94c-122 7 -192 86 -192 181c0 136 147 269 306 274l58 231c4 17 5 20 15 20c12 0 12 -10 12 -10l-3 -14l-56 -227c139 -10 192 -102 192 -181z M349 421c-149 -13 -235 -153 -235 -273c0 -100 72 -135 132 -138zM508 283c0 88 -57 134 -133 138l-103 -411c150 12 236 155 236 273Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="0" y="0"></use>
</g>
</svg>&gt;&gt;=&nbsp;</div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> pObj = <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a>(<a href="#Cylinder::radius" class="code">radius</a> * std::cos(phi), <a href="#Cylinder::radius" class="code">radius</a> * std::sin(phi), z);
&lt;&lt;<span class="fragmentname"><a href="Managing_Rounding_Error.html#fragment-ReprojectmonopObjtocylindersurfaceandcomputemonopObjError-0">Reproject <tt>pObj</tt> to cylinder surface and compute <tt>pObjError</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-509" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-509"><i></i></a><div id="fragbit-509" class="collapse show"><div class="fragmentcode">   Float hitRad = std::sqrt(<a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(pObj.x) + <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(pObj.y));
   pObj.x *= <a href="#Cylinder::radius" class="code">radius</a> / hitRad;
   pObj.y *= <a href="#Cylinder::radius" class="code">radius</a> / hitRad;
   <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> pObjError = <a href="../Shapes/Managing_Rounding_Error.html#gamma" class="code">gamma</a>(3) * <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Abs" class="code">Abs</a>(<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(pObj.x, pObj.y, 0));</div></div>
Point3fi pi = (*renderFromObject)(Point3fi(pObj, pObjError));
<a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> n = Normalize((*renderFromObject)(<a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(pObj.x, pObj.y, 0)));
if (<a href="#Cylinder::reverseOrientation" class="code">reverseOrientation</a>)
    n *= -1;</div><p>


</p>
<p></p>
<span class="anchor" id="fragment-CylinderPublicMethods-8"></span><div class="fragmentname">&lt;&lt;Cylinder Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-CylinderPublicMethods-7"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-CylinderPublicMethods-9"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">Float <span class="anchor" id="Cylinder::PDF"></span>PDF(const <a href="../Geometry_and_Transformations/Interactions.html#Interaction" class="code">Interaction</a> &amp;) const { return 1 / <a href="#Cylinder::Area" class="code">Area</a>(); }</div><p>


</p>
<p>Unlike the <a href="../Shapes/Spheres.html#Sphere"><tt>Sphere</tt></a>, <tt>pbrt</tt>&rsquo;s <tt>Cylinder</tt> does not have a
specialized solid angle sampling method.  Instead, it samples a point on
the cylinder uniformly by area without making use of the reference point
before converting the area density for that point to a solid angle density
before returning it.  Both the <tt>Sample()</tt> and <tt>PDF()</tt> methods can
be implemented using the same fragments that were used for solid angle sampling
of reference points inside spheres.

</p>
<p></p>
<span class="anchor" id="fragment-CylinderPublicMethods-9"></span><div class="fragmentname">&lt;&lt;Cylinder Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-CylinderPublicMethods-8"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-CylinderPublicMethods-10"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">pstd::optional&lt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample" class="code">ShapeSample</a>&gt; Sample(const <a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext" class="code">ShapeSampleContext</a> &amp;ctx, 
                                   <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> u) const {
    &lt;&lt;<span class="fragmentname"><a href="Spheres.html#fragment-Sampleshapebyareaandcomputeincidentdirectionmonowi-0">Sample shape by area and compute incident direction <tt>wi</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-510" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-510"><i></i></a><div id="fragbit-510" class="collapse show"><div class="fragmentcode">       pstd::optional&lt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample" class="code">ShapeSample</a>&gt; ss = Sample(u);
       ss-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample::intr" class="code">intr</a>.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::time" class="code">time</a> = ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::time" class="code">time</a>;
       <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> wi = ss-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample::intr" class="code">intr</a>.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::p" class="code">p</a>() - ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::p" class="code">p</a>();
       if (<a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(wi) == 0) return {};
       wi = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(wi);</div></div>
    &lt;&lt;<span class="fragmentname"><a href="Spheres.html#fragment-ConvertareasamplingPDFinmonosstosolidanglemeasure-0">Convert area sampling PDF in <tt>ss</tt> to solid angle measure</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-511" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-511"><i></i></a><div id="fragbit-511" class="collapse show"><div class="fragmentcode">       ss-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample::pdf" class="code">pdf</a> /= <a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(ss-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample::intr" class="code">intr</a>.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>, -wi) /
                  <a href="../Geometry_and_Transformations/Points.html#DistanceSquared" class="code">DistanceSquared</a>(ctx.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::p" class="code">p</a>(), ss-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample::intr" class="code">intr</a>.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::p" class="code">p</a>());
       if (<a href="../Shapes/Managing_Rounding_Error.html#IsInf" class="code">IsInf</a>(ss-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample::pdf" class="code">pdf</a>))
           return {};</div></div>
    return ss;
}</div><p>


</p>
<p></p>
<span class="anchor" id="fragment-CylinderPublicMethods-10"></span><div class="fragmentname">&lt;&lt;Cylinder Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-CylinderPublicMethods-9"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">Float PDF(const <a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext" class="code">ShapeSampleContext</a> &amp;ctx, <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> wi) const {
    &lt;&lt;<span class="fragmentname"><a href="Spheres.html#fragment-Intersectsampleraywithshapegeometry-0">Intersect sample ray with shape geometry</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-512" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-512"><i></i></a><div id="fragbit-512" class="collapse show"><div class="fragmentcode">       <a href="../Geometry_and_Transformations/Rays.html#Ray" class="code">Ray</a> ray = ctx.<a href="../Shapes/Managing_Rounding_Error.html#ShapeSampleContext::SpawnRay" class="code">SpawnRay</a>(wi);
       pstd::optional&lt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeIntersection" class="code">ShapeIntersection</a>&gt; isect = <a href="../Shapes/Spheres.html#Sphere::Intersect" class="code">Intersect</a>(ray);
       if (!isect) return 0;</div></div>
    &lt;&lt;<span class="fragmentname"><a href="Spheres.html#fragment-ComputePDFinsolidanglemeasurefromshapeintersectionpoint-0">Compute PDF in solid angle measure from shape intersection point</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-513" role="button" class="fa codecarat" aria-expanded="true" aria-controls="fragbit-513"><i></i></a><div id="fragbit-513" class="collapse show"><div class="fragmentcode">       Float pdf = (1 / <a href="../Shapes/Spheres.html#Sphere::Area" class="code">Area</a>()) / (<a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(isect-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeIntersection::intr" class="code">intr</a>.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>, -wi) /
                                   <a href="../Geometry_and_Transformations/Points.html#DistanceSquared" class="code">DistanceSquared</a>(ctx.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::p" class="code">p</a>(), isect-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeIntersection::intr" class="code">intr</a>.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::p" class="code">p</a>()));
       if (<a href="../Shapes/Managing_Rounding_Error.html#IsInf" class="code">IsInf</a>(pdf)) pdf = 0;</div></div>
    return pdf;
}</div><p>


</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

</div>  <!-- container-fluid -->
</div>  <!-- maincontainer -->

<nav class="navbar navbar-expand-md bg-light navbar-light">
<div class="container-fluid">
  <span class="navbar-text"><i>Physically Based Rendering: From Theory To Implementation</i>,<br>
<a href="https://creativecommons.org/licenses/by-nc-nd/4.0/">&copy; 2004-2023</a> Matt Pharr, Wenzel Jakob, and Greg Humphreys.
<a href="https://github.com/mmp/pbr-book-website/"><span class="fab fa-github"></span></a><br>
Purchase a printed copy: <a href="https://www.amazon.com/Physically-Based-Rendering-fourth-Implementation/dp/0262048027?keywords=physically+based+rendering+4th+edition&qid=1671730412&sprefix=physically+based%!C(MISSING)aps%!C(MISSING)145&sr=8-1&linkCode=ll1&tag=pharr-20&linkId=81a816d90f0c7e872617f1f930a51fd6&language=en_US&ref_=as_li_ss_tl"><span class="fab fa-amazon"></span></a>
<a href="https://mitpress.mit.edu/9780262048026/physically-based-rendering/"><img src="/mitpress.png" width=10 height=16></a>
</span>
</div>
  <div class="container">
    <ul class="nav navbar-nav ml-auto">
      <li class="nav-item">Next: <a href="../Shapes/Disks.html">Shapes / Disks</a></li>
    </ul>
  </div>

</nav>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script>
  $(function () {
    $('[data-toggle="popover"]').popover()
    $('[data-toggle="tooltip"]').tooltip()
   })
</script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

<script>
// https://stackoverflow.com/a/17535094
// The function actually applying the offset
function offsetAnchor() {
  if (location.hash.length !== 0) {
    window.scrollTo(window.scrollX, window.scrollY - window.innerHeight / 8);
  }
}

// Captures click events of all <a> elements with href starting with #
$(document).on('click', 'a[href^="#"]', function(event) {
  // Click events are captured before hashchanges. Timeout
  // causes offsetAnchor to be called after the page jump.
  window.setTimeout(function() {
    offsetAnchor();
  }, 500);
});

// Set the offset when entering page with hash present in the url
window.setTimeout(offsetAnchor, 1500);
</script>

</body>
</html>
